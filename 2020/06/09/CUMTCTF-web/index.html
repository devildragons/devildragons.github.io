<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="renderer" content="webkit">

  
  <title>CUMTCTF题解 | Dragon&#39;s Blog</title>

  <link rel="shortcut icon" href="/images/favicon.png">
  <link rel="alternate" href="/atom.xml" title="Dragon's Blog">
  <meta name="description" content="WEB入门题：1、array 从表中可知道改&#x3D;该正则表达式^[1-9]+$表示要匹配一次或多次1到9的数字从代码可以知道需要把X-Forwarded-For设置为127.0.0.1,才可以往下执行 如果传入的element是数组则返回NULL，而NULL和FALSE类型不一样所以可以绕过，pass是数组的话也返回NULL，而pass1不为空，所以可以绕过strcmp函数  于是传element和p">
<meta property="og:type" content="article">
<meta property="og:title" content="CUMTCTF题解">
<meta property="og:url" content="https://devildragons.github.io/2020/06/09/CUMTCTF-web/index.html">
<meta property="og:site_name" content="Dragon&#39;s Blog">
<meta property="og:description" content="WEB入门题：1、array 从表中可知道改&#x3D;该正则表达式^[1-9]+$表示要匹配一次或多次1到9的数字从代码可以知道需要把X-Forwarded-For设置为127.0.0.1,才可以往下执行 如果传入的element是数组则返回NULL，而NULL和FALSE类型不一样所以可以绕过，pass是数组的话也返回NULL，而pass1不为空，所以可以绕过strcmp函数  于是传element和p">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6e40b1lj30na06x749.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6edjs8xj31720pdjt9.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6erm1u8j30tc0jd0u1.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6fb3l2hj30nu05ydg3.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6g5t6yxj30cc018we9.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6go6zcuj30k0074wf9.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6i7lzpqj30on06hjrh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6igo5soj30lb0engm4.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6indj7yj30tc0agq3k.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6j68cnuj30sv06674g.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jclt7mj30dr072jrf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jq5lbpj30fs01u0sj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6kjuwhgj30n101b0sm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6l5jskoj30d201gdfn.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6n97wnjj30xo0b074m.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nhgkfyj30if05x74h.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nw7z5rj30o30a4q3a.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6o60gmjj30fv0ihjrn.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6oe11wmj30dm061jrg.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ozlzcqj30ee01g3yb.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6p7cux1j311n029glm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ptxiz8j30lt087q2w.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6r4urq1j30jc0dngoh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6rir51qj30g105zweh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6t6whkvj30wl09wmxd.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tjvxwuj30i904pmx8.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tyd58tj30iz0bqwf5.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6un0n8yj30ov06y3yt.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6uzd4ldj30ea0e2dg5.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6vipcrgj30kk05l0sr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6w235bsj30lg07e0t2.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6we5utlj30bd04pdfr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6x92u4vj30o007nglz.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xne530j30ju06674e.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xv9ylbj308003hq2r.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8d09hzjj30k50fpglq.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fasjmwj30nt084mxb.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fwgbmqj30yp0ik772.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8gcy9lqj30dc01m0sj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8pqpvbzj30gm05mglo.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8qcmtcrj30dw06saaa.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8u50pfej30gx07njrm.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8uloz1sj307v09vgoh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8viian3j30vr0f941w.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8w02m18j30f909gmx7.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8xq49cjj30ss07gt8u.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8y0uy2oj30qn0gdt9v.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8yesvgfj30a9040745.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93jm1aij30ui0oedhh.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93w2a57j30d907maa6.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94dafa8j30nz05et8y.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94srt1bj30uo0ewgmr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm95vhznzj30h20cb0sr.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96ado7qj30k307st99.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96tditmj30hj044weg.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9765sbej30op0aht9f.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97hw289j30s90asdgp.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97qbd5sj30lh08f752.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm986xpotj30jr0bkmx8.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm98pkqi0j30bm02o743.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm99z1ziej30mj0mbwg1.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9a8er4ij30pj03sq30.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9agzpb9j30oi0c3gmf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9bbjlebj30ca0duq3a.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9byp377j30ar018742.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9cnwtx1j30gd0a2dgf.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9d3rp30j30h305w0so.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9dxf9caj30p804oglj.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9e53ia8j30z50dv762.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9emdwhsj30m905jdfx.jpg">
<meta property="og:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9evxlg6j30dr00wq2r.jpg">
<meta property="article:published_time" content="2020-06-08T16:00:00.000Z">
<meta property="article:modified_time" content="2020-06-09T13:06:46.105Z">
<meta property="article:author" content="灬魔龙">
<meta property="article:tag" content="cumt">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6e40b1lj30na06x749.jpg">

  <meta name="format-detection" content="telephone=no,email=no">
  <meta name="theme-color" content="#9C27B0">
  <meta name="description" content="">
  <meta name="keywords" content=",cumt">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Dragon&#39;s Blog">
  <meta name="msapplication-starturl" content="https://devildragons.github.io/2020/06/09/CUMTCTF-web/">
  <meta name="msapplication-navbutton-color" content="#9C27B0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Dragon&#39;s Blog">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  
    <meta property="article:published_time" content="Tue Jun 09 2020 00:00:00 GMT+0800">
    <meta property="article:modified_time" content="Tue Jun 09 2020 21:06:46 GMT+0800">
  

  
    <link rel="canonical" href="https://devildragons.github.io/2020/06/09/CUMTCTF-web/">
  

  
  

  
  
  

  
<link rel="stylesheet" href="/css/mdui.css">
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Dragon's Blog" type="application/atom+xml">
</head>
<body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-indigo mdui-theme-accent-pink">
  <script>var a=localStorage.getItem("mdui-theme-layout-dark");if(a){document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark"};</script>
  <header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset">
  <div class="mdui-toolbar mdui-color-theme">
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a>
    <a href="/" class="mdui-typo-headline">Dragon&#39;s Blog</a>
    <div class="mdui-toolbar-spacer"></div>
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: '搜索'}"><i class="mdui-icon material-icons">search</i></a>
    <a href="/atom.xml" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'RSS'}"><i class="mdui-icon material-icons">rss_feed</i></a>
  </div>
</header>
<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="输入关键词">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>
  <aside id="sidebar" class="mdui-drawer mdui-drawer-full-height">
  <div class="mdui-grid-tile">
    <img src="/images/banner.png" style="height: 160px;">
    <img src="/images/touxiang.png" class="avatar-animation" style="position: absolute; top: 10%; left: 24px; width: 64px; height: 64px; border: 2px solid #fff; border-radius: 50%;">
    <div class="mdui-grid-tile-actions">
      <div class="mdui-grid-tile-text">
        <div class="mdui-grid-tile-title">灬魔龙</div>
        <div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i></div>
      </div>
      
    </div>
  </div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    <a href="/" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i>
      <div class="mdui-list-item-content">主页</div>
    </a>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i>
        <div class="mdui-list-item-content">归档</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/archives/2020/07/">七月 2020<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/06/">六月 2020<span class="mdui-ripple sidebar_archives-count">2</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i>
        <div class="mdui-list-item-content">分类</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/categories/acm/">acm<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/web/">web<span class="mdui-ripple sidebar_archives-count">3</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i>
        <div class="mdui-list-item-content">标签</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/tags/buuoj/" rel="tag">buuoj<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/cumt/" rel="tag">cumt<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sql注入<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <a href="/about" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i>
      <div class="mdui-list-item-content">关于</div>
    </a>
  </div>

  <div class="mdui-divider"></div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    
      <a href="https://github.com/devildragons" target="_blank" rel="noopener" class="mdui-list-item mdui-ripple">Github</a>
    
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <div class="mdui-list-item-content">友情链接</div>
        <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
          <a href="https://xzlxr.github.io/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">fe1w0</a>
        
          <a href="http://iyzyi.com/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iyzyi</a>
        
          <a href="https://ljzjsc.com/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">牢记自己是菜</a>
        
          <a href="http://iv4n.cc/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iv4n</a>
        
          <a href="https://3nd.xyz/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">3ND</a>
        
          <a href="https://skysec.top/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">一叶飘零</a>
        
          <a href="http://ueverglow.top/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">雨夜叶雨</a>
        
          <a href="http://iluem.xyz/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iluem</a>
        
        
      </div>
    </div>
  </div>
</aside>
  <main id="main" class="mdui-m-t-5 fadeIn animated">
  
<link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">

  <style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style>
  <article class="mdui-card mdui-m-b-5">
    <header class="mdui-card-media">
      <img src="/images/random/material-7.png" style="max-height: 240px;">
      <div class="mdui-card-media-covered">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">CUMTCTF题解</div>
          <div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2020-06-09 / <i class="iconfont">&#xe601;</i> 灬魔龙 &nbsp;&nbsp; <span id="busuanzi_container_page_pv" style="display: none;"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_page_pv"></span></span></div>
        </div>
      </div>
      <div class="mdui-card-menu">
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#qrcode', align: 'right'}"><i class="mdui-icon material-icons">devices</i></button>
          <ul class="mdui-menu" id="qrcode">
            
              <li class="mdui-menu-item"><a class="mdui-text-center mdui-ripple">Send to mobile phone</a></li>
            
            <li class="mdui-menu-item" disabled>
              
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAN4AAADeCAAAAAB3DOFrAAACbElEQVR42u3aQXLCMBAEQP7/6eQBCWZmZSmBap8oQ0Dtg1aZ3cfXR18PPDw8PDw8PDy8f8Z7xNcvX/Tj/vWd6+98dqddGx4eHt4Z3outtlx0sZQf95+9LtaGh4eHd5D3bCnPPnO9oHajv156sjY8PDy8d+TlZSN/Fw8PD+8zeDnsLQsDHh4e3q1hxGPhuqYmQcP2rAUPDw8v5uWLO//6aH8PDw8PL+DVI01xGHG9rSef+YOZMjw8PLyAl2/EyYF4NgQwKwx4eHh4f8Wbtb7yDb1tgCVFqD5S4+Hh4W3g5eA8Zm2bYfnBvS4MeHh4eNt4SdCwcrBeYS8dqfHw8PBu5eUF4HqhebFZ+fVomAAPDw9vM69tR7XhQtv4bw/cddaCh4eHt8xLDtDtgNQsnsgf4ovV4uHh4W3mrQe4efTQxg3D+BgPDw9vM6+NIWatqTzMnY0X4OHh4Z3nta2pNsZNlrtl6AoPDw/vyDznSix774MYDjTg4eHhHeGt/3wyZHBXM+xFOcHDw8M7wmubVe3xd2W59XADHh4e3mberNmfhLltecibcEVhwMPDwzvIW4e1rbW2LNUzZXh4eHgbePni2ge0/iBuKAx4eHh4R3jDFlQ5mDULeW8oDHh4eHgjXnvlIUJbDNpD9nDoCg8PD2+Zt7Ip583+nJqUk2LoCg8PD28brx0jSKKKtrk1G71a6u/h4eHhLfNmG3Q+PpXHHHnZwMPDw3t3XssuIgY8PDy8D+LNRqlmh+zoHwA8PDy8g7x8rOquxlX7t9tjXDw8PLwNDbCV+LWNiWdIPDw8vN28z7vw8PDw8PDw8PD+wfUNqQGGkj8/uGsAAAAASUVORK5CYII=">
              
            </li>
          </ul>
        
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="mdui-icon material-icons">share</i></button>
          <ul class="mdui-menu" id="share_menu">
            <li class="mdui-menu-item">
              <a href="http://service.weibo.com/share/share.php?appkey=&title=CUMTCTF题解&url=https://devildragons.github.io/2020/06/09/CUMTCTF-web/&pic=https://devildragons.github.io/images/favicon.png&searchPic=false&style=simple" target="_blank" class="mdui-ripple">分享到微博</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://twitter.com/intent/tweet?text=CUMTCTF题解&url=https://devildragons.github.io/2020/06/09/CUMTCTF-web/&via=灬魔龙" target="_blank" class="mdui-ripple">分享到Twitter</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://devildragons.github.io/2020/06/09/CUMTCTF-web/" target="_blank" class="mdui-ripple">分享到Facebook</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://plus.google.com/share?url=https://devildragons.github.io/2020/06/09/CUMTCTF-web/" target="_blank" class="mdui-ripple">分享到Google+</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://devildragons.github.io/2020/06/09/CUMTCTF-web/&title=CUMTCTF题解" target="_blank" class="mdui-ripple">分享到LinkedIn</a>
            </li>
            <li class="mdui-menu-item">
              <a href="http://connect.qq.com/widget/shareqq/index.html?site=Dragon&#39;s Blog&title=CUMTCTF题解&summary=&pics=https://devildragons.github.io/images/favicon.png&url=https://devildragons.github.io/2020/06/09/CUMTCTF-web/" target="_blank" class="mdui-ripple">分享到QQ</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://telegram.me/share/url?url=https://devildragons.github.io/2020/06/09/CUMTCTF-web/&text=CUMTCTF题解" target="_blank" class="mdui-ripple">分享到Telegram</a>
            </li>
          </ul>
        
      </div>
    </header>
    <div class="mdui-card-content mdui-typo">
      <h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h1 id="入门题："><a href="#入门题：" class="headerlink" title="入门题："></a>入门题：</h1><h2 id="1、array"><a href="#1、array" class="headerlink" title="1、array"></a>1、array</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6e40b1lj30na06x749.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6edjs8xj31720pdjt9.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6erm1u8j30tc0jd0u1.jpg" alt=""></p>
<p>从表中可知道改=该正则表达式^[1-9]+$表示要匹配一次或多次1到9的数字<br>从代码可以知道需要把X-Forwarded-For设置为127.0.0.1,才可以往下执行</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6fb3l2hj30nu05ydg3.jpg" alt=""><br>如果传入的element是数组则返回NULL，而NULL和FALSE类型不一样所以可以绕过，<br>pass是数组的话也返回NULL，而pass1不为空，所以可以绕过strcmp函数</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6g5t6yxj30cc018we9.jpg" alt=""></p>
<p>于是传element和pass的参数为数组形式然后抓包</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6go6zcuj30k0074wf9.jpg" alt=""><br>添加X-Forwarded-For:127.0.0.1将ip修改为127.0.0.1从而获得flag.</p>
<h2 id="2、easy-file-get-contents"><a href="#2、easy-file-get-contents" class="headerlink" title="2、easy_file_get_contents"></a>2、easy_file_get_contents</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6i7lzpqj30on06hjrh.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6igo5soj30lb0engm4.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6indj7yj30tc0agq3k.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6j68cnuj30sv06674g.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jclt7mj30dr072jrf.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jq5lbpj30fs01u0sj.jpg" alt=""></p>
<p>所以构造payload，path=flag.php将flag.php中的内容复制到path中，</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6kjuwhgj30n101b0sm.jpg" alt=""><br>所以构造user这段payload来满足if语句<br>从而获得flag<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6l5jskoj30d201gdfn.jpg" alt=""></p>
<h2 id="3、chang-script"><a href="#3、chang-script" class="headerlink" title="3、chang_script"></a>3、chang_script</h2><p><strong>本地文件包含漏洞</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6n97wnjj30xo0b074m.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nhgkfyj30if05x74h.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nw7z5rj30o30a4q3a.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6o60gmjj30fv0ihjrn.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6oe11wmj30dm061jrg.jpg" alt=""><br>Eval()会将参数字符串当作命令语句执行，故利用类似单引号闭合的原理可以注入语句。构造payload如下</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ozlzcqj30ee01g3yb.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6p7cux1j311n029glm.jpg" alt=""><br>然后获得url编码的flag，进行url解码即可获得最终flag<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ptxiz8j30lt087q2w.jpg" alt=""></p>
<h1 id="挑战题："><a href="#挑战题：" class="headerlink" title="挑战题："></a>挑战题：</h1><h2 id="1、源代码"><a href="#1、源代码" class="headerlink" title="1、源代码"></a>1、源代码</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6r4urq1j30jc0dngoh.jpg" alt=""><br>由题目知道需要查看源代码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6rir51qj30g105zweh.jpg" alt=""><br>去掉其中的歌词获得flag</p>
<h2 id="2、colorSnake"><a href="#2、colorSnake" class="headerlink" title="2、colorSnake"></a>2、colorSnake</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6t6whkvj30wl09wmxd.jpg" alt=""><br>靠手玩获得flag是不可能的</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tjvxwuj30i904pmx8.jpg" alt=""><br>看源代码发现js脚本</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tyd58tj30iz0bqwf5.jpg" alt=""><br>查看脚本发现得分的php，这里面有个xhr，介绍一下xhr，xhr叫XMLHttpRequest ，XMLHttpRequest 对象提供了对 HTTP 协议的完全的访问，包括做出 POST 和 HEAD 请求以及普通的 GET 请求的能力。XMLHttpRequest 可以同步或异步地返回 Web 服务器的响应，并且能够以文本或者一个 DOM 文档的形式返回内容。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6un0n8yj30ov06y3yt.jpg" alt=""><br>访问该界面</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6uzd4ldj30ea0e2dg5.jpg" alt=""><br>发现有json格式的东西，把里面的msg部分的内容unicode解码得到一句话，<br>可以猜到应该是用这个去访问页面去增加得分，每刷新一下这个页面发现score加一了，但是刷新的太快又会重新置0</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6vipcrgj30kk05l0sr.jpg" alt=""><br>所以可以规律性的停一秒刷新一下，也可以写个脚本从而获得flag.</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6w235bsj30lg07e0t2.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6we5utlj30bd04pdfr.jpg" alt=""></p>
<p>获得flag</p>
<h2 id="3、备份"><a href="#3、备份" class="headerlink" title="3、备份"></a>3、备份</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6x92u4vj30o007nglz.jpg" alt=""><br>题目有很多备份要从中找到flag就写个脚本，把有flag的备份文件显示出来</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xne530j30ju06674e.jpg" alt=""></p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xv9ylbj308003hq2r.jpg" alt=""></p>
<p>在第998个备份文件里获得flag.</p>
<h2 id="4、上传一、二"><a href="#4、上传一、二" class="headerlink" title="4、上传一、二"></a>4、上传一、二</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8d09hzjj30k50fpglq.jpg" alt=""><br>发现是php网页，但是不能上传php文件只能上传图片</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fasjmwj30nt084mxb.jpg" alt=""></p>
<p>于是上传一张图片，然后抓包修改图片后缀为php<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fwgbmqj30yp0ik772.jpg" alt=""></p>
<p>得到flag发现还送了一个上传二的flag，于是两题flag到手<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8gcy9lqj30dc01m0sj.jpg" alt=""></p>
<p>上传二需要Content-Type为image才能看到flag</p>
<h2 id="5、Cookie"><a href="#5、Cookie" class="headerlink" title="5、Cookie?"></a>5、Cookie?</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8pqpvbzj30gm05mglo.jpg" alt=""><br>发现要用管理员身份登录，于是抓包</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8qcmtcrj30dw06saaa.jpg" alt=""><br>发现user是guest，于是修改user为admin<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8u50pfej30gx07njrm.jpg" alt=""><br>发现一张图片</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8uloz1sj307v09vgoh.jpg" alt=""></p>
<p>打开没发现什么</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8viian3j30vr0f941w.jpg" alt=""><br>百度识图，所以这题应该是维吉尼亚密码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8w02m18j30f909gmx7.jpg" alt=""><br>解密获得flag</p>
<h2 id="6、is-hash-safe"><a href="#6、is-hash-safe" class="headerlink" title="6、is hash safe?"></a>6、is hash safe?</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8xq49cjj30ss07gt8u.jpg" alt=""><br>打开发现又要是管理员，于是抓包<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8y0uy2oj30qn0gdt9v.jpg" alt=""><br>将role改为admin并没有什么变化，题目说有东西没删掉所以应该有备份的文件尝试phps，php无果后</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8yesvgfj30a9040745.jpg" alt=""></p>
<p>尝试.swp发现有文件<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93jm1aij30ui0oedhh.jpg" alt=""><br>我们可以用vim -r命令去回复备份文件vim -r admin.php.swp，发现源代码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93w2a57j30d907maa6.jpg" alt=""></p>
<p>这题考的是<strong>hash长度拓展攻击</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94dafa8j30nz05et8y.jpg" alt=""><br>我们可用hashpump这个工具来伪造admin的身份，记得要把数据URL编码一下<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94srt1bj30uo0ewgmr.jpg" alt=""><br>最后获得flag</p>
<h2 id="7、Logic"><a href="#7、Logic" class="headerlink" title="7、Logic"></a>7、Logic</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm95vhznzj30h20cb0sr.jpg" alt=""><br>查看源代码<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96ado7qj30k307st99.jpg" alt=""><br>发现一个php，访问它<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96tditmj30hj044weg.jpg" alt=""><br>又是说不是admin，继续抓包<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9765sbej30op0aht9f.jpg" alt=""><br>没什么发现，所以猜测和上题一样有备份文件，尝试.swp</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97hw289j30s90asdgp.jpg" alt=""></p>
<p>发现代码，说明token是10个0</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97qbd5sj30lh08f752.jpg" alt=""></p>
<p>再次查看源代码发现admin是chenyurui邮箱格式是gmail</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm986xpotj30jr0bkmx8.jpg" alt=""><br>然后登陆</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm98pkqi0j30bm02o743.jpg" alt=""></p>
<p>获得flag</p>
<h2 id="8、听说你会面向对象"><a href="#8、听说你会面向对象" class="headerlink" title="8、听说你会面向对象"></a>8、听说你会面向对象</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm99z1ziej30mj0mbwg1.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9a8er4ij30pj03sq30.jpg" alt=""></p>
<p>打开发现题目源代码</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9agzpb9j30oi0c3gmf.jpg" alt=""></p>
<p>发现是PHP反系列化题目<br><a href="https://www.freebuf.com/articles/web/167721.html" target="_blank" rel="noopener" title="反序列化介绍">https://www.freebuf.com/articles/web/167721.html</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9bbjlebj30ca0duq3a.jpg" alt=""></p>
<p>所以写一个php构造这个序列<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9byp377j30ar018742.jpg" alt=""></p>
<p>然后用GET方式传data<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9cnwtx1j30gd0a2dgf.jpg" alt=""><br>发现错误，所以是_wakeup函数的问题，PHP当序列化字符串中表示对象属性数的值大于真实的属性个数时会跳过__wakeup()的执行。</p>
<p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9d3rp30j30h305w0so.jpg" alt=""><br>所以把Admin后的数值改得比1大就得到flag</p>
<h2 id="9、上传三"><a href="#9、上传三" class="headerlink" title="9、上传三"></a>9、上传三</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9dxf9caj30p804oglj.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9e53ia8j30z50dv762.jpg" alt=""><br>php,php2,php3,php4,php5等都过滤掉了，直到试到phtml的时候回显出来一句话，发现是<strong>条件竞争</strong>题目<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9emdwhsj30m905jdfx.jpg" alt=""><br>于是写脚本<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9evxlg6j30dr00wq2r.jpg" alt=""></p>
<p>耐心等待几分钟从而获得flag</p>

      <blockquote class="mdui-m-t-5">
        
        <strong>本文链接：</strong><a href="https://devildragons.github.io/2020/06/09/CUMTCTF-web/">https://devildragons.github.io/2020/06/09/CUMTCTF-web/</a>
      </blockquote>
      
    </div>
    <footer class="mdui-card-actions">
      
        <a class="mdui-ripple article_categories-link" href="/categories/web/">web</a>
      
      
        <a class="mdui-ripple article_tags-link" href="/tags/cumt/" rel="tag">cumt</a>
      
    </footer>
    
  </article>
  
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>

  <script>$("#main article .mdui-card-content img.fancybox").on("click",function(e){$.fancybox.open({src:$(this).attr("src")});});</script>


  <nav id="paginator">
    
      <a rel="prev" class="extend prev" href="/2020/06/09/BUUOJ%20CTF/">
        <button aria-label="prev" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_back</i></button>
        &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;上一篇
      </a>
    
    <div class="spacer"></div>
    
  </nav>



</main>
  <footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme">
  <div class="mdui-p-y-0 mdui-text-center">
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
  <div class="mdui-p-y-1 mdui-text-center">
    Copyright &copy; 2019 - 2020 灬魔龙<br>
    Powered by <a href="https://hexo.io/" target="_blank" class="mdui-text-color-theme-accent">Hexo</a>
    
        <!-- 不蒜子统计 -->
        <span id="busuanzi_container_site_pv">
                本站总访问量<span id="busuanzi_value_site_pv"></span>次
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                本站访客数<span id="busuanzi_value_site_uv"></span>人
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  </div>
</footer>
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button>
  
  
<script src="/js/mdui.js"></script>
<script src="/js/script.js"></script>

</body>
</html>